(()=>{var t={7201:(t,e,r)=>{t.exports=r(3042)},1829:(t,e,r)=>{"use strict";var i=r(2222);t.exports=i},6040:(t,e,r)=>{"use strict";var i=r(8251);t.exports=i},7264:(t,e,r)=>{"use strict";var i=r(4139);r(768),r(8549),r(7152),r(1372),t.exports=i},9692:(t,e,r)=>{"use strict";var i=r(7045);t.exports=i},5663:(t,e,r)=>{"use strict";var i=r(70);t.exports=i},6823:(t,e,r)=>{"use strict";var i=r(8280),s=r(2017),n=String.prototype;t.exports=function(t){var e=t.replaceAll;return"string"==typeof t||t===n||i(n,t)&&e===n.replaceAll?s:e}},1926:(t,e,r)=>{"use strict";r(6750);var i=r(2046).Object,s=t.exports=function(t,e,r){return i.defineProperty(t,e,r)};i.defineProperty.sham&&(s.sham=!0)},2017:(t,e,r)=>{"use strict";r(1398),r(1995),r(929);var i=r(1747);t.exports=i("String","replaceAll")},3842:(t,e,r)=>{"use strict";r(8545),r(3643),r(4452),r(3997),r(5084),r(2596),r(5721),r(4954),r(4123),r(3377),r(2230),r(5344),r(1660),r(4610),r(3669),r(4810),r(3325),r(7024),r(8172),r(5205);var i=r(2046);t.exports=i.Symbol},1730:(t,e,r)=>{"use strict";r(9363),r(3643),r(7057),r(4954);var i=r(560);t.exports=i.f("iterator")},1661:(t,e,r)=>{"use strict";r(8537),r(3669);var i=r(560);t.exports=i.f("toPrimitive")},3042:(t,e,r)=>{"use strict";t.exports=r(9604)},9604:(t,e,r)=>{"use strict";r(6038);var i=r(1829);t.exports=i},4997:(t,e,r)=>{"use strict";var i=r(6040);t.exports=i},2321:(t,e,r)=>{"use strict";var i=r(7264);r(3939),r(1785),r(1697),r(4664),r(3422),r(36),r(8703),r(6878),r(9671),r(359),t.exports=i},2231:(t,e,r)=>{"use strict";var i=r(9692);t.exports=i},9280:(t,e,r)=>{"use strict";var i=r(5663);t.exports=i},2159:(t,e,r)=>{"use strict";var i=r(2250),s=r(4640),n=TypeError;t.exports=function(t){if(i(t))return t;throw new n(s(t)+" is not a function")}},43:(t,e,r)=>{"use strict";var i=r(4018),s=String,n=TypeError;t.exports=function(t){if(i(t))return t;throw new n("Can't set "+s(t)+" as a prototype")}},2156:t=>{"use strict";t.exports=function(){}},6624:(t,e,r)=>{"use strict";var i=r(6285),s=String,n=TypeError;t.exports=function(t){if(i(t))return t;throw new n(s(t)+" is not an object")}},4436:(t,e,r)=>{"use strict";var i=r(7374),s=r(4849),n=r(575),a=function(t){return function(e,r,a){var o=i(e),c=n(o);if(0===c)return!t&&-1;var h,u=s(a,c);if(t&&r!=r){for(;c>u;)if((h=o[u++])!=h)return!0}else for(;c>u;u++)if((t||u in o)&&o[u]===r)return t||u||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},726:(t,e,r)=>{"use strict";var i=r(8311),s=r(1907),n=r(6946),a=r(9298),o=r(575),c=r(6968),h=s([].push),u=function(t){var e=1===t,r=2===t,s=3===t,u=4===t,l=6===t,d=7===t,f=5===t||l;return function(p,m,_,v){for(var g,y,x=a(p),b=n(x),T=o(b),R=i(m,_),E=0,w=v||c,A=e?w(p,T):r||d?w(p,0):void 0;T>E;E++)if((f||E in b)&&(y=R(g=b[E],E,x),t))if(e)A[E]=y;else if(y)switch(t){case 3:return!0;case 5:return g;case 6:return E;case 2:h(A,g)}else switch(t){case 4:return!1;case 7:h(A,g)}return l?-1:s||u?u:A}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},7171:(t,e,r)=>{"use strict";var i=r(8828),s=r(6264),n=r(798),a=s("species");t.exports=function(t){return n>=51||!i((function(){var e=[];return(e.constructor={})[a]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},3427:(t,e,r)=>{"use strict";var i=r(1907);t.exports=i([].slice)},4010:(t,e,r)=>{"use strict";var i=r(1793),s=r(5468),n=r(6285),a=r(6264)("species"),o=Array;t.exports=function(t){var e;return i(t)&&(e=t.constructor,(s(e)&&(e===o||i(e.prototype))||n(e)&&null===(e=e[a]))&&(e=void 0)),void 0===e?o:e}},6968:(t,e,r)=>{"use strict";var i=r(4010);t.exports=function(t,e){return new(i(t))(0===e?0:e)}},5807:(t,e,r)=>{"use strict";var i=r(1907),s=i({}.toString),n=i("".slice);t.exports=function(t){return n(s(t),8,-1)}},3948:(t,e,r)=>{"use strict";var i=r(2623),s=r(2250),n=r(5807),a=r(6264)("toStringTag"),o=Object,c="Arguments"===n(function(){return arguments}());t.exports=i?n:function(t){var e,r,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=o(t),a))?r:c?n(e):"Object"===(i=n(e))&&s(e.callee)?"Arguments":i}},7382:(t,e,r)=>{"use strict";var i=r(8828);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},9550:t=>{"use strict";t.exports=function(t,e){return{value:t,done:e}}},1626:(t,e,r)=>{"use strict";var i=r(9447),s=r(4284),n=r(5817);t.exports=i?function(t,e,r){return s.f(t,e,n(1,r))}:function(t,e,r){return t[e]=r,t}},5817:t=>{"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},5543:(t,e,r)=>{"use strict";var i=r(9447),s=r(4284),n=r(5817);t.exports=function(t,e,r){i?s.f(t,e,n(0,r)):t[e]=r}},9251:(t,e,r)=>{"use strict";var i=r(4284);t.exports=function(t,e,r){return i.f(t,e,r)}},8055:(t,e,r)=>{"use strict";var i=r(1626);t.exports=function(t,e,r,s){return s&&s.enumerable?t[e]=r:i(t,e,r),t}},2532:(t,e,r)=>{"use strict";var i=r(5951),s=Object.defineProperty;t.exports=function(t,e){try{s(i,t,{value:e,configurable:!0,writable:!0})}catch(r){i[t]=e}return e}},9447:(t,e,r)=>{"use strict";var i=r(8828);t.exports=!i((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},9552:(t,e,r)=>{"use strict";var i=r(5951),s=r(6285),n=i.document,a=s(n)&&s(n.createElement);t.exports=function(t){return a?n.createElement(t):{}}},8024:t=>{"use strict";var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},9287:t=>{"use strict";t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},376:t=>{"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6794:(t,e,r)=>{"use strict";var i=r(5951).navigator,s=i&&i.userAgent;t.exports=s?String(s):""},798:(t,e,r)=>{"use strict";var i,s,n=r(5951),a=r(6794),o=n.process,c=n.Deno,h=o&&o.versions||c&&c.version,u=h&&h.v8;u&&(s=(i=u.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!s&&a&&(!(i=a.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/))&&(s=+i[1]),t.exports=s},1091:(t,e,r)=>{"use strict";var i=r(5951),s=r(6024),n=r(2361),a=r(2250),o=r(3846).f,c=r(7463),h=r(2046),u=r(8311),l=r(1626),d=r(9724);r(6128);var f=function(t){var e=function(r,i,n){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(r);case 2:return new t(r,i)}return new t(r,i,n)}return s(t,this,arguments)};return e.prototype=t.prototype,e};t.exports=function(t,e){var r,s,p,m,_,v,g,y,x,b=t.target,T=t.global,R=t.stat,E=t.proto,w=T?i:R?i[b]:i[b]&&i[b].prototype,A=T?h:h[b]||l(h,b,{})[b],S=A.prototype;for(m in e)s=!(r=c(T?m:b+(R?".":"#")+m,t.forced))&&w&&d(w,m),v=A[m],s&&(g=t.dontCallGetSet?(x=o(w,m))&&x.value:w[m]),_=s&&g?g:e[m],(r||E||typeof v!=typeof _)&&(y=t.bind&&s?u(_,i):t.wrap&&s?f(_):E&&a(_)?n(_):_,(t.sham||_&&_.sham||v&&v.sham)&&l(y,"sham",!0),l(A,m,y),E&&(d(h,p=b+"Prototype")||l(h,p,{}),l(h[p],m,_),t.real&&S&&(r||!S[m])&&l(S,m,_)))}},8828:t=>{"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},6024:(t,e,r)=>{"use strict";var i=r(1505),s=Function.prototype,n=s.apply,a=s.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?a.bind(n):function(){return a.apply(n,arguments)})},8311:(t,e,r)=>{"use strict";var i=r(2361),s=r(2159),n=r(1505),a=i(i.bind);t.exports=function(t,e){return s(t),void 0===e?t:n?a(t,e):function(){return t.apply(e,arguments)}}},1505:(t,e,r)=>{"use strict";var i=r(8828);t.exports=!i((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},3930:(t,e,r)=>{"use strict";var i=r(1505),s=Function.prototype.call;t.exports=i?s.bind(s):function(){return s.apply(s,arguments)}},6833:(t,e,r)=>{"use strict";var i=r(9447),s=r(9724),n=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,o=s(n,"name"),c=o&&"something"===function(){}.name,h=o&&(!i||i&&a(n,"name").configurable);t.exports={EXISTS:o,PROPER:c,CONFIGURABLE:h}},1871:(t,e,r)=>{"use strict";var i=r(1907),s=r(2159);t.exports=function(t,e,r){try{return i(s(Object.getOwnPropertyDescriptor(t,e)[r]))}catch(t){}}},2361:(t,e,r)=>{"use strict";var i=r(5807),s=r(1907);t.exports=function(t){if("Function"===i(t))return s(t)}},1907:(t,e,r)=>{"use strict";var i=r(1505),s=Function.prototype,n=s.call,a=i&&s.bind.bind(n,n);t.exports=i?a:function(t){return function(){return n.apply(t,arguments)}}},1747:(t,e,r)=>{"use strict";var i=r(5951),s=r(2046);t.exports=function(t,e){var r=s[t+"Prototype"],n=r&&r[e];if(n)return n;var a=i[t],o=a&&a.prototype;return o&&o[e]}},5582:(t,e,r)=>{"use strict";var i=r(2046),s=r(5951),n=r(2250),a=function(t){return n(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?a(i[t])||a(s[t]):i[t]&&i[t][e]||s[t]&&s[t][e]}},6656:(t,e,r)=>{"use strict";var i=r(1907),s=r(1793),n=r(2250),a=r(5807),o=r(160),c=i([].push);t.exports=function(t){if(n(t))return t;if(s(t)){for(var e=t.length,r=[],i=0;i<e;i++){var h=t[i];"string"==typeof h?c(r,h):"number"!=typeof h&&"Number"!==a(h)&&"String"!==a(h)||c(r,o(h))}var u=r.length,l=!0;return function(t,e){if(l)return l=!1,e;if(s(this))return e;for(var i=0;i<u;i++)if(r[i]===t)return e}}}},9367:(t,e,r)=>{"use strict";var i=r(2159),s=r(7136);t.exports=function(t,e){var r=t[e];return s(r)?void 0:i(r)}},7703:(t,e,r)=>{"use strict";var i=r(1907),s=r(9298),n=Math.floor,a=i("".charAt),o=i("".replace),c=i("".slice),h=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,r,i,l,d){var f=r+t.length,p=i.length,m=u;return void 0!==l&&(l=s(l),m=h),o(d,m,(function(s,o){var h;switch(a(o,0)){case"$":return"$";case"&":return t;case"`":return c(e,0,r);case"'":return c(e,f);case"<":h=l[c(o,1,-1)];break;default:var u=+o;if(0===u)return s;if(u>p){var d=n(u/10);return 0===d?s:d<=p?void 0===i[d-1]?a(o,1):i[d-1]+a(o,1):s}h=i[u-1]}return void 0===h?"":h}))}},5951:function(t,e,r){"use strict";var i=function(t){return t&&t.Math===Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof r.g&&r.g)||i("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9724:(t,e,r)=>{"use strict";var i=r(1907),s=r(9298),n=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return n(s(t),e)}},8530:t=>{"use strict";t.exports={}},2416:(t,e,r)=>{"use strict";var i=r(5582);t.exports=i("document","documentElement")},3648:(t,e,r)=>{"use strict";var i=r(9447),s=r(8828),n=r(9552);t.exports=!i&&!s((function(){return 7!==Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a}))},6946:(t,e,r)=>{"use strict";var i=r(1907),s=r(8828),n=r(5807),a=Object,o=i("".split);t.exports=s((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"===n(t)?o(t,""):a(t)}:a},2647:(t,e,r)=>{"use strict";var i=r(1907),s=r(2250),n=r(6128),a=i(Function.toString);s(n.inspectSource)||(n.inspectSource=function(t){return a(t)}),t.exports=n.inspectSource},4932:(t,e,r)=>{"use strict";var i,s,n,a=r(551),o=r(5951),c=r(6285),h=r(1626),u=r(9724),l=r(6128),d=r(2522),f=r(8530),p="Object already initialized",m=o.TypeError,_=o.WeakMap;if(a||l.state){var v=l.state||(l.state=new _);v.get=v.get,v.has=v.has,v.set=v.set,i=function(t,e){if(v.has(t))throw new m(p);return e.facade=t,v.set(t,e),e},s=function(t){return v.get(t)||{}},n=function(t){return v.has(t)}}else{var g=d("state");f[g]=!0,i=function(t,e){if(u(t,g))throw new m(p);return e.facade=t,h(t,g,e),e},s=function(t){return u(t,g)?t[g]:{}},n=function(t){return u(t,g)}}t.exports={set:i,get:s,has:n,enforce:function(t){return n(t)?s(t):i(t,{})},getterFor:function(t){return function(e){var r;if(!c(e)||(r=s(e)).type!==t)throw new m("Incompatible receiver, "+t+" required");return r}}}},1793:(t,e,r)=>{"use strict";var i=r(5807);t.exports=Array.isArray||function(t){return"Array"===i(t)}},2250:t=>{"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},5468:(t,e,r)=>{"use strict";var i=r(1907),s=r(8828),n=r(2250),a=r(3948),o=r(5582),c=r(2647),h=function(){},u=o("Reflect","construct"),l=/^\s*(?:class|function)\b/,d=i(l.exec),f=!l.test(h),p=function(t){if(!n(t))return!1;try{return u(h,[],t),!0}catch(t){return!1}},m=function(t){if(!n(t))return!1;switch(a(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!d(l,c(t))}catch(t){return!0}};m.sham=!0,t.exports=!u||s((function(){var t;return p(p.call)||!p(Object)||!p((function(){t=!0}))||t}))?m:p},7463:(t,e,r)=>{"use strict";var i=r(8828),s=r(2250),n=/#|\.prototype\./,a=function(t,e){var r=c[o(t)];return r===u||r!==h&&(s(e)?i(e):!!e)},o=a.normalize=function(t){return String(t).replace(n,".").toLowerCase()},c=a.data={},h=a.NATIVE="N",u=a.POLYFILL="P";t.exports=a},7136:t=>{"use strict";t.exports=function(t){return null==t}},6285:(t,e,r)=>{"use strict";var i=r(2250);t.exports=function(t){return"object"==typeof t?null!==t:i(t)}},4018:(t,e,r)=>{"use strict";var i=r(6285);t.exports=function(t){return i(t)||null===t}},7376:t=>{"use strict";t.exports=!0},2087:(t,e,r)=>{"use strict";var i=r(6285),s=r(5807),n=r(6264)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[n])?!!e:"RegExp"===s(t))}},5594:(t,e,r)=>{"use strict";var i=r(5582),s=r(2250),n=r(8280),a=r(1175),o=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=i("Symbol");return s(e)&&n(e.prototype,o(t))}},7181:(t,e,r)=>{"use strict";var i=r(5116).IteratorPrototype,s=r(8075),n=r(5817),a=r(4840),o=r(3742),c=function(){return this};t.exports=function(t,e,r,h){var u=e+" Iterator";return t.prototype=s(i,{next:n(+!h,r)}),a(t,u,!1,!0),o[u]=c,t}},183:(t,e,r)=>{"use strict";var i=r(1091),s=r(3930),n=r(7376),a=r(6833),o=r(2250),c=r(7181),h=r(5972),u=r(9192),l=r(4840),d=r(1626),f=r(8055),p=r(6264),m=r(3742),_=r(5116),v=a.PROPER,g=a.CONFIGURABLE,y=_.IteratorPrototype,x=_.BUGGY_SAFARI_ITERATORS,b=p("iterator"),T="keys",R="values",E="entries",w=function(){return this};t.exports=function(t,e,r,a,p,_,A){c(r,e,a);var S,M,O,F=function(t){if(t===p&&U)return U;if(!x&&t&&t in D)return D[t];switch(t){case T:case R:case E:return function(){return new r(this,t)}}return function(){return new r(this)}},C=e+" Iterator",L=!1,D=t.prototype,I=D[b]||D["@@iterator"]||p&&D[p],U=!x&&I||F(p),k="Array"===e&&D.entries||I;if(k&&(S=h(k.call(new t)))!==Object.prototype&&S.next&&(n||h(S)===y||(u?u(S,y):o(S[b])||f(S,b,w)),l(S,C,!0,!0),n&&(m[C]=w)),v&&p===R&&I&&I.name!==R&&(!n&&g?d(D,"name",R):(L=!0,U=function(){return s(I,this)})),p)if(M={values:F(R),keys:_?U:F(T),entries:F(E)},A)for(O in M)(x||L||!(O in D))&&f(D,O,M[O]);else i({target:e,proto:!0,forced:x||L},M);return n&&!A||D[b]===U||f(D,b,U,{name:p}),m[e]=U,M}},5116:(t,e,r)=>{"use strict";var i,s,n,a=r(8828),o=r(2250),c=r(6285),h=r(8075),u=r(5972),l=r(8055),d=r(6264),f=r(7376),p=d("iterator"),m=!1;[].keys&&("next"in(n=[].keys())?(s=u(u(n)))!==Object.prototype&&(i=s):m=!0),!c(i)||a((function(){var t={};return i[p].call(t)!==t}))?i={}:f&&(i=h(i)),o(i[p])||l(i,p,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:m}},3742:t=>{"use strict";t.exports={}},575:(t,e,r)=>{"use strict";var i=r(3121);t.exports=function(t){return i(t.length)}},1176:t=>{"use strict";var e=Math.ceil,r=Math.floor;t.exports=Math.trunc||function(t){var i=+t;return(i>0?r:e)(i)}},8075:(t,e,r)=>{"use strict";var i,s=r(6624),n=r(2220),a=r(376),o=r(8530),c=r(2416),h=r(9552),u=r(2522),l="prototype",d="script",f=u("IE_PROTO"),p=function(){},m=function(t){return"<"+d+">"+t+"</"+d+">"},_=function(t){t.write(m("")),t.close();var e=t.parentWindow.Object;return t=null,e},v=function(){try{i=new ActiveXObject("htmlfile")}catch(t){}var t,e,r;v="undefined"!=typeof document?document.domain&&i?_(i):(e=h("iframe"),r="java"+d+":",e.style.display="none",c.appendChild(e),e.src=String(r),(t=e.contentWindow.document).open(),t.write(m("document.F=Object")),t.close(),t.F):_(i);for(var s=a.length;s--;)delete v[l][a[s]];return v()};o[f]=!0,t.exports=Object.create||function(t,e){var r;return null!==t?(p[l]=s(t),r=new p,p[l]=null,r[f]=t):r=v(),void 0===e?r:n.f(r,e)}},2220:(t,e,r)=>{"use strict";var i=r(9447),s=r(8661),n=r(4284),a=r(6624),o=r(7374),c=r(2875);e.f=i&&!s?Object.defineProperties:function(t,e){a(t);for(var r,i=o(e),s=c(e),h=s.length,u=0;h>u;)n.f(t,r=s[u++],i[r]);return t}},4284:(t,e,r)=>{"use strict";var i=r(9447),s=r(3648),n=r(8661),a=r(6624),o=r(470),c=TypeError,h=Object.defineProperty,u=Object.getOwnPropertyDescriptor,l="enumerable",d="configurable",f="writable";e.f=i?n?function(t,e,r){if(a(t),e=o(e),a(r),"function"==typeof t&&"prototype"===e&&"value"in r&&f in r&&!r[f]){var i=u(t,e);i&&i[f]&&(t[e]=r.value,r={configurable:d in r?r[d]:i[d],enumerable:l in r?r[l]:i[l],writable:!1})}return h(t,e,r)}:h:function(t,e,r){if(a(t),e=o(e),a(r),s)try{return h(t,e,r)}catch(t){}if("get"in r||"set"in r)throw new c("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},3846:(t,e,r)=>{"use strict";var i=r(9447),s=r(3930),n=r(2574),a=r(5817),o=r(7374),c=r(470),h=r(9724),u=r(3648),l=Object.getOwnPropertyDescriptor;e.f=i?l:function(t,e){if(t=o(t),e=c(e),u)try{return l(t,e)}catch(t){}if(h(t,e))return a(!s(n.f,t,e),t[e])}},5407:(t,e,r)=>{"use strict";var i=r(5807),s=r(7374),n=r(4443).f,a=r(3427),o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return o&&"Window"===i(t)?function(t){try{return n(t)}catch(t){return a(o)}}(t):n(s(t))}},4443:(t,e,r)=>{"use strict";var i=r(3045),s=r(376).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,s)}},7170:(t,e)=>{"use strict";e.f=Object.getOwnPropertySymbols},5972:(t,e,r)=>{"use strict";var i=r(9724),s=r(2250),n=r(9298),a=r(2522),o=r(7382),c=a("IE_PROTO"),h=Object,u=h.prototype;t.exports=o?h.getPrototypeOf:function(t){var e=n(t);if(i(e,c))return e[c];var r=e.constructor;return s(r)&&e instanceof r?r.prototype:e instanceof h?u:null}},8280:(t,e,r)=>{"use strict";var i=r(1907);t.exports=i({}.isPrototypeOf)},3045:(t,e,r)=>{"use strict";var i=r(1907),s=r(9724),n=r(7374),a=r(4436).indexOf,o=r(8530),c=i([].push);t.exports=function(t,e){var r,i=n(t),h=0,u=[];for(r in i)!s(o,r)&&s(i,r)&&c(u,r);for(;e.length>h;)s(i,r=e[h++])&&(~a(u,r)||c(u,r));return u}},2875:(t,e,r)=>{"use strict";var i=r(3045),s=r(376);t.exports=Object.keys||function(t){return i(t,s)}},2574:(t,e)=>{"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,s=i&&!r.call({1:2},1);e.f=s?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},9192:(t,e,r)=>{"use strict";var i=r(1871),s=r(6285),n=r(4239),a=r(43);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=i(Object.prototype,"__proto__","set"))(r,[]),e=r instanceof Array}catch(t){}return function(r,i){return n(r),a(i),s(r)?(e?t(r,i):r.__proto__=i,r):r}}():void 0)},4878:(t,e,r)=>{"use strict";var i=r(2623),s=r(3948);t.exports=i?{}.toString:function(){return"[object "+s(this)+"]"}},581:(t,e,r)=>{"use strict";var i=r(3930),s=r(2250),n=r(6285),a=TypeError;t.exports=function(t,e){var r,o;if("string"===e&&s(r=t.toString)&&!n(o=i(r,t)))return o;if(s(r=t.valueOf)&&!n(o=i(r,t)))return o;if("string"!==e&&s(r=t.toString)&&!n(o=i(r,t)))return o;throw new a("Can't convert object to primitive value")}},2046:t=>{"use strict";t.exports={}},5606:(t,e,r)=>{"use strict";var i=r(6624);t.exports=function(){var t=i(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},663:(t,e,r)=>{"use strict";var i=r(3930),s=r(9724),n=r(8280),a=r(5606),o=RegExp.prototype;t.exports=function(t){var e=t.flags;return void 0!==e||"flags"in o||s(t,"flags")||!n(o,t)?e:i(a,t)}},4239:(t,e,r)=>{"use strict";var i=r(7136),s=TypeError;t.exports=function(t){if(i(t))throw new s("Can't call method on "+t);return t}},4840:(t,e,r)=>{"use strict";var i=r(2623),s=r(4284).f,n=r(1626),a=r(9724),o=r(4878),c=r(6264)("toStringTag");t.exports=function(t,e,r,h){var u=r?t:t&&t.prototype;u&&(a(u,c)||s(u,c,{configurable:!0,value:e}),h&&!i&&n(u,"toString",o))}},2522:(t,e,r)=>{"use strict";var i=r(5816),s=r(6499),n=i("keys");t.exports=function(t){return n[t]||(n[t]=s(t))}},6128:(t,e,r)=>{"use strict";var i=r(7376),s=r(5951),n=r(2532),a="__core-js_shared__",o=t.exports=s[a]||n(a,{});(o.versions||(o.versions=[])).push({version:"3.39.0",mode:i?"pure":"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5816:(t,e,r)=>{"use strict";var i=r(6128);t.exports=function(t,e){return i[t]||(i[t]=e||{})}},1470:(t,e,r)=>{"use strict";var i=r(1907),s=r(5482),n=r(160),a=r(4239),o=i("".charAt),c=i("".charCodeAt),h=i("".slice),u=function(t){return function(e,r){var i,u,l=n(a(e)),d=s(r),f=l.length;return d<0||d>=f?t?"":void 0:(i=c(l,d))<55296||i>56319||d+1===f||(u=c(l,d+1))<56320||u>57343?t?o(l,d):i:t?h(l,d,d+2):u-56320+(i-55296<<10)+65536}};t.exports={codeAt:u(!1),charAt:u(!0)}},9846:(t,e,r)=>{"use strict";var i=r(798),s=r(8828),n=r(5951).String;t.exports=!!Object.getOwnPropertySymbols&&!s((function(){var t=Symbol("symbol detection");return!n(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},3467:(t,e,r)=>{"use strict";var i=r(3930),s=r(5582),n=r(6264),a=r(8055);t.exports=function(){var t=s("Symbol"),e=t&&t.prototype,r=e&&e.valueOf,o=n("toPrimitive");e&&!e[o]&&a(e,o,(function(t){return i(r,this)}),{arity:1})}},2595:(t,e,r)=>{"use strict";var i=r(5582),s=r(1907),n=i("Symbol"),a=n.keyFor,o=s(n.prototype.valueOf);t.exports=n.isRegisteredSymbol||function(t){try{return void 0!==a(o(t))}catch(t){return!1}}},9197:(t,e,r)=>{"use strict";for(var i=r(5816),s=r(5582),n=r(1907),a=r(5594),o=r(6264),c=s("Symbol"),h=c.isWellKnownSymbol,u=s("Object","getOwnPropertyNames"),l=n(c.prototype.valueOf),d=i("wks"),f=0,p=u(c),m=p.length;f<m;f++)try{var _=p[f];a(c[_])&&o(_)}catch(t){}t.exports=function(t){if(h&&h(t))return!0;try{for(var e=l(t),r=0,i=u(d),s=i.length;r<s;r++)if(d[i[r]]==e)return!0}catch(t){}return!1}},4411:(t,e,r)=>{"use strict";var i=r(9846);t.exports=i&&!!Symbol.for&&!!Symbol.keyFor},4849:(t,e,r)=>{"use strict";var i=r(5482),s=Math.max,n=Math.min;t.exports=function(t,e){var r=i(t);return r<0?s(r+e,0):n(r,e)}},7374:(t,e,r)=>{"use strict";var i=r(6946),s=r(4239);t.exports=function(t){return i(s(t))}},5482:(t,e,r)=>{"use strict";var i=r(1176);t.exports=function(t){var e=+t;return e!=e||0===e?0:i(e)}},3121:(t,e,r)=>{"use strict";var i=r(5482),s=Math.min;t.exports=function(t){var e=i(t);return e>0?s(e,9007199254740991):0}},9298:(t,e,r)=>{"use strict";var i=r(4239),s=Object;t.exports=function(t){return s(i(t))}},6028:(t,e,r)=>{"use strict";var i=r(3930),s=r(6285),n=r(5594),a=r(9367),o=r(581),c=r(6264),h=TypeError,u=c("toPrimitive");t.exports=function(t,e){if(!s(t)||n(t))return t;var r,c=a(t,u);if(c){if(void 0===e&&(e="default"),r=i(c,t,e),!s(r)||n(r))return r;throw new h("Can't convert object to primitive value")}return void 0===e&&(e="number"),o(t,e)}},470:(t,e,r)=>{"use strict";var i=r(6028),s=r(5594);t.exports=function(t){var e=i(t,"string");return s(e)?e:e+""}},2623:(t,e,r)=>{"use strict";var i={};i[r(6264)("toStringTag")]="z",t.exports="[object z]"===String(i)},160:(t,e,r)=>{"use strict";var i=r(3948),s=String;t.exports=function(t){if("Symbol"===i(t))throw new TypeError("Cannot convert a Symbol value to a string");return s(t)}},4640:t=>{"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},6499:(t,e,r)=>{"use strict";var i=r(1907),s=0,n=Math.random(),a=i(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++s+n,36)}},1175:(t,e,r)=>{"use strict";var i=r(9846);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8661:(t,e,r)=>{"use strict";var i=r(9447),s=r(8828);t.exports=i&&s((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},551:(t,e,r)=>{"use strict";var i=r(5951),s=r(2250),n=i.WeakMap;t.exports=s(n)&&/native code/.test(String(n))},366:(t,e,r)=>{"use strict";var i=r(2046),s=r(9724),n=r(560),a=r(4284).f;t.exports=function(t){var e=i.Symbol||(i.Symbol={});s(e,t)||a(e,t,{value:n.f(t)})}},560:(t,e,r)=>{"use strict";var i=r(6264);e.f=i},6264:(t,e,r)=>{"use strict";var i=r(5951),s=r(5816),n=r(9724),a=r(6499),o=r(9846),c=r(1175),h=i.Symbol,u=s("wks"),l=c?h.for||h:h&&h.withoutSetter||a;t.exports=function(t){return n(u,t)||(u[t]=o&&n(h,t)?h[t]:l("Symbol."+t)),u[t]}},8545:(t,e,r)=>{"use strict";var i=r(1091),s=r(8828),n=r(1793),a=r(6285),o=r(9298),c=r(575),h=r(8024),u=r(5543),l=r(6968),d=r(7171),f=r(6264),p=r(798),m=f("isConcatSpreadable"),_=p>=51||!s((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),v=function(t){if(!a(t))return!1;var e=t[m];return void 0!==e?!!e:n(t)};i({target:"Array",proto:!0,arity:1,forced:!_||!d("concat")},{concat:function(t){var e,r,i,s,n,a=o(this),d=l(a,0),f=0;for(e=-1,i=arguments.length;e<i;e++)if(v(n=-1===e?a:arguments[e]))for(s=c(n),h(f+s),r=0;r<s;r++,f++)r in n&&u(d,f,n[r]);else h(f+1),u(d,f++,n);return d.length=f,d}})},9363:(t,e,r)=>{"use strict";var i=r(7374),s=r(2156),n=r(3742),a=r(4932),o=r(4284).f,c=r(183),h=r(9550),u=r(7376),l=r(9447),d="Array Iterator",f=a.set,p=a.getterFor(d);t.exports=c(Array,"Array",(function(t,e){f(this,{type:d,target:i(t),index:0,kind:e})}),(function(){var t=p(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=null,h(void 0,!0);switch(t.kind){case"keys":return h(r,!1);case"values":return h(e[r],!1)}return h([r,e[r]],!1)}),"values");var m=n.Arguments=n.Array;if(s("keys"),s("values"),s("entries"),!u&&l&&"values"!==m.name)try{o(m,"name",{value:"values"})}catch(t){}},8537:()=>{},9721:(t,e,r)=>{"use strict";var i=r(1091),s=r(5582),n=r(6024),a=r(3930),o=r(1907),c=r(8828),h=r(2250),u=r(5594),l=r(3427),d=r(6656),f=r(9846),p=String,m=s("JSON","stringify"),_=o(/./.exec),v=o("".charAt),g=o("".charCodeAt),y=o("".replace),x=o(1..toString),b=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,R=/^[\uDC00-\uDFFF]$/,E=!f||c((function(){var t=s("Symbol")("stringify detection");return"[null]"!==m([t])||"{}"!==m({a:t})||"{}"!==m(Object(t))})),w=c((function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")})),A=function(t,e){var r=l(arguments),i=d(e);if(h(i)||void 0!==t&&!u(t))return r[1]=function(t,e){if(h(i)&&(e=a(i,this,p(t),e)),!u(e))return e},n(m,null,r)},S=function(t,e,r){var i=v(r,e-1),s=v(r,e+1);return _(T,t)&&!_(R,s)||_(R,t)&&!_(T,i)?"\\u"+x(g(t,0),16):t};m&&i({target:"JSON",stat:!0,arity:3,forced:E||w},{stringify:function(t,e,r){var i=l(arguments),s=n(E?A:m,null,i);return w&&"string"==typeof s?y(s,b,S):s}})},7024:(t,e,r)=>{"use strict";var i=r(5951);r(4840)(i.JSON,"JSON",!0)},8172:()=>{},6750:(t,e,r)=>{"use strict";var i=r(1091),s=r(9447),n=r(4284).f;i({target:"Object",stat:!0,forced:Object.defineProperty!==n,sham:!s},{defineProperty:n})},5264:(t,e,r)=>{"use strict";var i=r(1091),s=r(9846),n=r(8828),a=r(7170),o=r(9298);i({target:"Object",stat:!0,forced:!s||n((function(){a.f(1)}))},{getOwnPropertySymbols:function(t){var e=a.f;return e?e(o(t)):[]}})},3643:()=>{},5205:()=>{},1398:()=>{},7057:(t,e,r)=>{"use strict";var i=r(1470).charAt,s=r(160),n=r(4932),a=r(183),o=r(9550),c="String Iterator",h=n.set,u=n.getterFor(c);a(String,"String",(function(t){h(this,{type:c,string:s(t),index:0})}),(function(){var t,e=u(this),r=e.string,s=e.index;return s>=r.length?o(void 0,!0):(t=i(r,s),e.index+=t.length,o(t,!1))}))},929:(t,e,r)=>{"use strict";var i=r(1091),s=r(3930),n=r(1907),a=r(4239),o=r(2250),c=r(7136),h=r(2087),u=r(160),l=r(9367),d=r(663),f=r(7703),p=r(6264),m=r(7376),_=p("replace"),v=TypeError,g=n("".indexOf),y=n("".replace),x=n("".slice),b=Math.max;i({target:"String",proto:!0},{replaceAll:function(t,e){var r,i,n,p,T,R,E,w,A,S,M=a(this),O=0,F="";if(!c(t)){if((r=h(t))&&(i=u(a(d(t))),!~g(i,"g")))throw new v("`.replaceAll` does not allow non-global regexes");if(n=l(t,_))return s(n,t,M,e);if(m&&r)return y(u(M),t,e)}for(p=u(M),T=u(t),(R=o(e))||(e=u(e)),E=T.length,w=b(1,E),A=g(p,T);-1!==A;)S=R?u(e(T,A,p)):f(T,p,A,[],void 0,e),F+=x(p,O,A)+S,O=A+E,A=A+w>p.length?-1:g(p,T,A+w);return O<p.length&&(F+=x(p,O)),F}})},1995:()=>{},3997:(t,e,r)=>{"use strict";r(366)("asyncIterator")},3674:(t,e,r)=>{"use strict";var i=r(1091),s=r(5951),n=r(3930),a=r(1907),o=r(7376),c=r(9447),h=r(9846),u=r(8828),l=r(9724),d=r(8280),f=r(6624),p=r(7374),m=r(470),_=r(160),v=r(5817),g=r(8075),y=r(2875),x=r(4443),b=r(5407),T=r(7170),R=r(3846),E=r(4284),w=r(2220),A=r(2574),S=r(8055),M=r(9251),O=r(5816),F=r(2522),C=r(8530),L=r(6499),D=r(6264),I=r(560),U=r(366),k=r(3467),P=r(4840),N=r(4932),B=r(726).forEach,G=F("hidden"),V="Symbol",W="prototype",j=N.set,H=N.getterFor(V),z=Object[W],X=s.Symbol,Y=X&&X[W],K=s.RangeError,q=s.TypeError,J=s.QObject,Z=R.f,$=E.f,Q=b.f,tt=A.f,et=a([].push),rt=O("symbols"),it=O("op-symbols"),st=O("wks"),nt=!J||!J[W]||!J[W].findChild,at=function(t,e,r){var i=Z(z,e);i&&delete z[e],$(t,e,r),i&&t!==z&&$(z,e,i)},ot=c&&u((function(){return 7!==g($({},"a",{get:function(){return $(this,"a",{value:7}).a}})).a}))?at:$,ct=function(t,e){var r=rt[t]=g(Y);return j(r,{type:V,tag:t,description:e}),c||(r.description=e),r},ht=function(t,e,r){t===z&&ht(it,e,r),f(t);var i=m(e);return f(r),l(rt,i)?(r.enumerable?(l(t,G)&&t[G][i]&&(t[G][i]=!1),r=g(r,{enumerable:v(0,!1)})):(l(t,G)||$(t,G,v(1,g(null))),t[G][i]=!0),ot(t,i,r)):$(t,i,r)},ut=function(t,e){f(t);var r=p(e),i=y(r).concat(pt(r));return B(i,(function(e){c&&!n(lt,r,e)||ht(t,e,r[e])})),t},lt=function(t){var e=m(t),r=n(tt,this,e);return!(this===z&&l(rt,e)&&!l(it,e))&&(!(r||!l(this,e)||!l(rt,e)||l(this,G)&&this[G][e])||r)},dt=function(t,e){var r=p(t),i=m(e);if(r!==z||!l(rt,i)||l(it,i)){var s=Z(r,i);return!s||!l(rt,i)||l(r,G)&&r[G][i]||(s.enumerable=!0),s}},ft=function(t){var e=Q(p(t)),r=[];return B(e,(function(t){l(rt,t)||l(C,t)||et(r,t)})),r},pt=function(t){var e=t===z,r=Q(e?it:p(t)),i=[];return B(r,(function(t){!l(rt,t)||e&&!l(z,t)||et(i,rt[t])})),i};h||(S(Y=(X=function(){if(d(Y,this))throw new q("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?_(arguments[0]):void 0,e=L(t),r=function(t){var i=void 0===this?s:this;i===z&&n(r,it,t),l(i,G)&&l(i[G],e)&&(i[G][e]=!1);var a=v(1,t);try{ot(i,e,a)}catch(t){if(!(t instanceof K))throw t;at(i,e,a)}};return c&&nt&&ot(z,e,{configurable:!0,set:r}),ct(e,t)})[W],"toString",(function(){return H(this).tag})),S(X,"withoutSetter",(function(t){return ct(L(t),t)})),A.f=lt,E.f=ht,w.f=ut,R.f=dt,x.f=b.f=ft,T.f=pt,I.f=function(t){return ct(D(t),t)},c&&(M(Y,"description",{configurable:!0,get:function(){return H(this).description}}),o||S(z,"propertyIsEnumerable",lt,{unsafe:!0}))),i({global:!0,constructor:!0,wrap:!0,forced:!h,sham:!h},{Symbol:X}),B(y(st),(function(t){U(t)})),i({target:V,stat:!0,forced:!h},{useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),i({target:"Object",stat:!0,forced:!h,sham:!c},{create:function(t,e){return void 0===e?g(t):ut(g(t),e)},defineProperty:ht,defineProperties:ut,getOwnPropertyDescriptor:dt}),i({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:ft}),k(),P(X,V),C[G]=!0},5084:()=>{},3313:(t,e,r)=>{"use strict";var i=r(1091),s=r(5582),n=r(9724),a=r(160),o=r(5816),c=r(4411),h=o("string-to-symbol-registry"),u=o("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!c},{for:function(t){var e=a(t);if(n(h,e))return h[e];var r=s("Symbol")(e);return h[e]=r,u[r]=e,r}})},2596:(t,e,r)=>{"use strict";r(366)("hasInstance")},5721:(t,e,r)=>{"use strict";r(366)("isConcatSpreadable")},4954:(t,e,r)=>{"use strict";r(366)("iterator")},4452:(t,e,r)=>{"use strict";r(3674),r(3313),r(751),r(9721),r(5264)},751:(t,e,r)=>{"use strict";var i=r(1091),s=r(9724),n=r(5594),a=r(4640),o=r(5816),c=r(4411),h=o("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!c},{keyFor:function(t){if(!n(t))throw new TypeError(a(t)+" is not a symbol");if(s(h,t))return h[t]}})},3377:(t,e,r)=>{"use strict";r(366)("matchAll")},4123:(t,e,r)=>{"use strict";r(366)("match")},2230:(t,e,r)=>{"use strict";r(366)("replace")},5344:(t,e,r)=>{"use strict";r(366)("search")},1660:(t,e,r)=>{"use strict";r(366)("species")},4610:(t,e,r)=>{"use strict";r(366)("split")},3669:(t,e,r)=>{"use strict";var i=r(366),s=r(3467);i("toPrimitive"),s()},4810:(t,e,r)=>{"use strict";var i=r(5582),s=r(366),n=r(4840);s("toStringTag"),n(i("Symbol"),"Symbol")},3325:(t,e,r)=>{"use strict";r(366)("unscopables")},768:(t,e,r)=>{"use strict";var i=r(6264),s=r(4284).f,n=i("metadata"),a=Function.prototype;void 0===a[n]&&s(a,n,{value:null})},6038:(t,e,r)=>{"use strict";r(929)},8549:(t,e,r)=>{"use strict";r(366)("asyncDispose")},1697:(t,e,r)=>{"use strict";r(366)("customMatcher")},7152:(t,e,r)=>{"use strict";r(366)("dispose")},3939:(t,e,r)=>{"use strict";r(1091)({target:"Symbol",stat:!0},{isRegisteredSymbol:r(2595)})},3422:(t,e,r)=>{"use strict";r(1091)({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:r(2595)})},1785:(t,e,r)=>{"use strict";r(1091)({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:r(9197)})},36:(t,e,r)=>{"use strict";r(1091)({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:r(9197)})},8703:(t,e,r)=>{"use strict";r(366)("matcher")},6878:(t,e,r)=>{"use strict";r(366)("metadataKey")},1372:(t,e,r)=>{"use strict";r(366)("metadata")},4664:(t,e,r)=>{"use strict";r(366)("observable")},9671:(t,e,r)=>{"use strict";r(366)("patternMatch")},359:(t,e,r)=>{"use strict";r(366)("replaceAll")},2560:(t,e,r)=>{"use strict";r(9363);var i=r(9287),s=r(5951),n=r(4840),a=r(3742);for(var o in i)n(s[o],o),a[o]=a.Array},2222:(t,e,r)=>{"use strict";var i=r(6823);t.exports=i},8251:(t,e,r)=>{"use strict";var i=r(1926);t.exports=i},4139:(t,e,r)=>{"use strict";var i=r(3842);r(2560),t.exports=i},7045:(t,e,r)=>{"use strict";var i=r(1730);r(2560),t.exports=i},70:(t,e,r)=>{"use strict";var i=r(1661);t.exports=i}},e={};function r(i){var s=e[i];if(void 0!==s)return s.exports;var n=e[i]={exports:{}};return t[i].call(n.exports,n,n.exports,r),n.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t="MEDIASDK_CACHE_INFO",e=new class{constructor(){this._highFrequencyLogs={},this.fixVersion="",this.cacheLogStack=[],this.isFlushing=!1}setInstance(t,e){this._instance=t,this.fixVersion=e}getMessageFromErrorOrEvent(t,e){let r=t;return e instanceof ErrorEvent?(e.filename&&(r+=" File: ".concat(e.filename)),(e.lineno||e.colno)&&(r+=" Line: ".concat(e.lineno,":").concat(e.colno)),e.message&&(r+=" Message: ".concat(e.message)),e.error&&(r+="\nStack: ".concat(e.error.stack))):e instanceof Error?(e.fileName&&(r+=" File: ".concat(e.fileName)),(e.lineNumber||e.columnNumber)&&(r+=" Line: ".concat(e.lineNumber,":").concat(e.columnNumber)),e.message&&(r+=" Message: ".concat(e.message)),e.stack&&(r+=" Stack: ".concat(e.stack)),e.name&&(r+=" Name: ".concat(e.name)),e.constraint&&(r+=" Constraint: ".concat(e.constraint))):e instanceof CloseEvent?(e.code&&(r+=" Code: ".concat(e.code)),e.reason&&(r+=" Reason: ".concat(e.reason)),r+=" wasClean: ".concat(e.wasClean)):e instanceof DOMException?(e.message&&(r+=" Message: ".concat(e.message)),e.name&&(r+=" Name: ".concat(e.name))):r+=e?e.toString():"",r}_addCacheLog(t,e){this.cacheLogStack.length<100&&this.cacheLogStack.push({type:t,message:e})}flushCacheLog(){if(this._instance&&this.cacheLogStack.length>0&&!this.isFlushing){this.isFlushing=!0;let e="";this.cacheLogStack.forEach((r=>{let{type:i,message:{message:s="",tags:n=[]}}=r;const a=s?"".concat(n.join("|"),":").concat(s).concat("|----|"):"";switch(i){case"log":this._log(s,[...n,t]);break;case"warn":case"error":case"severityerror":case"directReport":e+=a}})),e&&this._directReport(e,[t]),this.cacheLogStack=[],this.isFlushing=!1}}log(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._instance?(this.flushCacheLog(),this._log(t,e)):this._addCacheLog("log",{message:t,tags:e})}warn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];t=this.getMessageFromErrorOrEvent(t,e),this._instance?(this.flushCacheLog(),this._warn(t,r)):this._addCacheLog("warn",{message:t,tags:r})}error(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];var i;t=this.getMessageFromErrorOrEvent(t,e),this._highFrequencyLogs[t]?this._highFrequencyLogs[t]+=1:this._highFrequencyLogs[t]=1,!((i=this._highFrequencyLogs[t])&i-1)&&(this._instance?(this.flushCacheLog(),this._error(t,r)):this._addCacheLog("error",{message:t,tags:r}))}severityerror(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._instance?(this.flushCacheLog(),this._severityerror(JSON.stringify(t),e)):this._addCacheLog("severityerror",{message:JSON.stringify(t),tags:e})}directReport(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["MEDIASDK_INFO"];var r;this._instance?(this.flushCacheLog(),null===(r=this._directReport)||void 0===r||r.call(this,t,e)):this._addCacheLog("directReport",{message:t,tags:e})}_log(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._instance&&this._instance.log(t,e)}_warn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._instance&&this._instance.warn(t,e)}_error(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._instance&&this._instance.error(t,[this.fixVersion,...e])}_severityerror(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._instance&&this._instance.error(t,e)}_directReport(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];var r,i;this._instance&&(null===(r=(i=this._instance).directReport)||void 0===r||r.call(i,{msg:t},e))}clearHighFrequencyLogs(){this._highFrequencyLogs={}}};var i=r(7201),s=r.n(i);new Error;const n=new Map;function a(t){var e;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"|";return t?s()(e=t.toString()).call(e,/[,，]/g,r):""}const o="function"!=typeof importScripts;function c(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o?e.error(t,r):h(t,r)}function h(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var r,i;if(e instanceof Error||e instanceof ErrorEvent){const s=e;t+=" Code: "+(null==s?void 0:s.code)+" Message: "+(null==e?void 0:e.message)+" Stack: "+(null!==(i=null===(r=null==s?void 0:s.error)||void 0===r?void 0:r.stack)&&void 0!==i?i:null==s?void 0:s.stack),e=null}postMessage({status:61,errorMessage:t,errorEvent:e})}function u(t){o?function(t,r){var i,s;if(!function(t){const e=performance.now();return(!n.has(t)||e-n.get(t)>5e3)&&(n.set(t,e),!0)}(t))return;let o;try{o=a("object"==typeof r?JSON.stringify(r):r)}catch(t){o=a(r)}null===(i=null)||void 0===i||i("NEM-".concat(t,"-").concat(o)),e.error("NotifyUIError,event=".concat(t,",data=").concat(o)),null===(s=null)||void 0===s||s(t,r)}(-51,t):postMessage({status:-27,where:t})}let l;const d=()=>l,f=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t)return;const r=new Error(e);d().tracing.Log_Error("Assert: ".concat(e),r)},p=.005;function m(t,e){const r=Math.pow(10,e);return Math.floor(t*r)/r}function _(t,e){const r=Math.pow(10,e);return Math.ceil(t*r)/r}var v=r(4997),g=r(2321),y=r(2231);function x(t){return x="function"==typeof g&&"symbol"==typeof y?function(t){return typeof t}:function(t){return t&&"function"==typeof g&&t.constructor===g&&t!==g.prototype?"symbol":typeof t},x(t)}var b=r(9280);function T(t,e,r){return(e=function(t){var e=function(t){if("object"!=x(t)||!t)return t;var e=t[b];if(void 0!==e){var r=e.call(t,"string");if("object"!=x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==x(e)?e:e+""}(e))in t?v(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const R={NO_CONFIG:0,FALLBACK_TO_TAG_RENDERER_ON_CHROME:1,FALLBACK_TO_TAG_RENDERER_ON_SAFARI:2,FALLBACK_TO_TAG_RENDERER_ON_FIREFOX:4},E={NO_CONFIG:0,TAG_RENDERER_ON_CHROME:1,TAG_RENDERER_ON_SAFARI:2,TAG_RENDERER_ON_FIREFOX:4},w=new class{constructor(){T(this,"_platformDesc",{supportGraphicsAcceleration:!1,supportVideoFrame:!1,supportMediaStreamTrackGenerator:!1,supportTransferableStream:!1,supportDrawWatermark:!1,supportVideoFrameInWorker:!1,supportVideoTrackGeneratorInWorker:!1,supportOffscreenCanvasInWorker:!1,supportImageBitmapRenderingInWorker:!1,supportTransferableTrackAcrossWork:!1,supportsRequestAnimationFrameInWork:!1}),T(this,"_inferedDesc",{supportVideoTagRenderer:!1}),T(this,"_analyzing_promise",null),T(this,"_main_analyzed",!1),T(this,"_remote_analyzed",!1),T(this,"_analyzedPromise",void 0),T(this,"_resolveAnalyzedPromise",void 0),this._analyzedPromise=new Promise(((t,e)=>{this._resolveAnalyzedPromise=t}))}init(t){this._platformDesc=t.platform,this._inferedDesc=t.infered,this._main_analyzed=!0,this._remote_analyzed=!0,this._resolveAnalyzedPromise(this._remote_analyzed)}desc(){return{platform:this._platformDesc,infered:this._inferedDesc}}analyzed(){return this._remote_analyzed}analyzedPromise(){return this._analyzedPromise}_analyzeInferredCapabilites(){this._inferedDesc.supportVideoTagRenderer=this._platformDesc.supportVideoFrame&&this._platformDesc.supportVideoFrameInWorker&&(!0===this._platformDesc.supportMediaStreamTrackGenerator&&!0===this._platformDesc.supportTransferableStream||!0===this._platformDesc.supportVideoTrackGeneratorInWorker)}analyze(t){if(this._analyzing_promise)return this._analyzing_promise;const e=t.analyzeMainCapabilites();return Object.assign(this._platformDesc,e),this._main_analyzed=!0,this._analyzing_promise=new Promise(((e,r)=>{t.analyzeRemoteCapabilities().then((t=>{Object.assign(this._platformDesc,t),this._analyzeInferredCapabilites(),this._remote_analyzed=!0,this._resolveAnalyzedPromise(this._remote_analyzed),e(!0)})).catch((t=>{this._resolveAnalyzedPromise(this._remote_analyzed),e(!1)}))})),this._analyzing_promise}supportGraphicsAcceleration(){return f(this._main_analyzed),this._platformDesc.supportGraphicsAcceleration}supportTransferableStream(){return f(this._main_analyzed),this._platformDesc.supportTransferableStream}supportDrawWatermark(){return f(this._main_analyzed),this._platformDesc.supportDrawWatermark}supportVideoTagRenderer(){return!!this._remote_analyzed&&this._inferedDesc.supportVideoTagRenderer}supportMediaStreamTrackGenerator(){return f(this._main_analyzed),this._platformDesc.supportMediaStreamTrackGenerator}supportVideoTrackGeneratorInWorker(){return!!this._remote_analyzed&&this._platformDesc.supportVideoTrackGeneratorInWorker}supportTransferableTrackAcrossWork(){return!!this._remote_analyzed&&this._platformDesc.supportTransferableTrackAcrossWork}supportsRequestAnimationFrameInWork(){return!!this._remote_analyzed&&this._platformDesc.supportsRequestAnimationFrameInWork}supportMediaStreamTrackProcessor(){return!!this._remote_analyzed&&this._platformDesc.supportMediaStreamTrackProcessor}},A=new class{constructor(){T(this,"_info",void 0),this._info={browser:{brand:"",version:"",isBlink:!1,isWebkit:!1},sysinfo:{osType:"",os:"",osVersion:""},browserVersionInfo:{ie:"",edge:"",firefox:"",opera:"",chrome:"",safari:""}}}init(t){this._info=t}info(){return this._info}browserInfo(){return this._info.browser}browserVersionInfo(){return this._info.browserVersionInfo}browserName(){var t;return null===(t=this._info.browser.brand)||void 0===t?void 0:t.toLocaleLowerCase()}isChrome(){var t;return"chrome"===(null===(t=this._info.browser.brand)||void 0===t?void 0:t.toLocaleLowerCase())}isSafari(){var t;return"safari"===(null===(t=this._info.browser.brand)||void 0===t?void 0:t.toLocaleLowerCase())}isFirefox(){var t;return"firefox"===(null===(t=this._info.browser.brand)||void 0===t?void 0:t.toLocaleLowerCase())}isBlink(){return this._info.browser.isBlink}isWebkit(){return this._info.browser.isWebkit}},S=new class{constructor(){T(this,"_desc",{defaultRendererType:1,isEnableCanvasCtxOptionsOpt:!1,isEnableFallbackToTagRender:!1,isEnableWasmTagRenderer:!1,safariYuvPaddingFixVer:void 0,chromeYuvLeftTopPaddingFixVer:void 0,isVideoHasWaterMark:!1,isSharingHasWaterMark:!1,canVideoUseTagRenderer:void 0,canSharingUseTagRenderer:void 0,canUseSsrcStream:void 0,isUseSsrcStream:!1,shouldCropWasmFrameOnPosMismatch:void 0,shouldCropWasmFrameOnSizeMismatchOnly:void 0,baseScriptUrl:"",videoWatermarkInfo:void 0,sharingWatermarkInfo:void 0,avStreamMode:void 0}),T(this,"_configDone",!1),T(this,"_configDonePromise",void 0),T(this,"_resolveConfigDonePromise",void 0),this._configDonePromise=new Promise(((t,e)=>{this._resolveConfigDonePromise=t}))}_tryResetDerivedConfigIfNeeded(){this._configDone&&(this._desc.canVideoUseTagRenderer=void 0,this._desc.canSharingUseTagRenderer=void 0,this._desc.canUseSsrcStream=void 0,this._desc.shouldCropWasmFrameOnPosMismatch=void 0,this._desc.shouldCropWasmFrameOnSizeMismatchOnly=void 0)}init(t){this._desc=t,this._configDone=!0}configDone(){return this._configDone}configDonePromise(){return this._configDonePromise}markConfigDone(){this._configDone=!0,this._resolveConfigDonePromise(!0)}desc(){return this._desc}defaultRendererType(){return this._desc.defaultRendererType}setDefaultRendererType(t){this._desc.defaultRendererType=t,this._tryResetDerivedConfigIfNeeded()}isEnableCanvasCtxOptionsOpt(){return this._desc.isEnableCanvasCtxOptionsOpt}setIsEnableCanvasCtxOptionsOpt(t){this._desc.isEnableCanvasCtxOptionsOpt=t,this._tryResetDerivedConfigIfNeeded()}isEnableWasmTagRenderer(){return this._desc.isEnableWasmTagRenderer}setWasmTagRendererFlags(t){let e=!1;A.isBlink()?e=t&E.TAG_RENDERER_ON_CHROME:A.isWebkit()?e=t&E.TAG_RENDERER_ON_SAFARI:"firefox"===A.browserName()&&(e=t&E.TAG_RENDERER_ON_FIREFOX),this._desc.isEnableWasmTagRenderer=e,this._tryResetDerivedConfigIfNeeded()}isEnableFallbackToTagRender(){return this._desc.isEnableFallbackToTagRender}setFallbackToTagRenderFlags(t){let e=!1;A.isBlink()?e=t&R.FALLBACK_TO_TAG_RENDERER_ON_CHROME:A.isWebkit()?e=t&R.FALLBACK_TO_TAG_RENDERER_ON_SAFARI:"firefox"===A.browserName()&&(e=t&R.FALLBACK_TO_TAG_RENDERER_ON_FIREFOX),this._desc.isEnableFallbackToTagRender=e,this._tryResetDerivedConfigIfNeeded()}isVideoHasWaterMark(){return this._desc.isVideoHasWaterMark}setIsVideoHasWaterMark(t){this._desc.isVideoHasWaterMark=t,this._tryResetDerivedConfigIfNeeded()}getVideoWatermarkInfo(){return this._desc.videoWatermarkInfo}setVideoWatermarkInfo(t){this._desc.videoWatermarkInfo=t}isSharingHasWaterMark(){return this._desc.isSharingHasWaterMark}setIsSharingHasWaterMark(t){this._desc.isSharingHasWaterMark=t,this._tryResetDerivedConfigIfNeeded()}getSharingWatermarkInfo(){return this._desc.sharingWatermarkInfo}setSharingWatermarkInfo(t){this._desc.sharingWatermarkInfo=t}canVideoUseTagRenderer(){return!!this._configDone&&(void 0!==this._desc.canVideoUseTagRenderer?this._desc.canVideoUseTagRenderer:w.supportVideoTagRenderer()?!w.supportGraphicsAcceleration()&&this.isEnableFallbackToTagRender()?(this._desc.canVideoUseTagRenderer=!0,this._desc.canVideoUseTagRenderer):this.isEnableWasmTagRenderer()?(this._desc.canVideoUseTagRenderer=!this.isVideoHasWaterMark(),this._desc.canVideoUseTagRenderer):(this._desc.canVideoUseTagRenderer=!1,!1):(this._desc.canVideoUseTagRenderer=!1,!1))}canSharingUseTagRenderer(){return!!this._configDone&&(void 0!==this._desc.canSharingUseTagRenderer?this._desc.canSharingUseTagRenderer:w.supportVideoTagRenderer()?!w.supportGraphicsAcceleration()&&this.isEnableFallbackToTagRender()?(this._desc.canSharingUseTagRenderer=!0,this._desc.canSharingUseTagRenderer):this.isEnableWasmTagRenderer()?(this._desc.canSharingUseTagRenderer=!this.isSharingHasWaterMark(),this._desc.canSharingUseTagRenderer):(this._desc.canSharingUseTagRenderer=!1,!1):(this._desc.canSharingUseTagRenderer=!1,!1))}canUseSsrcStream(){if(!this._configDone)return!1;if(void 0!==this._desc.canUseSsrcStream)return this._desc.canUseSsrcStream;let t=this.canVideoUseTagRenderer(),e=this.canSharingUseTagRenderer();return f(t==e),this._desc.canUseSsrcStream=t&&e,this._desc.canUseSsrcStream}isUseSsrcStream(){return this._desc.isUseSsrcStream}setIsUseSsrcStream(t){this._desc.isUseSsrcStream=t}setSafariYuvPaddingFixVer(t){"[object String]"===Object.prototype.toString.call(t)&&(this._desc.safariYuvPaddingFixVer=t,this._tryResetDerivedConfigIfNeeded())}setChromeYuvLeftTopPaddingFixVer(t){"[object String]"===Object.prototype.toString.call(t)&&(this._desc.chromeYuvLeftTopPaddingFixVer=t,this._tryResetDerivedConfigIfNeeded())}_versionGreaterThan(t,e){const r=e.toString().split("."),i=t.toString().split("."),s=r.length,n=i.length,a=Math.min(s,n);for(let t=0;t<a;t++){const e=parseInt(r[t],10),s=parseInt(i[t],10);if(e!==s)return s>e}return n>=s}shouldCropWasmFrameOnPosMismatch(){return!!this._configDone&&(void 0!==this._desc.shouldCropWasmFrameOnPosMismatch?this._desc.shouldCropWasmFrameOnPosMismatch:this.canVideoUseTagRenderer()||this.canSharingUseTagRenderer()?(this._desc.shouldCropWasmFrameOnPosMismatch=!0,A.isChrome()?this._desc.chromeYuvLeftTopPaddingFixVer&&this._versionGreaterThan(A.browserVersionInfo().chrome,this._desc.chromeYuvLeftTopPaddingFixVer)&&(this._desc.shouldCropWasmFrameOnPosMismatch=!1):A.isSafari()&&this._desc.safariYuvPaddingFixVer&&this._versionGreaterThan(A.browserVersionInfo().safari,this._desc.safariYuvPaddingFixVer)&&(this._desc.shouldCropWasmFrameOnPosMismatch=!1),this._desc.shouldCropWasmFrameOnPosMismatch):(this._desc.shouldCropWasmFrameOnPosMismatch=!1,!1))}shouldCropWasmFrameOnSizeMismatchOnly(){return!!this._configDone&&(void 0!==this._desc.shouldCropWasmFrameOnSizeMismatchOnly?this._desc.shouldCropWasmFrameOnSizeMismatchOnly:(this.canVideoUseTagRenderer()||this.canSharingUseTagRenderer())&&A.isWebkit()?(A.isSafari()&&this._desc.safariYuvPaddingFixVer&&this._versionGreaterThan(A.browserVersionInfo().safari,this._desc.safariYuvPaddingFixVer)?this._desc.shouldCropWasmFrameOnSizeMismatchOnly=!1:this._desc.shouldCropWasmFrameOnSizeMismatchOnly=!0,this._desc.shouldCropWasmFrameOnSizeMismatchOnly):(this._desc.shouldCropWasmFrameOnSizeMismatchOnly=!1,!1))}shouldCropWasmFrame(t,e,r){return!!this._configDone&&(t!=r.width||e!=r.height)&&(S.shouldCropWasmFrameOnSizeMismatchOnly()||S.shouldCropWasmFrameOnPosMismatch()&&(0!=r.x||0!=r.y))}getBaseScriptUrl(){return this._desc.baseScriptUrl}setBaseScriptUrl(t){this._desc.baseScriptUrl=t}getAVStreamMode(){return this._configDone?(void 0!==this._desc.avStreamMode||(w.supportTransferableStream()?this._desc.avStreamMode="writable-stream":w.supportTransferableTrackAcrossWork()?this._desc.avStreamMode="track":this._desc.avStreamMode="none"),this._desc.avStreamMode):"none"}},M={mgr:null,config:S,capabilities:w,userAgent:A,tracing:{add_monitor(t){!function(t){postMessage({status:35,data:t})}(t)},globaltracing_error(t){h(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)},Log_Error(t){c(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}},graphics:{create_webgl_context_failed_monitor(t){u(t)},calculateUVCoord:(t,e,r,i)=>function(t,e,r,i){if(!t||!e||!r)return null;const s=e.width/e.height;let n=e.width,a=e.height;if(e.width>t.width||e.height>t.height){const r=t.width/e.width,i=t.height/e.height,s=Math.min(r,i);n*=s,a*=s}let o=0,c=0;t.width/t.height>s?(c=Math.floor(t.height/a)*a,o=Math.floor(c*s/n)*n,o>t.width&&(o=Math.floor(t.width/n)*n,c=Math.floor(o/s/a)*a)):(o=Math.floor(t.width/n)*n,c=Math.floor(o/s/a)*a,c>t.height&&(c=Math.floor(t.height/a)*a,o=Math.floor(c*s/n)*n));let h=0,u=0,l=0,d=0,f={x:u,y:h,w:l,h:d};0==i?(h=1-(h+(a-1)/t.height),u=e.left/t.width,d=1-e.top/t.height,l=u+n/t.width,f.x=u,f.y=1-d,f.w=l,f.h=1-h):1==i?(u=1-(h+(a-1)/t.height),l=1-e.top/t.height,h=e.left/t.width,d=u+n/t.width):2==i?(h=e.top/t.height,u=e.left/t.width,d=h+(a-1)/t.height,l=u+n/t.width):3==i&&(u=e.top/t.height,l=h+(a-1)/t.height,h=e.left/t.width,d=u+n/t.width);let p=[],m=[{x:l,y:d},{x:l,y:h},{x:u,y:h},{x:l,y:d},{x:u,y:d},{x:u,y:h}];for(let t=0;t<m.length;++t){let e={u:m[t].x,v:m[t].y};p.push(e)}let _=[];for(let t=0;t<p.length;++t){let e=p[t];_.push(e.u),_.push(e.v)}return{uvCoords:_,uvRect:f}}(t,e,r,i),calculateUVCoordsForMultiView:(t,e,r,i,s,n)=>function(t,e,r,i,s,n){let a=0,o=0,c=0,h=0,u={x:o,y:a,w:c,h};if(t){const t=1==s||3==s?e.height/e.width:e.width/e.height,n=i.left||0,u=i.top||0;if(i.width/i.height>t){const e=i.height*t;a=u/r.height,o=(Math.round((i.width-e)/2)+n)/r.width,h=a+(i.height-1)/r.height,c=o+e/r.width}else{const e=i.width/t;a=(Math.round((i.height-e)/2)+u)/r.height,o=n/r.width,h=a+(e-1)/r.height,c=o+i.width/r.width}0==s?(a=1-(a+(i.height-1)/r.height),o=i.left/r.width,h=1-i.top/r.height,c=o+i.width/r.width):1==s?(o=1-(a+(i.height-1)/r.height),c=1-i.top/r.height,a=i.left/r.width,h=o+i.width/r.width):2==s?(a=i.top/r.height,o=i.left/r.width,h=a+(i.height-1)/r.height,c=o+i.width/r.width):3==s&&(o=i.top/r.height,c=a+(i.height-1)/r.height,a=i.left/r.width,h=o+i.width/r.width)}else{const t=i.width/i.height;let e=i.width,n=i.height;if(i.width>r.width||i.height>r.height){const t=r.width/i.width,s=r.height/i.height,a=Math.min(t,s);e*=a,n*=a}let l=0,d=0;r.width/r.height>t?(d=Math.floor(r.height/n)*n,l=Math.floor(d*t/e)*e,l>r.width&&(l=Math.floor(r.width/e)*e,d=Math.floor(l/t/n)*n)):(l=Math.floor(r.width/e)*e,d=Math.floor(l/t/n)*n,d>r.height&&(d=Math.floor(r.height/n)*n,l=Math.floor(d*t/e)*e)),0==s?(a=1-(a+(n-1)/r.height),o=i.left/r.width,h=1-i.top/r.height,c=o+e/r.width,u.x=o,u.y=1-h,u.w=c,u.h=1-a,i.height>i.width&&(o=_(o,2),c=m(c,2))):1==s?(o=1-(a+(n-1)/r.height),c=1-i.top/r.height,a=i.left/r.width,h=o+e/r.width):2==s?(a=i.top/r.height,o=i.left/r.width,h=a+(n-1)/r.height,c=o+e/r.width):3==s&&(o=i.top/r.height,c=a+(n-1)/r.height,a=i.left/r.width,h=o+e/r.width)}let l=[],d=[{x:c,y:h},{x:c,y:a},{x:o,y:a},{x:c,y:h},{x:o,y:h},{x:o,y:a}];for(let t=0;t<d.length;++t){let e=null;if(n){let r=-1*Math.abs(d[t].x);d[t].x=r,e={u:d[t].x+1,v:d[t].y}}else e={u:d[t].x,v:d[t].y};l.push(e)}let f=[];for(let t=0;t<l.length;++t){let e=l[t];f.push(e.u),f.push(e.v)}return{uvCoords:f,uvRect:u}}(t,e,r,i,s,n),calculateRenderRect:(t,e)=>function(t,e){let r=0,i=0,s=0,n=0;const a=e.width/e.height;return t.width/t.height>a?(i=t.height,r=i*a,s=(t.width-r)/2,n=0):(r=t.width,i=r/a,s=0,n=(t.height-i)/2),r<=t.canvas.width&&(s=(t.canvas.width-r)/2),i<=t.canvas.height&&(n=(t.canvas.height-i)/2),{x:s,y:n,width:r,height:i}}(t,e),evalCroppingRect:(t,e)=>function(t,e){if(!t||null==e)throw new Error("evalCroppingRect() invalid parameters!");return 1===e||3===e?{top:t.top,left:t.left,width:t.height,height:t.width}:t}(t,e)},assertion:{assert(t){f(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")},assertWithFailed(t){!function(t){const e=new Error(t);d().tracing.Log_Error("AssertWithFailed: ".concat(t),e)}(t)},abstractMethod(){!function(){const t=new Error("call abstract method!");d().tracing.Log_Error("AbstractMethod!",t)}()},unreachable(){!function(){const t=new Error("Unreachable code reached!");d().tracing.Log_Error("Unreachable!",t)}()}}};var O;!function(t){t.VB_INIT_SUCCESS="VB_INIT_SUCCESS",t.VB_INIT_FAILED="VB_INIT_FAILED",t.VB_GENERATED_FRAME="VB_GENERATED_FRAME",t.VB_SEND_FRAME="VB_SEND_FRAME",t.VB_UPDATE_BG="VB_UPDATE_BG",t.VB_PREDICT_DONE="VB_PREDICT_DONE",t.VB_MODEL_READY="VB_MODEL_READY",t.VB_FREE_MEMORY="VB_FREE_MEMORY",t.VB_VIDEO_FORMAT_UNSUPPORTED="VB_VIDEO_FORMAT_UNSUPPORTED",t.VB_WORKER_INIT="VB_WORKER_INIT",t.VB_WORKER_ERROR="VB_WORKER_ERROR",t.VB_RENDER_CANVAS="VB_RENDER_CANVAS",t.VB_RENDER_FRAME="VB_RENDER_FRAME",t.VB_START="VB_START",t.VB_REQUEST_FRAME="VB_REQUEST_FRAME",t.VB_TOGGLE_VB="VB_TOGGLE_VB",t.VB_STOP="VB_STOP",t.VB_MIRROR="VB_MIRROR",t.VB_GENERATE_STREAM="VB_GENERATE_STREAM",t.VB_STOP_STREAM="VB_STOP_STREAM",t.VB_CHANGE_STREAM_CANVAS_SIZE="VB_CHANGE_STREAM_CANVAS_SIZE",t.VB_GENERATE_FIRST_FRAME="VB_GENERATE_FIRST_FRAME",t.VB_UPDATE_STATS="VB_UPDATE_STATS",t.VB_UPDATE_NEED_FRAME="VB_UPDATE_NEED_FRAME",t.VB_UPDATE_FRAME_RATE="VB_UPDATE_FRAME_RATE",t.VB_RESOLUTION_CHANGE="VB_RESOLUTION_CHANGE"}(O||(O={}));const F={VIDEO_ENCODE:"0",VIDEO_DECODE:"1",AUDIO_ENCODE:"2",AUDIO_DECODE:"3",SHARING_ENCODE:"4",SHARING_DECODE:"5",WORKER_SERVICE:"6",NET:"net",MESH:"mesh"};function C(t){postMessage({status:61,errorMessage:t,level:"low"})}(()=>{const t={};for(const e in F)t[F[e]]="WCL_"+e})();const L=["","MOZ_","OP_","WEBKIT_"];function D(t,e){for(var r=0;r<L.length;++r){var i=L[r]+e,s=t.getExtension(i);if(s)return s}}new Map,new class{constructor(){this.ssrcInfoMap=new Map,this.timer=null}updateSSRCInfo(t,e){this.ssrcInfoMap.has(t)||this.ssrcInfoMap.set(t,{firstTime:0,lastTime:0,frames:0,fps:0}),this._calculateFPS(t,e),this._removeZeroFPS()}_calculateFPS(t,e){const r=this.ssrcInfoMap.get(t);if(0===r.frames?r.firstTime=e:r.lastTime=e,r.frames+=1,r.frames>2&&r.frames%5==0&&r.lastTime-r.firstTime>=1e3){const e=Math.floor(1e3/((r.lastTime-r.firstTime)/(r.frames-1)));r.fps!==e&&(this._notifyFPS(t,e),r.fps=e),r.firstTime=r.lastTime,r.frames=1}}_removeZeroFPS(){let t=Date.now();this.ssrcInfoMap.forEach(((e,r)=>{const i=this.ssrcInfoMap.get(r);i&&i.lastTime&&t-i.lastTime>2e3&&(this.ssrcInfoMap.delete(r),this._notifyFPS(r,0))}))}_notifyFPS(t,e){postMessage({status:66.6,data:{ssrc:t,fps:e}})}_checkIfNewFrameComing(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((()=>{this._removeZeroFPS(),this.timer=null}),2500)}},new class{constructor(){this.ssrcInfoMap=new Map,this.timer=null}updateSSRCInfo(t,e){this.ssrcInfoMap.has(t)||this.ssrcInfoMap.set(t,{timeList:[],lastTime:0,fps:0}),this._calculateFPS(t,e),this._removeZeroFPS(),this._checkIfNewFrameComing()}_calculateFPS(t,e){const r=this.ssrcInfoMap.get(t);if(r.timeList.push(e),r.lastTime=e,r.timeList.length>2){const e=r.timeList[0],i=r.timeList[r.timeList.length-1];if(i-e>=1e3){const s=Math.floor(1e3/((i-e)/(r.timeList.length-1)));r.fps!==s&&(this._notifyFPS(t,s),r.fps=s),r.timeList=[]}}r.timeList.length>30&&(r.timeList=r.timeList.slice(r.timeList.length-30))}_removeZeroFPS(){this.ssrcInfoMap.forEach(((t,e)=>{const r=this.ssrcInfoMap.get(e);r&&Date.now()-r.lastTime>2e3&&(this.ssrcInfoMap.delete(e),this._notifyFPS(e,0))}))}_notifyFPS(t,e){postMessage({status:66.6,data:{ssrc:t,fps:e}})}_checkIfNewFrameComing(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((()=>{this._removeZeroFPS(),this.timer=null}),2500)}};class I{constructor(t,e,r){var i;this.canvas=t,this.gl=null===(i=this.canvas)||void 0===i?void 0:i.getContext("webgl2"),this.glExtension=D(this.gl,"WEBGL_lose_context"),this.onContextLost=e,this.onContextRestored=r,this.addEventListeners()}addEventListeners(){var t,e;null===(t=this.canvas)||void 0===t||t.addEventListener("webglcontextlost",(t=>{var e;t.preventDefault(),this.onContextLost&&this.onContextLost(t),null===(e=this.glExtension)||void 0===e||e.restoreContext()})),null===(e=this.canvas)||void 0===e||e.addEventListener("webglcontextrestored",(()=>{this.onContextRestored&&this.onContextRestored()}))}}var U=function(t,e,r,i){return new(r||(r=Promise))((function(s,n){function a(t){try{c(i.next(t))}catch(t){n(t)}}function o(t){try{c(i.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}c((i=i.apply(t,e||[])).next())}))};self.GetWebCodecsEncoderL1T2Flag_js=()=>1,self.LimitWebCodecsEncoderTo360_js=()=>!1,self.LimitWebCodecsDecoderTo360_js=()=>!1,self.hardcodecpunumber=()=>navigator.hardwareConcurrency||1,self.IsSupportMultiThread=()=>0,self.js_info_from_wcl_video_data=(t,e,r,i,s,n)=>{Module._free(e)},self.GetLogLevel_js=()=>0;const k=class{constructor(){this.isSABEnable=!!self.SharedArrayBuffer,this.afnModelArtifacts={},this.afnIOHandle={},this.baseModelArtifacts={},this.baseIOHandle={},this.modelLoadedCount=0,this.manualFreeMemory=!1,this.backend="",this.tfHelper=null,this.afnIOHandle.load=()=>this.afnModelArtifacts,this.afnIOHandle.save=()=>{},this.baseIOHandle.load=()=>this.baseModelArtifacts,this.baseIOHandle.save=()=>{},this.vbFrameCallback=this.vbFrameCallback.bind(this),this.executeBase=this.executeBase.bind(this),this.executeAfn=this.executeAfn.bind(this)}GET_HEAP_U8(){return self.GROWABLE_HEAP_U8?self.GROWABLE_HEAP_U8():Module.HEAPU8}GET_HEAD_F32(){return self.GROWABLE_HEAP_F32?self.GROWABLE_HEAP_F32():Module.HEAPF32}vbFrameCallback(t,e,r,i,s,n,a,o,c,h){const u={data:this.GET_HEAP_U8().subarray(e+0,e+r),data_ptr:this.isSABEnable?e:null,len_of_data:r,format_width:i,format_height:s,valid_x:n,valid_y:a,valid_width:o,valid_height:c,yuv_limited:h};this.onVBFrame&&this.onVBFrame(u),this.isSABEnable&&this.manualFreeMemory||Module._free(e)}executeBase(t,e,r,i){return tf.tidy((()=>{var s=new Float32Array(wasmMemory.buffer,t,e),n=tf.tensor4d(s,[1,144,256,3],"float32"),a=this.baseModel.predict(n);1==a[1].size?(this.mask=Float32Array.from(a[0].as1D(36864).arraySync()),this.prob=Float32Array.from(a[1].as1D(1).arraySync())):(this.mask=Float32Array.from(a[1].as1D(36864).arraySync()),this.prob=Float32Array.from(a[0].as1D(1).arraySync()));let o=new Float32Array(wasmMemory.buffer);o.set(this.mask,r>>2),o.set(this.prob,i>>2)})),0}executeAfn(t,e,r,i,s){return tf.tidy((()=>{var n=new Float32Array(wasmMemory.buffer,t,i),a=new Float32Array(wasmMemory.buffer,e,i),o=new Float32Array(wasmMemory.buffer,r,i/3),c=tf.tensor4d(n,[1,144,256,3],"float32"),h=tf.tensor4d(a,[1,144,256,3],"float32"),u=tf.tensor4d(o,[1,144,256,1],"float32"),l=this.afnModel.predict([c,h,u]);this.mask=Float32Array.from(l.as1D(36864).arraySync()),this.GET_HEAD_F32().set(this.mask,s>>2)})),0}getResourceUrl(t){return{tfJsUrl:"".concat(t,"/vb-resource/tf.min.js"),modelUrl:"".concat(t,"/vb-resource/dualModel.bin"),wasmGlueCodeUrl:this.isSABEnable?"".concat(t,"/video.mtsimd.js"):"".concat(t,"/video.simd.js"),wasmUrl:this.isSABEnable?"".concat(t,"/video.mtsimd.wasm"):"".concat(t,"/video.simd.wasm"),wasmBackendUrl:"".concat(t,"/vb-resource/tf-backend-wasm.min.js")}}decryptData(t,e,r){return self.crypto.subtle.decrypt({name:"AES-GCM",iv:r},e,t)}modelLoadReady(){this.modelLoadedCount++,2===this.modelLoadedCount&&this.onModelReady&&this.onModelReady()}loadWasm(t,e){return self.Module={locateFile:()=>e},importScripts(t),new Promise(((t,e)=>{Module.onRuntimeInitialized=()=>{this.create_vb_no_sab_thread=Module.cwrap("_create_vb_no_sab_thread","number",[]),this.signal_vb_thread_bg=Module.cwrap("_signal_vb_thread_bg","number",["number","number","number","number"]),this.signal_vb_thread_blur=Module.cwrap("_signal_vb_thread_blur","number",["number","number"]),this.signal_vb_thread_video_yuv=Module.cwrap("_signal_vb_thread_video_yuv","number",["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"]),this.signal_vb_thread_video_rgba=Module.cwrap("_signal_vb_thread_video_rgba","number",["number","number","number","number","number","number","number","number"]),t()},Module.onAbort=()=>{e("wasm initialize failed")}}))}initTF(t,e,r,i,s){return U(this,void 0,void 0,(function*(){var n;let a=!1,o=!1,c=null;importScripts(t);try{a=yield tf.setBackend("webgl"),tf.env().set("WEBGL_PACK_CONV2DTRANSPOSE",!1)}catch(t){c=t}if(!a&&r){if(!i||!s)return Promise.reject("No webAssembly backend resource provided");importScripts(i),tf.wasm.setWasmPaths(s+"/vb-resource/");try{o=yield tf.setBackend("wasm")}catch(t){c=t}}return a||o?(this.backend=tf.getBackend(),a&&!this.tfHelper&&(this.tfHelper=new I(null===(n=tf.backend())||void 0===n?void 0:n.canvas,null,(()=>U(this,void 0,void 0,(function*(){tf.disposeVariables(),tf.engine().reset(),tf.setBackend("webgl").then((()=>{this.initializeAiModel(e)}))}))))),this.initializeAiModel(e)):Promise.reject(c)}))}initializeAiModel(t){return U(this,void 0,void 0,(function*(){if("string"==typeof t){const e=yield fetch(t);if(!e.ok){const{url:t,status:r}=e;throw new Error("Fetch model file failed. url: ".concat(t,", status: ").concat(r))}t=yield e.arrayBuffer()}yield this.DecryptDualModel(t),this.onPredictDone&&this.onPredictDone()}))}initializeAfnModel(t,e){return U(this,void 0,void 0,(function*(){var r=JSON.parse(e);if(this.afnModelArtifacts.modelTopology=r.modelTopology,this.afnModelArtifacts.format=r.format,this.afnModelArtifacts.generatedBy=r.generatedBy,this.afnModelArtifacts.convertedBy=r.convertedBy,r.weightsManifest)for(var i=0;i<r.weightsManifest.length;i++)this.afnModelArtifacts.weightSpecs=r.weightsManifest[i].weights;r.trainingConfig&&(this.afnModelArtifacts.trainingConfig=r.trainingConfig),r.userDefinedMetadata&&(this.afnModelArtifacts.userDefinedMetadata=r.userDefinedMetadata),this.afnModelArtifacts.weightData=t,this.afnModel=yield tf.loadGraphModel(this.afnIOHandle),this.modelLoadReady();var s=new Float32Array(110592),n=new Float32Array(110592),a=new Float32Array(36864),o=tf.tensor4d(s,[1,144,256,3],"float32"),c=tf.tensor4d(n,[1,144,256,3],"float32"),h=tf.tensor4d(a,[1,144,256,1],"float32");this.afnModel.predict([o,c,h])}))}initializeBaseModel(t,e){return U(this,void 0,void 0,(function*(){var r=JSON.parse(e);if(this.baseModelArtifacts.modelTopology=r.modelTopology,this.baseModelArtifacts.format=r.format,this.baseModelArtifacts.generatedBy=r.generatedBy,this.baseModelArtifacts.convertedBy=r.convertedBy,r.weightsManifest)for(var i=0;i<r.weightsManifest.length;i++)this.baseModelArtifacts.weightSpecs=r.weightsManifest[i].weights;r.trainingConfig&&(this.baseModelArtifacts.trainingConfig=r.trainingConfig),r.userDefinedMetadata&&(this.baseModelArtifacts.userDefinedMetadata=r.userDefinedMetadata),this.baseModelArtifacts.weightData=t,this.baseModel=yield tf.loadGraphModel(this.baseIOHandle),this.modelLoadReady();var s=new Float32Array(110592),n=tf.tensor4d(s,[1,144,256,3],"float32");this.baseModel.predict(n)}))}DecryptDualModel(t){return U(this,void 0,void 0,(function*(){let e=new Uint8Array(t,0,12),r=new Uint8Array(t,12,32);const i=yield self.crypto.subtle.importKey("raw",r,"AES-GCM",!0,["encrypt","decrypt"]);let s=e.length+r.length,n=new Uint32Array(t.slice(s,s+4))[0];s+=4;let a=t.slice(s,s+n);s+=n,n=new Uint32Array(t.slice(s,s+4))[0],s+=4;let o=new Uint8Array(t,s,n);s+=n,n=new Uint32Array(t.slice(s,s+4))[0],s+=4;let c=t.slice(s,s+n);s+=n,n=new Uint32Array(t.slice(s,s+4))[0],s+=4;let h=new Uint8Array(t,s,n);yield Promise.all([(()=>U(this,void 0,void 0,(function*(){const t=yield this.decryptData(h,i,e),r=(new TextDecoder).decode(t);yield this.initializeAfnModel(c,r)})))(),(()=>U(this,void 0,void 0,(function*(){const t=yield this.decryptData(o,i,e),r=(new TextDecoder).decode(t);yield this.initializeBaseModel(a,r)})))()])}))}initialize(t){return U(this,void 0,void 0,(function*(){const{cdnPath:e,enableWasm:r=!1,needFrame:i=!1}=t;let s=null;e&&(s=this.getResourceUrl(e));const{tfJsUrl:n=(null==s?void 0:s.tfJsUrl),wasmGlueCodeUrl:a=(null==s?void 0:s.wasmGlueCodeUrl),wasmUrl:o=(null==s?void 0:s.wasmUrl),model:c=(null==s?void 0:s.modelUrl)}=t;if(!(n&&a&&o&&c))return Promise.reject("Wrong parameter");this.manualFreeMemory=i,yield Promise.all([this.initTF(n,c,r,null==s?void 0:s.wasmBackendUrl,e),this.loadWasm(a,o)]),this.create_vb_no_sab_thread(),this.signal_vb_thread_blur(0,0),self.execute_base=this.executeBase,self.execute_afn=this.executeAfn,self.processed_capture_data_callback=this.vbFrameCallback}))}generateVBFrame(t){return U(this,void 0,void 0,(function*(){if("format"in t){const{format:e}=t,{width:r,height:i}=t.visibleRect;let s,n,a,o,c,h,u,l,d,f,p,m,_,v;if(n=r,a=i,f=t.allocationSize(),"NV12"===e||"BGRA"===e||"I420"===e||"I420A"===e){p=Module._malloc(f);const g=this.GET_HEAP_U8().subarray(p,p+f);try{yield t.copyTo(g)}catch(e){throw t.close(),Module._free(p),new Error("VB_VIDEOFRAME_COPYTO_ERROR")}try{"NV12"===e?(o=r*i,c=r*i/2,h=r,u=h,l=0,d=0,this.signal_vb_thread_video_yuv(p,0,n,a,p,o,p+o,c,p+o,c,h,u,u,l,d,3)):"BGRA"===e?(h=r,m=i,l=0,d=0,s=4,this.signal_vb_thread_video_rgba(p,f,n,a,4*n,0,0,s)):"I420"!==e&&"I420A"!==e||(h=r,m=i,u=h/2,_=h/2,o=r*i,c=r*i/4,v=r*i/4,l=0,d=0,s=2,this.signal_vb_thread_video_yuv(p,0,n,a,p,o,p+o,c,p+o+c,c,h,u,u,l,d,s))}catch(t){Module._free(p)}}else this.onUnsupportedFrame&&this.onUnsupportedFrame(e||"");t.close()}else{const{width:e,height:r,data:i}=t,s=Module._malloc(e*r*4);let n=this.GET_HEAP_U8().subarray(s,s+i.length);const a=i.length;n.set(i,0),this.signal_vb_thread_video_rgba(s,a,e,r,4*e,0,0,1)}}))}free(t){Module._free(t)}setBackgroundImage(t){const{data:e,width:r,height:i}=t,s=Module._malloc(e.length);let n=new Uint8Array(e);this.GET_HEAP_U8().subarray(s,s+e.length).set(n,0),this.signal_vb_thread_bg(s,n.length,r,i)}blur(){this.signal_vb_thread_blur(0,0)}},P=0,N=3;function B(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function G(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?B(Object(r),!0).forEach((function(e){T(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}new Map([["useinbandfec",1],["maxaveragebitrate",48e3],["maxplaybackrate",24e3],["sprop-maxcapturerate",24e3],["sprop-stereo",null],["stereo",null]]),new Map([["useinbandfec",null],["maxaveragebitrate",96e3],["maxplaybackrate",48e3],["sprop-maxcapturerate",48e3],["sprop-stereo",1],["stereo",1]]),new Map([["useinbandfec",null],["maxaveragebitrate",96e3],["maxplaybackrate",48e3],["sprop-maxcapturerate",48e3],["sprop-stereo",1],["stereo",1]]),new Map([["useinbandfec",null],["maxaveragebitrate",128e3],["maxplaybackrate",48e3],["sprop-maxcapturerate",48e3],["sprop-stereo",1],["stereo",1]]),new Map([["useinbandfec",null],["maxaveragebitrate",128e3],["maxplaybackrate",48e3],["sprop-maxcapturerate",48e3],["sprop-stereo",1],["stereo",1]]),new Map([["useinbandfec",null],["maxaveragebitrate",96e3],["maxplaybackrate",48e3],["sprop-maxcapturerate",48e3]]),new Map([["useinbandfec",1],["maxaveragebitrate",64e3],["maxplaybackrate",24e3],["sprop-maxcapturerate",24e3],["sprop-stereo",null],["stereo",null]]),new Map([["stereo",1]]);let V=new Map,W=[];function j(t){t.preventDefault()}function H(t,e,r,i,s,n,a){let o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.canvasElement=t,this.canvasID=e,this.contextOptions=s,this.textureindex=r||0,this.texturestride=this.textureindex?3:a?4:6,this.initmask=a||!1,this.reuse=!1,this.isEnableCanvasAlphaChannel=o,H.prototype.ROTATION_CLOCK0=0,H.prototype.ROTATION_CLOCK90=1,H.prototype.ROTATION_CLOCK180=2,H.prototype.ROTATION_CLOCK270=3,this.webGLResources=n,n||(this.initContextGL(),this.contextGL&&(this.webGLContextLostProtect(),this.contextGL.isContextLost()&&this.restoreContext())),this.reinit(n);var c=new ArrayBuffer(4);this.dummpyCursor=new Uint8Array(c),this.dummpyWaterMark=new Uint8Array(c),this.cursorWidth=0,this.cursorHeight=0,this.hasCursor=0,this.hasWaterMark=0,this.watermarkOpacity=.15,this.watermarkData=null,this.watermarkWidth=0,this.watermarkHeight=0,this.isMultiView=!1,this.hasWholeFrame=0,this.croppingParams={},this.croppingParams.top=0,this.croppingParams.left=0,this.croppingParams.width=0,this.croppingParams.height=0,this.textureWidth=0,this.textureHeight=0,this.canvasWidth=0,this.canvasHeight=0,this.picRotation=-1,this.bgColor=[0,0,0],this.cx=0,this.cy=0,this.cw=0,this.ch=0,this.colorRange=-1,this.videoMode=-1,this.rotation=this.ROTATION_CLOCK0,this.fillMode=0,this.fillModeForResolution=0,this.viewPostion=null,this.enable_rounded_corner=0,this.radius_lt_x=0,this.radius_lt_y=0,this.radius_lb_x=0,this.radius_lb_y=0,this.radius_rt_x=0,this.radius_rt_y=0,this.radius_rb_x=0,this.radius_rb_y=0,this.aa_width=p,this.viewport_rect=null}H.prototype.reinit=function(t){if(this.webGLResources=t,!this.contextGL||this.contextGL.isContextLost()||this.contextGL.glInitSucceed||this.webGLResources){if(this.webGLResources&&this.webGLResources.contextgl&&!this.webGLResources.contextgl.isContextLost()){this.contextGL=this.webGLResources.contextgl,this.shaderProgram=this.webGLResources.program,this.waterMarkTextureRef=this.webGLResources.waterMarkTextureRef,this.repeatedWaterMarkTextureRef=this.webGLResources.repeatedWaterMarkTextureRef,this.initTextures(!1),this.vertexPosBuffer=this.webGLResources.vBuffer,this.texturePosBuffer=this.webGLResources.tBuffer;let t=this.contextGL.getError();this.contextGL.glInitSucceed=t!=this.contextGL.NO_ERROR&&t!=this.contextGL.CONTEXT_LOST_WEBGL?0:1}}else{this.initProgram(),this.initmask?this.initTextures(!1):this.initTextures(!0),this.initBuffers();let t=this.contextGL.getError();this.contextGL.glInitSucceed=t!=this.contextGL.NO_ERROR&&t!=this.contextGL.CONTEXT_LOST_WEBGL?0:1}},H.prototype.webGLContextLostSimulate=function(){let t="undefined"==typeof window?self:window;t.webGLEXTSimulate=t.webGLEXTSimulate||[],t.webGLEXTSimulate.push(D(this.contextGL,"WEBGL_lose_context"))},H.prototype.restoreContext=function(){if(this.contextGL)try{var t,e;null!==(t=this.canvasElement)&&void 0!==t&&t.loseContextExtension&&!this.canvasElement.restoreTimeoutId&&this.contextGL.isContextLost()&&(this.canvasElement.restoreTimeoutId=setTimeout((()=>{u("WebGLRestoreTimeout")}),1500),null===(e=this.canvasElement)||void 0===e||e.loseContextExtension.restoreContext())}catch(t){c("webgl restoreContext exception",t)}},H.prototype.webgGLContextLostCallback=function(t){C("webglcontextlost event: canvas listener size=".concat(W.length,",  canvas id: ").concat(this.canvasID,", , ids:").concat(W.join())),t.preventDefault(),this.contextGL.glInitSucceed=0,this.contextOptions&&this.contextOptions.webglcontextlostCallback&&this.contextOptions.webglcontextlostCallback(t,this.contextOptions.params)},H.prototype.removeEventListener=function(t,e){if(t&&e){t.restoreTimeoutId&&(clearTimeout(t.restoreTimeoutId),t.restoreTimeoutId=void 0),t.removeEventListener("webglcontextlost",e.contextLostHandler),t.removeEventListener("webglcontextrestored",e.contextRestoredHandler);const r=W.indexOf(this.canvasID);W.splice(r,1),V.delete(t)}},H.prototype.webGLContextRestoredCallback=function(t){C("webglcontextrestored event from canvas id: ".concat(this.canvasID)),this.canvasElement.restoreTimeoutId&&(clearTimeout(this.canvasElement.restoreTimeoutId),this.canvasElement.restoreTimeoutId=void 0),this.reinit(),this.contextOptions&&this.contextOptions.webglcontextrestoredCallback&&this.contextOptions.webglcontextrestoredCallback(t,this.contextOptions.params)},H.prototype.webGLContextLostProtect=function(){this.canvasElement&&!this.canvasElement.loseContextExtension&&(this.canvasElement.loseContextExtension=D(this.contextGL,"WEBGL_lose_context"));let t=this.canvasElement,e=V.get(t);e&&this.removeEventListener(t,e),V.set(t,this),this.contextLostHandler=this.webgGLContextLostCallback.bind(this),this.contextRestoredHandler=this.webGLContextRestoredCallback.bind(this),t.addEventListener("webglcontextlost",this.contextLostHandler,{capture:!1}),t.addEventListener("webglcontextrestored",this.contextRestoredHandler,{capture:!1}),-1===W.indexOf(this.canvasID)&&(W.push(this.canvasID),W.length>4&&C("webglcanvas listener size=".concat(W.length,", ids:").concat(W.join())))},H.prototype.isWebGL=function(){return this.contextGL},H.prototype.isAvaiable=function(){return this.contextGL&&!this.contextGL.isContextLost()&&this.contextGL.glInitSucceed},H.prototype.initContextGL=function(){for(var t,e,r,i=this.canvasElement,s=null,n=["webgl","experimental-webgl","moz-webgl","webkit-3d"],a=0;!s&&a<n.length;){var o=n[a];try{if(d().config.isEnableCanvasCtxOptionsOpt()){let t={depth:!1,stencil:!1,antialias:!1,alpha:this.isEnableCanvasAlphaChannel};if(this.contextOptions){let e=G(G({},this.contextOptions),t);s=i.getContext(o,e)}else s=i.getContext(o,t)}else s=this.contextOptions?i.getContext(o,this.contextOptions):i.getContext(o)}catch(t){s=null}s&&"function"==typeof s.getParameter||(s=null),++a}if(this.contextGL=s,!s||s.isContextLost())return c("Failed when trying to get WebGLContext on canvas(".concat(null===(t=this.canvasElement)||void 0===t?void 0:t.width,",").concat(null===(e=this.canvasElement)||void 0===e?void 0:e.height,"), gl=").concat(s,", lost=").concat(null===(r=s)||void 0===r?void 0:r.isContextLost())),void u("InitWebGLFail");s.glInitSucceed=0},H.prototype.initProgram=function(){var t=this.contextGL,e=t.createShader(t.VERTEX_SHADER);t.shaderSource(e,"\n    attribute vec4 vertexPos;\n    attribute vec4 texturePos;\n    attribute vec4 masktexturePos;\n    varying vec2 textureCoord;\n    varying vec2 masktextureCoord;\n\n    void main() {\n        gl_Position = vertexPos;\n        textureCoord = texturePos.xy;\n        masktextureCoord = masktexturePos.xy;\n    }\n  "),t.compileShader(e),t.getShaderParameter(e,t.COMPILE_STATUS)||t.isContextLost()||C("webgl Vertex shader failed to compile: "+t.getShaderInfoLog(e));var r=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,"\n    precision highp float;\n    varying highp vec2 textureCoord;\n    varying highp vec2 masktextureCoord;\n    \n    uniform sampler2D ySampler;\n    uniform sampler2D uSampler;\n    uniform sampler2D vSampler;\n    uniform sampler2D cursorSampler;\n    uniform sampler2D waterMarkSampler;\n    uniform sampler2D previewVideoSampler;\n    uniform sampler2D maskSampler;\n    \n    uniform vec4 cursorInfo;\n    uniform int onlyRGBA;\n    uniform int bgraMode;\n    uniform int colorRange;\n    uniform int waterMarkFlag;\n    uniform int cursorFlag;\n    uniform int yuvmode;\n    \n    const int MAX_ELLIPSE_COUNT = 10;\n    uniform int maskFlag;                       // 0: mask disabled; 1: mask enabled;\n    uniform int maskMode;                       // 0: static mask; 1: dynamic mask;\n    uniform vec4 uEllipses[MAX_ELLIPSE_COUNT];  // each ellipse contains (cx, cy, rx, ry) 4-coords\n    uniform int uEllipseCount;                  // how many ellipses will draw\n\n    // rounded corner feature in gl shader\n    uniform float u_enable_rounded_corner;\n    uniform float u_radius_lt_x;\n    uniform float u_radius_lt_y;\n    uniform float u_radius_lb_x;\n    uniform float u_radius_lb_y;\n    uniform float u_radius_rt_x;\n    uniform float u_radius_rt_y;\n    uniform float u_radius_rb_x;\n    uniform float u_radius_rb_y;\n    uniform float u_aa_width;\n    uniform vec4 u_viewport_rect;\n\n    const mat4 YUV2RGB_L = mat4(\n      1.1643828125, 0, 1.59602734375, -0.87078515625,\n      1.1643828125, -0.39176171875, -0.81296875, 0.52959375,\n      1.1643828125, 2.017234375, 0, -1.081390625,\n      0, 0, 0, 1\n    );\n\n    const mat4 YUV2RGB_F = mat4(\n      1.0, 0, 1.402, -0.701,\n      1.0, -0.34413, -0.71414, 0.529135,\n      1.0, 1.772, 0, -0.886,\n      0, 0, 0, 1\n    );\n\n    void main(void) {\n      vec4 c;\n      if (waterMarkFlag != 1) {\n        if (onlyRGBA == 0) {\n          highp float y = texture2D(ySampler, textureCoord).r;\n          highp float u;\n          highp float v;\n\n          if (yuvmode == 1) {\n            u = texture2D(uSampler, textureCoord).r;\n            v = texture2D(vSampler, textureCoord).r;\n          } else {\n            u = texture2D(uSampler, textureCoord).r;\n            v = texture2D(uSampler, textureCoord).a;\n          }\n\n          if (colorRange == 0) {\n            c = vec4(y, u, v, 1) * YUV2RGB_L;\n          } else {\n            c = vec4(y, u, v, 1) * YUV2RGB_F;\n          }\n\n          if (cursorFlag == 1) {\n            if (cursorInfo.z > 0.0 && \n                textureCoord.x >= cursorInfo.x && \n                textureCoord.y >= cursorInfo.y && \n                textureCoord.x < cursorInfo.x + cursorInfo.z && \n                textureCoord.y < cursorInfo.y + cursorInfo.w) {\n              \n              vec2 cursorCoord = textureCoord - cursorInfo.xy;\n              cursorCoord /= cursorInfo.zw;\n              vec4 cursor = texture2D(cursorSampler, cursorCoord);\n              c = c * (1.0 - cursor.a) + cursor * cursor.a;\n            }\n          }\n        } else {\n          c = texture2D(previewVideoSampler, textureCoord);\n          if (bgraMode == 1) {\n            c = vec4(c.b, c.g, c.r, c.a);\n          }\n        }\n      } else {\n        c = texture2D(waterMarkSampler, textureCoord);\n        if (c.r == 0.0 && c.g == 0.0 && c.b == 0.0) {\n          c.a = 0.0;\n        }\n      }\n\n      if (maskFlag == 1 && waterMarkFlag != 1) {\n        vec4 mask = texture2D(maskSampler, masktextureCoord);\n        if (maskMode == 0) {\n          // -- handle static mask --\n          if (mask.r != 0.0 || mask.g != 0.0 || mask.b != 0.0) {\n            c = mask * mask.a + c * (1.0 - mask.a);\n          }\n        } else if (maskMode == 1) {\n          // -- handle dynamic mask -- \n          bool inEllipse = false; // variable for checking whether the pixel to be drawn hits ellipse\n          for (int i = 0; i < MAX_ELLIPSE_COUNT; i++) {\n            if (i > uEllipseCount) break;\n\n            vec2 ellipseCenter = uEllipses[i].xy;\n            vec2 ellipseRadii = uEllipses[i].zw;\n            vec2 ellipsePos = masktextureCoord - ellipseCenter;\n\n            float ellipseEq = (ellipsePos.x * ellipsePos.x) / (ellipseRadii.x * ellipseRadii.x) + \n                              (ellipsePos.y * ellipsePos.y) / (ellipseRadii.y * ellipseRadii.y);\n            if (ellipseEq <= 1.0) {\n              // the pixel in the ellipse range\n              inEllipse = true;\n              break;\n            }\n          }\n\n          if (inEllipse) {\n            c = mask * mask.a + c * (1.0 - mask.a);\n          }\n        }\n      }\n\n      if (waterMarkFlag != 1) {\n        c.a = 1.0;\n      }\n\n      if (u_enable_rounded_corner < 0.5) {\n        gl_FragColor = c;\n        return;\n      }\n\n      // step 1: viewport coordinate mapping\n      // convert the fragment coordinate(canvas coordinate) to the viewport coordinate\n      // for example, a viewport={x: 100, y: 100, w: 200, h: 160}, a fragCoord.xy={x:120, y: 120}\n      // we can get the pos={x: 20, y: 20}\n      vec2 pos = gl_FragCoord.xy - u_viewport_rect.xy;\n      vec2 viewportSize = u_viewport_rect.zw;\n\n      // convert the normalized radius to pixel value\n      float r_lt_x = u_radius_lt_x * viewportSize.x;\n      float r_lt_y = u_radius_lt_y * viewportSize.y;\n      float r_rt_x = u_radius_rt_x * viewportSize.x;\n      float r_rt_y = u_radius_rt_y * viewportSize.y;\n      float r_lb_x = u_radius_lb_x * viewportSize.x;\n      float r_lb_y = u_radius_lb_y * viewportSize.y;\n      float r_rb_x = u_radius_rb_x * viewportSize.x;\n      float r_rb_y = u_radius_rb_y * viewportSize.y;\n\n      // step 2: calculate the rounded corner mask (as alpha)\n      float alpha = 1.0;\n\n      // --- calculation of the left-top corner ---\n      // Condition: if (pos.x < r_lt_x && pos.y < r_lt_y)\n      float in_lt = (1.0 - step(r_lt_x, pos.x)) * (1.0 - step(r_lt_y, pos.y));\n      // the circle center of the left-top corner in pixel coordinate\n      vec2 center_lt = vec2(r_lt_x, r_lt_y);\n      // calculate and normalize the distance between the fragment and the center\n      vec2 diff_lt = (pos - center_lt) / vec2(r_lt_x, r_lt_y);\n      float normDist_lt = length(diff_lt);\n      // smoothstep function is used to calculate the alpha value\n      float mask_lt = 1.0 - smoothstep(1.0 - u_aa_width, 1.0, normDist_lt);\n      float final_lt = mix(1.0, mask_lt, in_lt);\n\n      // --- calculation of the right-top corner ---\n      float in_rt = (1.0 - step(r_rt_x, viewportSize.x - pos.x)) * (1.0 - step(r_rt_y, pos.y));\n      vec2 center_rt = vec2(viewportSize.x - r_rt_x, r_rt_y);\n      vec2 diff_rt = (pos - center_rt) / vec2(r_rt_x, r_rt_y);\n      float normDist_rt = length(diff_rt);\n      float mask_rt = 1.0 - smoothstep(1.0 - u_aa_width, 1.0, normDist_rt);\n      float final_rt = mix(1.0, mask_rt, in_rt);\n\n      // --- calculation of the left-bottom corner ---\n      float in_lb = (1.0 - step(r_lb_x, pos.x)) * (1.0 - step(r_lb_y, viewportSize.y - pos.y));\n      vec2 center_lb = vec2(r_lb_x, viewportSize.y - r_lb_y);\n      vec2 diff_lb = (pos - center_lb) / vec2(r_lb_x, r_lb_y);\n      float normDist_lb = length(diff_lb);\n      float mask_lb = 1.0 - smoothstep(1.0 - u_aa_width, 1.0, normDist_lb);\n      float final_lb = mix(1.0, mask_lb, in_lb);\n\n      // --- calculation of the right-bottom corner ---\n      float in_rb = (1.0 - step(r_rb_x, viewportSize.x - pos.x)) * (1.0 - step(r_rb_y, viewportSize.y - pos.y));\n      vec2 center_rb = vec2(viewportSize.x - r_rb_x, viewportSize.y - r_rb_y);\n      vec2 diff_rb = (pos - center_rb) / vec2(r_rb_x, r_rb_y);\n      float normDist_rb = length(diff_rb);\n      float mask_rb = 1.0 - smoothstep(1.0 - u_aa_width, 1.0, normDist_rb);\n      float final_rb = mix(1.0, mask_rb, in_rb);\n\n      // Get the minimum value from the four corners (to ensure that if any corner requires transparency it is applied)\n      float finalAlpha = min(min(final_lt, final_rt), min(final_lb, final_rb));\n\n      // Final output color\n      gl_FragColor = vec4(c.rgb, c.a * finalAlpha);\n    }\n"),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)||t.isContextLost()||C("webgl Fragment shader failed to compile: "+t.getShaderInfoLog(r));var i=t.createProgram();t.attachShader(i,e),t.attachShader(i,r),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||t.isContextLost()||C("webgl Program failed to compile: "+t.getProgramInfoLog(i)),t.useProgram(i),this.shaderProgram=i},H.prototype.initBuffers=function(){var t=this.contextGL,e=this.shaderProgram,r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1,1,1,-1,1,1,-1,-1,-1]),t.STATIC_DRAW);var i=t.getAttribLocation(e,"vertexPos");t.enableVertexAttribArray(i),t.vertexAttribPointer(i,2,t.FLOAT,!1,0,0),this.vertexPosBuffer=r;var s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1,1,0,0,0,1,1,0,1]),t.STATIC_DRAW);var n=t.getAttribLocation(e,"texturePos");if(t.enableVertexAttribArray(n),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),this.initmask&&!this.masktexturePosBuffer){var a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),t.STATIC_DRAW);var o=t.getAttribLocation(e,"masktexturePos");t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),this.masktexturePosBuffer=a}this.texturePosBuffer=s},H.prototype.initTextures=function(t){var e=this.contextGL,r=this.shaderProgram;e.pixelStorei(e.UNPACK_ALIGNMENT,1);var i=this.initTexture();this.yTextureRef=i,this.oyTextureRef=i;var s=this.initTexture();this.uTextureRef=s,this.ouTextureRef=s;var n=this.initTexture();if(this.vTextureRef=n,this.ovTextureRef=n,t){this.BindTextures(1);var a=this.initTexture(),o=e.getUniformLocation(r,"cursorSampler");e.uniform1i(o,this.textureindex*this.texturestride+3),this.cursorTextureRef=a;var c=this.initTexture(),h=e.getUniformLocation(r,"waterMarkSampler");e.uniform1i(h,4),this.waterMarkTextureRef=c;var u=this.initTexture();this.repeatedWaterMarkTextureRef=u;var l=this.initTexture(),d=e.getUniformLocation(r,"previewVideoSampler");e.uniform1i(d,this.textureindex*this.texturestride+5),this.previewVideoTextureRef=l;var f=e.getUniformLocation(r,"cursorInfo");this.cursorInfoRef=f}if(this.initmask){e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1);var p=this.initTexture(),m=e.getUniformLocation(r,"maskSampler");e.uniform1i(m,this.textureindex*this.texturestride+6),this.maskTextureRef=p}var _=e.getUniformLocation(r,"colorRange");this.colorRangeRef=_,this.onlyRGBARef=e.getUniformLocation(r,"onlyRGBA"),this.bgraModeRef=e.getUniformLocation(r,"bgraMode"),this.waterMarkFlagRef=e.getUniformLocation(r,"waterMarkFlag"),this.maskFlagRef=e.getUniformLocation(r,"maskFlag"),this.cursorFlagRef=e.getUniformLocation(r,"cursorFlag"),this.yuvmodeRef=e.getUniformLocation(r,"yuvmode"),this.ul_enable_rounded_corner=e.getUniformLocation(r,"u_enable_rounded_corner"),this.ul_radius_lt_x=e.getUniformLocation(r,"u_radius_lt_x"),this.ul_radius_lt_y=e.getUniformLocation(r,"u_radius_lt_y"),this.ul_radius_lb_x=e.getUniformLocation(r,"u_radius_lb_x"),this.ul_radius_lb_y=e.getUniformLocation(r,"u_radius_lb_y"),this.ul_radius_rt_x=e.getUniformLocation(r,"u_radius_rt_x"),this.ul_radius_rt_y=e.getUniformLocation(r,"u_radius_rt_y"),this.ul_radius_rb_x=e.getUniformLocation(r,"u_radius_rb_x"),this.ul_radius_rb_y=e.getUniformLocation(r,"u_radius_rb_y"),this.ul_aa_width=e.getUniformLocation(r,"u_aa_width"),this.ul_viewport_rect=e.getUniformLocation(r,"u_viewport_rect")},H.prototype.BindTextures=function(t){var e=this.contextGL,r=this.shaderProgram;if(e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,this.yTextureRef),e.activeTexture(e.TEXTURE0+1),e.bindTexture(e.TEXTURE_2D,this.uTextureRef),e.activeTexture(e.TEXTURE0+2),e.bindTexture(e.TEXTURE_2D,this.vTextureRef),1==t){let t=e.getUniformLocation(r,"ySampler");e.uniform1i(t,0);let i=e.getUniformLocation(r,"uSampler");e.uniform1i(i,1);let s=e.getUniformLocation(r,"vSampler");e.uniform1i(s,2)}else if(this.isRGBAMode(t)){let t=e.getUniformLocation(r,"previewVideoSampler");e.uniform1i(t,0);let i=e.getUniformLocation(r,"ySampler");e.uniform1i(i,0);let s=e.getUniformLocation(r,"uSampler");e.uniform1i(s,0);let n=e.getUniformLocation(r,"vSampler");e.uniform1i(n,0)}else if(2==t){let t=e.getUniformLocation(r,"ySampler");e.uniform1i(t,0);let i=e.getUniformLocation(r,"uSampler");e.uniform1i(i,1);let s=e.getUniformLocation(r,"vSampler");e.uniform1i(s,0)}let i=e.getUniformLocation(r,"previewVideoSampler");e.uniform1i(i,0);let s=e.getUniformLocation(r,"maskSampler");this.initmask?(e.activeTexture(e.TEXTURE0+6),e.bindTexture(e.TEXTURE_2D,this.maskTextureRef),e.uniform1i(s,6)):e.uniform1i(s,0);let n=e.getUniformLocation(r,"cursorSampler");e.uniform1i(n,0);let a=e.getUniformLocation(this.shaderProgram,"waterMarkSampler");e.uniform1i(a,0)},H.prototype.initTexture=function(){var t=this.contextGL,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null),e},H.prototype.clearDisplay=function(){var t=this.contextGL;t&&(t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT))},H.prototype.cleanup=function(){let t=this.canvasElement,e=V.get(t);if(e&&this.removeEventListener(t,e),t.defaultContextLostHandler||(t.defaultContextLostHandler=j,t.addEventListener("webglcontextlost",j,{capture:!1})),this.cleanupRoundedCornerRadius(),this.isAvaiable()){var r=this.contextGL;r.deleteProgram(this.program),r.activeTexture(r.TEXTURE0+this.textureindex*this.texturestride),r.bindTexture(r.TEXTURE_2D,null),r.activeTexture(r.TEXTURE1+this.textureindex*this.texturestride),r.bindTexture(r.TEXTURE_2D,null),r.activeTexture(r.TEXTURE2+this.textureindex*this.texturestride),r.bindTexture(r.TEXTURE_2D,null),this.textureindex||this.initmask||(r.activeTexture(r.TEXTURE3+this.textureindex*this.texturestride),r.bindTexture(r.TEXTURE_2D,null),r.activeTexture(r.TEXTURE4+this.textureindex*this.texturestride),r.bindTexture(r.TEXTURE_2D,null),r.activeTexture(this.getRepeatedWatermarkTextureValue(r)),r.bindTexture(r.TEXTURE_2D,null),r.activeTexture(r.TEXTURE5+this.textureindex*this.texturestride),r.bindTexture(r.TEXTURE_2D,null)),r.bindBuffer(r.ARRAY_BUFFER,null),r.deleteTexture(this.yTextureRef),r.deleteTexture(this.uTextureRef),r.deleteTexture(this.vTextureRef),this.textureindex||this.initmask||(r.deleteTexture(this.cursorTextureRef),r.deleteTexture(this.waterMarkTextureRef),r.deleteTexture(this.repeatedWaterMarkTextureRef),r.deleteTexture(this.previewVideoTextureRef),r.deleteBuffer(this.vertexPosBuffer),r.deleteBuffer(this.texturePosBuffer)),this.maskTextureRef&&r.deleteTexture(this.maskTextureRef),this.masktexturePosBuffer&&r.deleteBuffer(this.masktexturePosBuffer),r.glInitSucceed=0}},H.prototype.drawNextOutputPicture=function(t,e,r,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.contextGL?this.drawNextOutputPictureFrame(t,e,r,i,s):this.drawNextOuptutPictureRGBA(t,e,r,i)},H.prototype.updateVertexInfoForMultiView=function(t,e,r,i,s){var n,a,o,c,h=this.contextGL;if(this.isUseFillMode({width:r,height:i,rotation:s}))n=0,a=0,o=1,c=1;else{var u=s==this.ROTATION_CLOCK90||s==this.ROTATION_CLOCK270?i:r,l=s==this.ROTATION_CLOCK90||s==this.ROTATION_CLOCK270?r:i,d=u/l*e;d>t?(n=0,o=1,c=1-(a=(e-l/u*t)/2/e)):(a=0,c=1,o=1-(n=(t-d)/2/t))}n=2*n-1,o=2*o-1,a=1-2*a,c=1-2*c;var f=new Float32Array([o,a,n,a,o,c,n,c,1,1,-1,1,1,-1,-1,-1]);this.viewPostion=f,h.bindBuffer(h.ARRAY_BUFFER,this.vertexPosBuffer),h.bufferData(h.ARRAY_BUFFER,f,h.DYNAMIC_DRAW)},H.prototype.getViewPosition=function(){let t=[0,0,1,1];if(!this.viewPostion)return t;const e=this.viewPostion[0],r=this.viewPostion[1],i=this.viewPostion[2],s=this.viewPostion[5];return t[0]=(1-r)/2,t[1]=(1+i)/2,t[2]=(1-s)/2,t[3]=(1+e)/2,t},H.prototype.updateTextureInfo=function(t,e,r,i,s){var n=t.contextGL,a=i.top/r,o=i.left/e,c=a+(i.height-1)/r,h=o+i.width/e,u=[o,a,h,a,h,c,o,c];s==t.ROTATION_CLOCK90&&(u.unshift(u[6],u[7]),u=u.slice(0,8)),s==t.ROTATION_CLOCK180&&(u.unshift(u[4],u[5],u[6],u[7]),u=u.slice(0,8)),s==t.ROTATION_CLOCK270&&(u.push(u[0],u[1]),u=u.slice(2));var l=u[0],d=u[1];u[0]=u[2],u[1]=u[3],u[2]=l,u[3]=d;var f=new Float32Array([...u,1,0,0,0,1,1,0,1]);n.bindBuffer(n.ARRAY_BUFFER,t.texturePosBuffer),n.bufferData(n.ARRAY_BUFFER,f,n.DYNAMIC_DRAW)},H.prototype.updateTextureInfoForMultiView=function(t,e,r,i,s,n,a){var o,c,h,u,l=this.contextGL;if(this.isUseFillMode({width:r.width,height:r.height,rotation:i})){const s=i==this.ROTATION_CLOCK90||i==this.ROTATION_CLOCK270?a/n:n/a,l=r.left||0,d=r.top||0;if(r.width/r.height>s){const i=r.height*s;o=d/e,c=(Math.round((r.width-i)/2)+l)/t,h=o+(r.height-1)/e,u=c+i/t}else{const i=r.width/s;h=(o=(Math.round((r.height-i)/2)+d)/e)+(i-1)/e,u=(c=l/t)+r.width/t}}else o=_(r.top/e,2),c=_(r.left/t,2),h=m((r.top+r.height-1)/e,2),u=m((r.width-1+r.left)/t,2);var d=[c,o,u,o,u,h,c,h];i==this.ROTATION_CLOCK90&&(d.unshift(d[6],d[7]),d=d.slice(0,8)),i==this.ROTATION_CLOCK180&&(d.unshift(d[4],d[5],d[6],d[7]),d=d.slice(0,8)),i==this.ROTATION_CLOCK270&&(d.push(d[0],d[1]),d=d.slice(2,10));var f=d[0],p=d[1];if(d[0]=d[2],d[1]=d[3],d[2]=f,d[3]=p,s)if(i==this.ROTATION_CLOCK90||i==this.ROTATION_CLOCK270){let t=d[1];d[1]=d[3],d[3]=t,t=d[5],d[5]=d[7],d[7]=t}else d[0]=1-d[0],d[2]=1-d[2],d[4]=1-d[4],d[6]=1-d[6];var v=new Float32Array([...d,1,0,0,0,1,1,0,1]);l.bindBuffer(l.ARRAY_BUFFER,this.texturePosBuffer),l.bufferData(l.ARRAY_BUFFER,v,l.DYNAMIC_DRAW)},H.prototype.drawNextOutputPictureFrame=function(t,e,r,i,s){let n=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];if(!this.isAvaiable())return;var c=this.contextGL,h=(this.texturePosBuffer,this.yTextureRef),u=this.uTextureRef,l=this.vTextureRef;c.enable(c.BLEND),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),s=s||this.ROTATION_CLOCK0;var d=(r=r||{top:0,left:0,width:t,height:e}).width!=this.croppingParams.width||r.height!=this.croppingParams.height,f=r.top!=this.croppingParams.top||r.left!=this.croppingParams.left,p=c.canvas.width!=this.canvasWidth||c.canvas.height!=this.canvasHeight,m=t!=this.textureWidth||e!=this.textureHeight,_=s!=this.picRotation;(d||p||_)&&function(t,e,r,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;var n=t.contextGL;let a=n.canvas.width,o=n.canvas.height;s&&(a=s.width,o=s.height);var c,h,u,l,d=i==t.ROTATION_CLOCK90||i==t.ROTATION_CLOCK270?r:e,f=i==t.ROTATION_CLOCK90||i==t.ROTATION_CLOCK270?e:r,p=d/f*o;p>a?(c=0,u=1,l=1-(h=(o-f/d*a)/2/o)):(h=0,l=1,u=1-(c=(a-p)/2/a)),c=2*c-1,u=2*u-1,h=1-2*h,l=1-2*l;var m=new Float32Array([u,h,c,h,u,l,c,l,u,h,c,h,u,l,c,l]);n.bindBuffer(n.ARRAY_BUFFER,t.vertexPosBuffer),n.bufferData(n.ARRAY_BUFFER,m,n.DYNAMIC_DRAW)}(this,r.width,r.height,s,a),(d||f||m||_)&&this.updateTextureInfo(this,t,e,r,s);let v=n?0:1;v!=this.colorRange&&(c.uniform1i(this.colorRangeRef,v),this.colorRange=v),a?(c.viewport(a.x,a.y,a.width,a.height),this.viewport_rect||(this.viewport_rect=new Float32Array(4)),this.viewport_rect.set([a.x,a.y,a.width,a.height],0),c.uniform4fv(this.ul_viewport_rect,this.viewport_rect)):(c.viewport(0,0,c.canvas.width,c.canvas.height),this.viewport_rect||(this.viewport_rect=new Float32Array(4)),this.viewport_rect.set([0,0,c.canvas.width,c.canvas.height],0),c.uniform4fv(this.ul_viewport_rect,this.viewport_rect)),c.uniform1i(this.onlyRGBARef,0),c.uniform1i(this.yuvmodeRef,1),Object.assign(this.croppingParams,r),this.textureWidth=t,this.textureHeight=e,this.picRotation=s,this.canvasWidth=c.canvas.width,this.canvasHeight=c.canvas.height;var g=i,y=t*e;if(c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,h),o){var x=g.subarray(0,y);c.texImage2D(c.TEXTURE_2D,0,c.LUMINANCE,t,e,0,c.LUMINANCE,c.UNSIGNED_BYTE,x)}var b=t/2*e/2;if(c.activeTexture(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,u),o){var T=g.subarray(y,y+b);c.texImage2D(c.TEXTURE_2D,0,c.LUMINANCE,t/2,e/2,0,c.LUMINANCE,c.UNSIGNED_BYTE,T)}var R=b;if(c.activeTexture(c.TEXTURE2),c.bindTexture(c.TEXTURE_2D,l),o){var E=g.subarray(y+b,y+b+R);c.texImage2D(c.TEXTURE_2D,0,c.LUMINANCE,t/2,e/2,0,c.LUMINANCE,c.UNSIGNED_BYTE,E)}c.activeTexture(c.TEXTURE3),c.bindTexture(c.TEXTURE_2D,this.cursorTextureRef),this.hasCursor?c.uniform1i(this.cursorFlagRef,1):o&&c.texImage2D(c.TEXTURE_2D,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,this.dummpyCursor),c.uniform4f(this.cursorInfoRef,this.cx,this.cy,this.cw,this.ch),c.activeTexture(c.TEXTURE5),c.bindTexture(c.TEXTURE_2D,this.previewVideoTextureRef),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,this.dummpyWaterMark);var w=c.getUniformLocation(this.shaderProgram,"maskSampler");c.uniform1i(w,5),this.render(),this.hasWholeFrame=1},H.prototype.updateTextureBlock=function(t,e,r,i,s){if(this.isAvaiable()){var n=this.contextGL,a=s;if(!(!this.hasWholeFrame||t<=0||e<=0||r<0||i<0||r+t>this.textureWidth||i+e>this.textureHeight)&&s&&s.length==t*e*3/2){var o=this.yTextureRef,c=this.uTextureRef,h=this.vTextureRef,u=t*e,l=a.subarray(0,u);n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,o),n.texSubImage2D(n.TEXTURE_2D,0,r,i,t,e,n.LUMINANCE,n.UNSIGNED_BYTE,l);var d=t/2*e/2,f=a.subarray(u,u+d);n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,c),n.texSubImage2D(n.TEXTURE_2D,0,r/2,i/2,t/2,e/2,n.LUMINANCE,n.UNSIGNED_BYTE,f);var p=d,m=a.subarray(u+d,u+d+p);n.activeTexture(n.TEXTURE2),n.bindTexture(n.TEXTURE_2D,h),n.texSubImage2D(n.TEXTURE_2D,0,r/2,i/2,t/2,e/2,n.LUMINANCE,n.UNSIGNED_BYTE,m)}}},H.prototype.updateCursor=function(t,e,r){if(this.isAvaiable()){var i=this.contextGL;t<=0||e<=0||!r||r.length!=t*e*4||(i.activeTexture(i.TEXTURE3),i.bindTexture(i.TEXTURE_2D,this.cursorTextureRef),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,r),this.cursorWidth=t,this.cursorHeight=e,this.hasCursor=1)}},H.prototype.updateWatermark=function(t,e,r){this.isAvaiable()&&(this.contextGL,t<=0||e<=0||!r||r.length!=t*e*4||(this.watermarkData=r,this.watermarkWidth=t,this.watermarkHeight=e,this.hasWaterMark=1))},H.prototype.drawWatermark=function(){if(this.isAvaiable()){var t=this.contextGL;if(this.isSetWatermark()&&this.watermarkData&&this.watermarkWidth&&this.watermarkHeight){t.uniform1i(this.waterMarkFlagRef,1),this.isWatermarkRepeated()?(t.activeTexture(this.getRepeatedWatermarkTextureValue(t)),t.bindTexture(t.TEXTURE_2D,this.repeatedWaterMarkTextureRef)):(t.activeTexture(t.TEXTURE4),t.bindTexture(t.TEXTURE_2D,this.waterMarkTextureRef)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.watermarkWidth,this.watermarkHeight,0,t.RGBA,t.UNSIGNED_BYTE,this.watermarkData);let e=t.getUniformLocation(this.shaderProgram,"waterMarkSampler");t.uniform1i(e,this.isWatermarkRepeated()?this.getRepeatedWatermarkUniformValue():4),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.drawArrays(t.TRIANGLE_STRIP,4,4)}}},H.prototype.drawRoundedCorner=function(){if(this.isAvaiable()){var t=this.contextGL;t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.uniform1f(this.ul_enable_rounded_corner,this.enable_rounded_corner),t.uniform1f(this.ul_radius_lt_x,this.radius_lt_x),t.uniform1f(this.ul_radius_lt_y,this.radius_lt_y),t.uniform1f(this.ul_radius_lb_x,this.radius_lb_x),t.uniform1f(this.ul_radius_lb_y,this.radius_lb_y),t.uniform1f(this.ul_radius_rt_x,this.radius_rt_x),t.uniform1f(this.ul_radius_rt_y,this.radius_rt_y),t.uniform1f(this.ul_radius_rb_x,this.radius_rb_x),t.uniform1f(this.ul_radius_rb_y,this.radius_rb_y),t.uniform1f(this.ul_aa_width,this.aa_width)}},H.prototype.cleanupRoundedCornerRadius=function(){this.enable_rounded_corner=0,this.radius_lt_x=0,this.radius_lt_y=0,this.radius_lb_x=0,this.radius_lb_y=0,this.radius_rt_x=0,this.radius_rt_y=0,this.radius_rb_x=0,this.radius_rb_y=0,this.aa_width=p,this.viewport_rect=null},H.prototype.render=function(){if(this.isAvaiable()){var t=this.contextGL;this.drawRoundedCorner(),t.uniform1i(this.waterMarkFlagRef,0),t.drawArrays(t.TRIANGLE_STRIP,0,4),this.drawWatermark()}},H.prototype.drawCursor=function(t,e,r,i,s){if(this.isAvaiable()){var n=this.contextGL;if(!(!this.hasWholeFrame||t&&(i<0||s<0))){n.viewport(0,0,n.canvas.width,n.canvas.height);var a=this.yTextureRef,o=this.uTextureRef,c=this.vTextureRef,h=this.cursorTextureRef;if(n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,a),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,o),n.activeTexture(n.TEXTURE2),n.bindTexture(n.TEXTURE_2D,c),n.activeTexture(n.TEXTURE3),n.bindTexture(n.TEXTURE_2D,h),t&&this.hasCursor){let t=e/this.croppingParams.width,a=r/this.croppingParams.height,o=i/this.croppingParams.width,c=s/this.croppingParams.height;this.cx=t,this.cy=a,this.cw=o,this.ch=c,n.uniform4f(this.cursorInfoRef,t,a,o,c)}else n.uniform4f(this.cursorInfoRef,0,0,0,0);this.render()}}},H.prototype.clear=function(){this.hasWholeFrame=0,this.hasCursor=0,this.cleanupRoundedCornerRadius()},H.prototype.clearCanvas=function(t){if(this.cleanupRoundedCornerRadius(),this.isAvaiable()){var e=this.contextGL;t?e.clearColor(t.R,t.G,t.B,t.A):e.clearColor(this.bgColor[0],this.bgColor[1],this.bgColor[2],255),e.clear(e.COLOR_BUFFER_BIT)}},H.prototype.drawNextOuptutPictureRGBA=function(t,e,r,i){if(this.isAvaiable()){var s=i,n=this.canvasElement.getContext("2d"),a=n.getImageData(0,0,t,e);a.data.set(s),n.putImageData(a,0,0)}},H.prototype.isRGBAMode=function(t){return-1!==[P,N].indexOf(t)},H.prototype.updateRemoteVideoTextures=function(t,e,r,i,s){let n=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];if(!this.isAvaiable())return;var o=this.contextGL,c=this.yTextureRef,h=this.uTextureRef,u=this.vTextureRef;o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA);const l=this.isRGBAMode(this.videoMode);if(t<=0||e<=0||!i||!i.length||i.length!=t*e*3/2&&!l||r&&(r.top<0||r.left<0||r.left+r.width>t||r.top+r.height>e))return!1;let d=n?0:1;if(this.colorRange=d,this.rotation=s,Object.assign(this.croppingParams,r),this.textureWidth=t,this.textureHeight=e,this.canvasWidth=o.canvas.width,this.canvasHeight=o.canvas.height,!a)return;if(o.bindTexture(o.TEXTURE_2D,c),l)return void o.texImage2D(o.TEXTURE_2D,0,o.RGBA,t,e,0,o.RGBA,o.UNSIGNED_BYTE,i);var f=i,p=t*e,m=f.subarray(0,p);o.texImage2D(o.TEXTURE_2D,0,o.LUMINANCE,t,e,0,o.LUMINANCE,o.UNSIGNED_BYTE,m);let _=0,v=0;1==this.videoMode?(_=t/2*e/2,v=_):2==this.videoMode&&(_=t*e/2,v=0);var g=f.subarray(p,p+_);if(o.bindTexture(o.TEXTURE_2D,h),v){o.texImage2D(o.TEXTURE_2D,0,o.LUMINANCE,t/2,e/2,0,o.LUMINANCE,o.UNSIGNED_BYTE,g);var y=f.subarray(p+_,p+_+v);o.bindTexture(o.TEXTURE_2D,u),o.texImage2D(o.TEXTURE_2D,0,o.LUMINANCE,t/2,e/2,0,o.LUMINANCE,o.UNSIGNED_BYTE,y)}else o.texImage2D(o.TEXTURE_2D,0,o.LUMINANCE_ALPHA,t/2,e/2,0,o.LUMINANCE_ALPHA,o.UNSIGNED_BYTE,g);return!0},H.prototype.updateRemoteVideoTexturesImageBitmap=function(t,e,r,i,s){let n=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(t<=0||e<=0||!r)return;if(!this.isAvaiable())return;var a=this.contextGL;if(this.textureWidth=t,this.textureHeight=e,Number.isNaN(s)||(this.rotation=s),Object.assign(this.croppingParams,i),!n)return;a.bindTexture(a.TEXTURE_2D,this.yTextureRef);const o=a.RGBA,c=a.RGBA,h=a.UNSIGNED_BYTE;a.texImage2D(a.TEXTURE_2D,0,o,c,h,r)},H.prototype.updateSelfMaskImage=function(t,e,r){if(!(t<=0||e<=0)&&r&&r.length==t*e*4&&this.isAvaiable()){var i=this.contextGL;i.bindTexture(i.TEXTURE_2D,this.maskTextureRef),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,r)}},H.prototype.VideoFlip=function(){if(this.isAvaiable()){var t=this.contextGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,1)}},H.prototype.drawRemoteVideo=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.isAvaiable())return;var r=this.contextGL;let i=this.isRGBAMode(this.videoMode)?1:0;r.uniform1i(this.colorRangeRef,this.colorRange),this.setUniformFlag(i,this.hasCursor,this.videoMode),this.initmask&&r.uniform1i(this.maskFlagRef,1),this.updateTextureInfoForMultiView(this.textureWidth,this.textureHeight,this.croppingParams,this.rotation,e,t.width,t.height),r.viewport(t.x,t.y,t.width,t.height),this.viewport_rect||(this.viewport_rect=new Float32Array(4)),this.viewport_rect.set([t.x,t.y,t.width,t.height],0),r.uniform4fv(this.ul_viewport_rect,this.viewport_rect),this.updateVertexInfoForMultiView(t.width,t.height,this.croppingParams.width,this.croppingParams.height,this.rotation),this.BindTextures(this.videoMode),r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),this.render()},H.prototype.readPixelsSyncRequest=function(t,e,r,i){if(this.isAvaiable()){var s,n=this.contextGL;return this.destination&&this.destination.length==r*i*4||(this.destination=new Uint8Array(r*i*4)),s=this.destination,n.flush(),n.readPixels(t,e,r,i,n.RGBA,n.UNSIGNED_BYTE,s),s}},H.prototype.updateSelfVideoTextures=function(t,e,r,i){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(!(t<=0||e<=0)&&r&&r.length%4==0&&this.isAvaiable()){var a=this.contextGL;this.textureWidth=t,this.textureHeight=e,this.rotation=n,Object.assign(this.croppingParams,i),s&&(a.bindTexture(a.TEXTURE_2D,this.yTextureRef),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,t,e,0,a.RGBA,a.UNSIGNED_BYTE,r))}},H.prototype.drawSelfVideo=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isAvaiable()){var i=this.contextGL;this.setUniformFlag(1,this.hasCursor,this.videoMode),this.updateTextureInfoForMultiView(this.textureWidth,this.textureHeight,this.croppingParams,this.rotation,r,t.width,t.height),i.viewport(t.x,t.y,t.width,t.height),this.viewport_rect||(this.viewport_rect=new Float32Array(4)),this.viewport_rect.set([t.x,t.y,t.width,t.height],0),i.uniform4fv(this.ul_viewport_rect,this.viewport_rect),e?(i.enable(i.BLEND),i.blendFunc(i.ZERO,i.ZERO),this.updateVertexInfoForMultiView(t.width,t.height,t.width,t.height,this.ROTATION_CLOCK0)):(i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),this.updateVertexInfoForMultiView(t.width,t.height,this.croppingParams.width,this.croppingParams.height,this.rotation)),this.BindTextures(P),this.render()}},H.prototype.isSetWatermark=function(){return this.hasWaterMark},H.prototype.recoverTextures=function(){},H.prototype.setWatermarkFlag=function(t){this.hasWaterMark=t,t||(this.setWatermarkRepeated(!1),this.setWatermarkOpacity(),this.setWatermarkPosition(16))},H.prototype.setUniformFlag=function(t,e,r){if(this.isAvaiable()){var i=this.contextGL;i.uniform1i(this.onlyRGBARef,t),i.uniform1i(this.bgraModeRef,t&&r===N?1:0),i.uniform1i(this.cursorFlagRef,e),t||i.uniform1i(this.yuvmodeRef,r)}},H.prototype.setVideoMode=function(t){this.videoMode=t},H.prototype.getVideoMode=function(t){return this.videoMode},H.prototype.setWatermarkRepeated=function(t){this.watermarkRepeated=t},H.prototype.isWatermarkRepeated=function(){return!!this.watermarkRepeated},H.prototype.setWatermarkOpacity=function(t){this.watermarkOpacity=t||.15},H.prototype.getWatermarkOpacity=function(){return this.watermarkOpacity},H.prototype.setWatermarkPosition=function(t){this.watermarkPosition=t||16},H.prototype.getWatermarkPosition=function(){return this.watermarkPosition},H.prototype.setMultiView=function(t){return this.isMultiView=t},H.prototype.getRepeatedWatermarkUniformValue=function(){return this.isMultiView?30:7},H.prototype.getRepeatedWatermarkTextureValue=function(t){return this.isMultiView?t.TEXTURE30:t.TEXTURE7},H.prototype.setFillMode=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.fillMode=t,this.fillModeForResolution=e},H.prototype.getFillMode=function(){return this.fillMode},H.prototype.getFillModeForResolution=function(){return this.fillModeForResolution},H.prototype.getTextureIndex=function(){return this.textureindex},H.prototype.getTextureWidth=function(){return this.textureWidth},H.prototype.getTextureHeight=function(){return this.textureHeight},H.prototype.getRotation=function(){return this.rotation},H.prototype.getCroppingParams=function(){return this.croppingParams},H.prototype.getIndex=function(){return this.textureindex},H.prototype.getWatermarkWidth=function(){return this.watermarkWidth},H.prototype.getWatermarkHeight=function(){return this.watermarkHeight},H.prototype.getWatermarkOpacity=function(){return this.watermarkOpacity},H.prototype.getAttachedCanvas=function(){return this.canvasElement},H.prototype.getCanvasId=function(){return this.canvasID},H.prototype.resizeCanvasTo=function(t,e){this.contextGL.canvas.width=t,this.contextGL.canvas.height=e},H.prototype.isUseFillMode=function(t){let{width:e,height:r,rotation:i}=t;if(!this.fillMode)return!1;if(!this.fillModeForResolution)return!0;if(!e||!r)return!1;const s=i===this.ROTATION_CLOCK90||i==this.ROTATION_CLOCK270?r/e:e/r;return(Array.isArray(this.fillModeForResolution)?this.fillModeForResolution:[this.fillModeForResolution]).some((t=>Math.abs(s-t)<.01))},H.prototype.setRoundedCornerRadius=function(t){t?(this.radius_lt_x=t.radius_lt_x,this.radius_lt_y=t.radius_lt_y,this.radius_lb_x=t.radius_lb_x,this.radius_lb_y=t.radius_lb_y,this.radius_rt_x=t.radius_rt_x,this.radius_rt_y=t.radius_rt_y,this.radius_rb_x=t.radius_rb_x,this.radius_rb_y=t.radius_rb_y,0===this.radius_lt_x&&0===this.radius_lt_y&&0===this.radius_lb_x&&0===this.radius_lb_y&&0===this.radius_rt_x&&0===this.radius_rt_y&&0===this.radius_rb_x&&0===this.radius_rb_y?this.enable_rounded_corner=0:this.enable_rounded_corner=1):this.enable_rounded_corner=0},H.prototype.setAntialiasWidth=function(t){(t<=0||t>=1)&&(t=p),this.aa_width=t};const z=H;class X{constructor(t,e){this.isMirror=!1,this.display=new z(t,e,0,void 0,{preserveDrawingBuffer:!1},void 0,!1,!1)}renderFrame(t,e,r,i){if(this.display){let s={x:0,y:0,width:this.display.canvasElement.width,height:this.display.canvasElement.height};this.display.updateRemoteVideoTextures(t,e,i,r,0,!0,s,!1),this.display.drawRemoteVideo(s,this.isMirror)}}render(t){return e=this,r=void 0,s=function*(){let e=P;if("data_ptr"in t){const{data:e,format_width:r,format_height:i,valid_x:s,valid_y:n,valid_width:a,valid_height:o}=t;let c={top:n,left:s,width:a,height:o};this.display.setVideoMode(1),this.renderFrame(r,i,e,c)}else if(self.VideoFrame&&t instanceof VideoFrame){const{format:r,visibleRect:i}=t;if(r&&i){if("I420"===r||"I420A"===r)e=1;else if("NV12"===r)e=2;else{if("BGRA"!==r)return void(this.onUnsupportedFrame&&this.onUnsupportedFrame(r));e=N}const{width:s,height:n}=i,a=new Uint8Array(t.allocationSize()),o={top:0,left:0,width:s,height:n};this.display.setVideoMode(e);try{yield t.copyTo(a),this.renderFrame(s,n,a,o)}catch(t){}t.close()}}else if(t instanceof ImageData){const{width:e,height:r}=t,i={top:0,left:0,width:e,height:r};this.display.setVideoMode(P),this.renderFrame(e,r,t.data,i)}},new((i=void 0)||(i=Promise))((function(t,n){function a(t){try{c(s.next(t))}catch(t){n(t)}}function o(t){try{c(s.throw(t))}catch(t){n(t)}}function c(e){var r;e.done?t(e.value):(r=e.value,r instanceof i?r:new i((function(t){t(r)}))).then(a,o)}c((s=s.apply(e,r||[])).next())}));var e,r,i,s}updateSize(t,e){this.display.canvasElement.width=t,this.display.canvasElement.height=e}setMirror(t){this.isMirror=t}}function Y(t){self.postMessage({cmd:O.VB_WORKER_ERROR,payload:t.error||t.reason||t})}self.wcl_trace_log=function(){},self.addEventListener("error",Y),self.addEventListener("unhandledrejection",Y);const K=new class{constructor(){this.vbRender=null,this.frameRate=24,this.frameReader=null,this.videoStream=null,this.requestTimer=null,this.isVBEnabled=!0,this.isStreamEnabled=!1,this.vbWritableStream=null,this.vbFrameWriter=null,this.streamRender=null,this.manualFreeMemory=!1,this.isWaitingFirstFrame=!1,this.fps=0,this.statsTimer=null,this.receivingFps=0,this.receivedFrames=0,this.generatedFrames=0,this.width=0,this.height=0,this.frameReadTimer=null,this.handleMessage=this.handleMessage.bind(this),this.requestFrame=this.requestFrame.bind(this),this.updateStats=this.updateStats.bind(this),this.handleUnsupportedFrame=this.handleUnsupportedFrame.bind(this)}updateStats(){this.receivedFrames+=this.receivingFps,this.generatedFrames+=this.fps,this.postMessage({cmd:O.VB_UPDATE_STATS,payload:{fps:this.fps,receivingFps:this.receivingFps,generatedFrames:this.generatedFrames,receivedFrames:this.receivedFrames,width:this.width,height:this.height}}),this.fps=0,this.receivingFps=0}postMessage(t){self.postMessage(t)}start(){this.statsTimer&&(clearInterval(this.statsTimer),this.fps=0,this.receivingFps=0,this.receivedFrames=0,this.generatedFrames=0),this.requestTimer&&(this.videoStream?clearTimeout(this.requestTimer):clearInterval(this.requestTimer)),this.videoStream&&!this.frameReader&&(this.frameReader=this.videoStream.getReader()),this.requestFrame(),this.statsTimer=setInterval(this.updateStats,1e3)}stop(t){clearInterval(this.statsTimer),this.frameReadTimer&&clearTimeout(this.frameReadTimer),this.fps=0,this.receivingFps=0,this.receivedFrames=0,this.generatedFrames=0,this.updateStats(),this.frameReader?(this.frameReader.releaseLock(),this.frameReader=null,clearTimeout(this.requestTimer)):(clearInterval(this.requestTimer),this.requestTimer=null),t&&this.videoStream&&(this.videoStream.cancel(),this.videoStream=null)}requestFrame(){this.frameReader?(this.frameReadTimer=setTimeout((()=>{Y(new Error("VB_FRAMEREAD_TIMEOUT"))}),1e4),this.frameReader.read().then((t=>{let{value:e,done:r}=t;if(clearTimeout(this.frameReadTimer),r)clearTimeout(this.requestTimer),this.requestTimer=null;else{const{timestamp:t,displayWidth:r,displayHeight:i}=e;this.frameTimestamp=t,this.frameDisplayHeight=i,this.frameDisplayWidth=r,this.sendFrame(e),this.requestTimer=setTimeout(this.requestFrame,1e3/this.frameRate-4)}})).catch((t=>{clearTimeout(this.frameReadTimer),clearTimeout(this.requestTimer),this.requestTimer=null,Y(t)}))):this.requestTimer=setInterval((()=>{this.postMessage({cmd:O.VB_REQUEST_FRAME})}),1e3/this.frameRate-4)}handleUnsupportedFrame(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.postMessage({cmd:O.VB_VIDEO_FORMAT_UNSUPPORTED,payload:t})}sendFrame(t){var e;this.receivingFps++,this.isVBEnabled?this.vb.generateVBFrame(t):(null===(e=this.vbRender)||void 0===e||e.render(t),this.writeVBFrameToStream(t))}writeVBFrameToStream(t){if(this.isStreamEnabled)if(this.vbFrameWriter){let e;if("format"in t)e=t;else if("data_ptr"in t){const{format_width:r,format_height:i,valid_x:s,valid_y:n,valid_width:a,valid_height:o,data:c}=t;e=new VideoFrame(c,{format:"I420",timestamp:this.frameTimestamp,codedWidth:r,codedHeight:i,visibleRect:{x:s,y:n,width:a,height:o},displayHeight:this.frameDisplayHeight,displayWidth:this.frameDisplayWidth})}e&&(this.vbFrameWriter.write(e),e.close())}else this.streamRender&&this.streamRender.render(t)}handleMessage(t){return e=this,r=void 0,s=function*(){var e,r,i;const{cmd:s}=t.data;switch(s){case O.VB_SEND_FRAME:{const e=t.data.payload;this.sendFrame(e);break}case O.VB_UPDATE_BG:{const e=t.data.payload;"blur"===e?this.vb.blur():this.vb.setBackgroundImage(e);break}case O.VB_FREE_MEMORY:this.vb.free(t.data.payload);break;case O.VB_WORKER_INIT:{const e=t.data.payload;A.init(e.renderUserAgentInfo),w.init(e.renderCapabilitiesDesc),S.init(e.renderConfigDesc),l=M,this.manualFreeMemory=e.needFrame||!1,this.vb=new k,this.vb.onModelReady=()=>{this.postMessage({cmd:O.VB_MODEL_READY})},this.vb.onPredictDone=()=>{this.postMessage({cmd:O.VB_PREDICT_DONE,payload:this.vb.backend})},this.vb.onUnsupportedFrame=this.handleUnsupportedFrame,this.vb.onVBFrame=t=>{this.fps++;const{valid_width:e,valid_height:r}=t;this.writeVBFrameToStream(t),this.vbRender&&this.vbRender.render(t),this.vb.manualFreeMemory&&this.postMessage({cmd:O.VB_GENERATED_FRAME,payload:t}),this.isWaitingFirstFrame&&(this.isWaitingFirstFrame=!1,this.postMessage({cmd:O.VB_GENERATE_FIRST_FRAME})),this.width===e&&this.height===r||(this.postMessage({cmd:O.VB_RESOLUTION_CHANGE,payload:{width:e,height:r}}),this.width=t.valid_width,this.height=t.valid_height)},this.vb.manualFreeMemory=this.manualFreeMemory;try{yield this.vb.initialize(e),self.postMessage({cmd:O.VB_INIT_SUCCESS})}catch(t){this.postMessage({cmd:O.VB_INIT_FAILED,payload:t})}break}case O.VB_RENDER_CANVAS:{const e=t.data.payload;this.vbRender=new X(e,"VB_MODULE_CANVAS"),this.vbRender.onUnsupportedFrame=this.handleUnsupportedFrame;break}case O.VB_RENDER_FRAME:{const r=t.data.payload;null===(e=this.vbRender)||void 0===e||e.render(r);break}case O.VB_START:{const{videoStream:e,frameRate:r}=t.data.payload||{};this.frameRate=r||this.frameRate,e&&(this.videoStream=e),this.start(),this.isWaitingFirstFrame=!0;break}case O.VB_TOGGLE_VB:this.isVBEnabled=t.data.payload;break;case O.VB_STOP:this.stop(t.data.payload),this.isWaitingFirstFrame=!1;break;case O.VB_MIRROR:null===(r=this.vbRender)||void 0===r||r.setMirror(t.data.payload);break;case O.VB_GENERATE_STREAM:{const e=t.data.payload;e?"getWriter"in e?(this.vbWritableStream=e,this.vbFrameWriter=this.vbWritableStream.getWriter()):this.streamRender=new X(e,"VB_STREAM_CANVAS_IN_WORKER"):this.vb.manualFreeMemory=!0,this.isStreamEnabled=!0;break}case O.VB_CHANGE_STREAM_CANVAS_SIZE:{const{width:e,height:r}=t.data.payload;null===(i=this.streamRender)||void 0===i||i.updateSize(e,r);break}case O.VB_STOP_STREAM:this.isStreamEnabled=!1,this.manualFreeMemory||(this.vb.manualFreeMemory=!1);break;case O.VB_UPDATE_NEED_FRAME:{const{payload:e}=t.data;this.manualFreeMemory=e,(e||!this.isStreamEnabled||this.vbWritableStream||this.streamRender)&&(this.vb.manualFreeMemory=e);break}case O.VB_UPDATE_FRAME_RATE:this.frameRate=t.data.payload,this.start();break;default:console.warn("unrecognize")}},new((i=void 0)||(i=Promise))((function(t,n){function a(t){try{c(s.next(t))}catch(t){n(t)}}function o(t){try{c(s.throw(t))}catch(t){n(t)}}function c(e){var r;e.done?t(e.value):(r=e.value,r instanceof i?r:new i((function(t){t(r)}))).then(a,o)}c((s=s.apply(e,r||[])).next())}));var e,r,i,s}};self.addEventListener("message",K.handleMessage)})()})();
//# sourceMappingURL=https://d1cdksi819e9z7.cloudfront.net/sourcemap/vb_worker.min.js-4fab6bb1232e1f38bc19.map