!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=25)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(17);function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}e.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(24)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},function(e,t){function r(e,t,r,n,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function a(e){r(s,i,o,a,u,"next",e)}function u(e){r(s,i,o,a,u,"throw",e)}a(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";var n,i,o,s,a,u,h,c=r(6),f=r(11),l=r(5),d={WORKLET:1,ENCODE:2,DECODE:3,WORKLET_APM_ONLY:4},p={MUTE:0,UNMUTE:1,LEAVED:2,MUTE_APM_ONLY:3,UNMUTE_APM_ONLY:4},b=0;var _=0;var m=!1;var v=null;var g=!1;t.a={WASMTYPE:d,AUDIO_STATE:p,onWasmModuleReady:function(e){if(!e)return console.warn("[AudioWASMAdapter] Module undefined");e.cwrap("_Heartbeat","number",["number"]),o=e.cwrap("_MuteUnmuteState","number",["number","number"]),s=e.cwrap("_Switch_Original_Sound","number",["number","boolean","boolean","boolean","boolean"]),a=e.cwrap("_Deliver_Recorded_Data","number",["number","number","number","number","number","number"]),u=e.cwrap("_Switch_Denoise","number",["number","number","number","number"]),h=e.cwrap("_Audio_Init","number",["number","string","string","number","number","boolean","boolean","boolean","number","boolean"])},setAudioInstanceAndType:function(e,t,r){n=e,t&&(b=t),r&&(i=r)},muteUnmuteState:function(e){if(null!=Object.values(p).find((function(t){return t==e})))return n?void(b!=d.WORKLET_APM_ONLY&&(o(n,e),Object(c.a)("muteUnmuteState: "+e))):Object(c.a)("muteUnmuteState: -1")},switchOriginalSound:function(e,t,r,i){n&&s(n,e,t,r,i)},deliverRecordedData:function(e,t,r,i){n&&a(n,e,t,0,r,i)},switchDenoise:function(e,t){n&&(m=e,u(n,!!e,3,!!t))},audioInit:function(e,t,r,n,i,o,s,a,u,c){return h(e,t,r,n,i,o,s,a,u,c)},setDecoder:function(e){v=e},needCalculateDenoiseOutput:function(){g=!0},onMonitorLogWASM:function(e,t){if(!(t<=0)){var r=Module.HEAPU8.subarray(e,e+t),n=String.fromCharCode.apply(null,r);n&&(b==d.ENCODE||b==d.DECODE?Object(c.a)(n):b==d.WORKLET?i&&i.port&&Object(c.a)(n,i.port):b==d.WORKLET_APM_ONLY&&i.port&&i.port.postMessage({status:"SPEECH_LOG",data:{log:n}}))}},onMuteSpeechWarningWASM:function(){postMessage({status:l.c})},onAudioLevelWASM:function(e,t,r){var n;b!=d.ENCODE&&b!=d.WORKLET_APM_ONLY||1==e&&(0===t&&0===_||(_=t,b===d.ENCODE?postMessage({status:l.a,value:t}):null!==(n=i)&&void 0!==n&&n.port&&i.port.postMessage({status:l.a,data:t})))},onAPMProcessedPCMWASM:function(e,t,r,n){if(m){var o=Module.HEAPF32.subarray(e/4,e/4+t);if(v){if(g){g=!1;var s=Object(f.a)(o,2).sumRms,a=Object(f.c)(s);i.port&&i.port.postMessage({status:"AUDIO_LEVEL_R16_DENOISE",level:a})}v.push([o])}}}}},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return o}));var n=57,i=38,o=121},function(e,t,r){"use strict";var n=r(0),i=r.n(n),o=r(1),s=r.n(o);r(3),r(2);function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)return t.postMessage({status:48,data:e});postMessage({status:48,data:e})}r.d(t,"a",(function(){return a}));var u=function(){function e(){i()(this,e),this.ssrcInfoMap=new Map,this.timer=null}return s()(e,[{key:"updateSSRCInfo",value:function(e,t){this.ssrcInfoMap.has(e)||this.ssrcInfoMap.set(e,{firstTime:0,lastTime:0,frames:0,fps:0}),this._calculateFPS(e,t),this._removeZeroFPS()}},{key:"_calculateFPS",value:function(e,t){var r=this.ssrcInfoMap.get(e);if(0===r.frames?r.firstTime=t:r.lastTime=t,r.frames+=1,r.frames>2&&r.frames%5==0&&r.lastTime-r.firstTime>=1e3){var n=Math.floor(1e3/((r.lastTime-r.firstTime)/(r.frames-1)));r.fps!==n&&(this._notifyFPS(e,n),r.fps=n),r.firstTime=r.lastTime,r.frames=1}}},{key:"_removeZeroFPS",value:function(){var e=this,t=Date.now();this.ssrcInfoMap.forEach((function(r,n){var i=e.ssrcInfoMap.get(n);i&&t-i.lastTime>2e3&&(e.ssrcInfoMap.delete(n),e._notifyFPS(n,0))}))}},{key:"_notifyFPS",value:function(e,t){postMessage({status:66.6,data:{ssrc:e,fps:t}})}},{key:"_checkIfNewFrameComing",value:function(){var e=this;this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((function(){e._removeZeroFPS(),e.timer=null}),2500)}}]),e}();new Map,new u},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return h}));var n=r(0),i=r.n(n),o=r(1),s=r.n(o),a=r(12),u=function(){function e(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(i()(this,e),this.STATE_READ_READY=0,this.STATE_READ_INDEX=1,this.STATE_WRITE_READY=2,this.STATE_WRITE_INDEX=3,this.STATE_DATA_COUNT=4,this.STATE_CACHE_SIZE=5,this.STATY_READY_NO=0,this.STATY_READY_YES=1,this.sabState=new Uint32Array(t),this.sabBuffer=new Float32Array(r),this.perFrameLength=n,this.writeChannelNumb=o,this.bufferLen=this.sabBuffer.length,this.supportSpecialOptimization=this.bufferLen%n==0,this.bufferIndex=null,this.supportSpecialOptimization){var s=this.bufferLen/n;this.bufferIndex=[];for(var u=0;u<s;u++)this.bufferIndex.push(this.sabBuffer.subarray(u*n,u*n+n))}this.placeBuffer=new Float32Array(this.perFrameLength),this.QUANTUM_SIZE=128,this.CACHE_SIZE_MAX_VALUE=Math.floor(Math.floor(this.bufferLen/this.QUANTUM_SIZE)/2),this.CACHE_SIZE_MIN_VALUE=6,this.CACHE_SIZE_MAX_VALUE<this.CACHE_SIZE_MIN_VALUE&&(this.CACHE_SIZE_MAX_VALUE=this.CACHE_SIZE_MIN_VALUE),this.setCacheSize(this.CACHE_SIZE_MIN_VALUE),this._counter=0,this.onCacheSizeChange=null,this.cacheSizeController=new a.a}return s()(e,[{key:"getCacheSize",value:function(){return Atomics.load(this.sabState,this.STATE_CACHE_SIZE)}},{key:"setCacheSize",value:function(e){e>this.CACHE_SIZE_MAX_VALUE&&(e=this.CACHE_SIZE_MAX_VALUE),e<this.CACHE_SIZE_MIN_VALUE&&(e=this.CACHE_SIZE_MIN_VALUE),this.onCacheSizeChange&&this.cacheSizeController.shouldSendCacheSize(e)&&this.onCacheSizeChange(e),Atomics.store(this.sabState,this.STATE_CACHE_SIZE,e)}},{key:"setQuantumSize",value:function(e){this.QUANTUM_SIZE=e,this.CACHE_SIZE_MAX_VALUE=Math.floor(Math.floor(this.bufferLen/this.QUANTUM_SIZE)/2),this.CACHE_SIZE_MAX_VALUE<this.CACHE_SIZE_MIN_VALUE&&(this.CACHE_SIZE_MAX_VALUE=this.CACHE_SIZE_MIN_VALUE)}},{key:"isNeedMoreData",value:function(){var e=Atomics.load(this.sabState,this.STATE_CACHE_SIZE);return Atomics.load(this.sabState,this.STATE_DATA_COUNT)<e*this.QUANTUM_SIZE}},{key:"shouldAdjustCacheBuffer",value:function(){this._counter>0&&this.setCacheSize(this.getCacheSize()+1)}},{key:"clear",value:function(){this.sabState&&(this.sabState[this.STATE_READ_READY]=0,this.sabState[this.STATE_READ_INDEX]=0,this.sabState[this.STATE_WRITE_READY]=0,this.sabState[this.STATE_WRITE_INDEX]=0,this.sabState[this.STATE_DATA_COUNT]=0),this._counter=0}},{key:"setWriteReady",value:function(){this.sabState[this.STATE_WRITE_READY]=this.STATY_READY_YES}},{key:"isReady",value:function(){return this.sabState[this.STATE_WRITE_READY]&&this.sabState[this.STATE_READ_READY]}},{key:"getDataCount",value:function(){return Atomics.load(this.sabState,this.STATE_DATA_COUNT)}},{key:"write",value:function(e){if(void 0!==e[0]&&e[0].length*this.writeChannelNumb===this.perFrameLength){var t=this.sabState[this.STATE_READ_READY];if(this.sabState[this.STATE_WRITE_READY]||(this.sabState[this.STATE_WRITE_READY]=this.STATY_READY_YES,this.sabState[this.STATE_WRITE_INDEX]=0),t)return this.supportSpecialOptimization?this.writeSpecial(e):this.writeNormal(e)}}},{key:"writeNormal",value:function(e){for(var t=this.sabState[this.STATE_WRITE_INDEX],r=0;r<this.writeChannelNumb;r++)for(var n=0;e[r]&&n<e[r].length;n++)this.sabBuffer[(t+n*this.writeChannelNumb+r)%this.bufferLen]=e[r][n];(t+=this.perFrameLength)>=this.bufferLen&&(t-=this.bufferLen),this.sabState[this.STATE_WRITE_INDEX]=t,Atomics.add(this.sabState,this.STATE_DATA_COUNT,this.perFrameLength)}},{key:"writeSpecial",value:function(e){for(var t=this.sabState[this.STATE_WRITE_INDEX],r=0;r<this.writeChannelNumb;r++)for(var n=0;e[r]&&n<e[r].length;n++)this.bufferIndex[t][n*this.writeChannelNumb+r]=e[r][n];t=(t+1)%this.bufferIndex.length,this.sabState[this.STATE_WRITE_INDEX]=t,Atomics.add(this.sabState,this.STATE_DATA_COUNT,this.perFrameLength)}},{key:"read",value:function(){var e=this.sabState[this.STATE_READ_READY],t=this.sabState[this.STATE_WRITE_READY];if(e||(this.sabState[this.STATE_READ_READY]=this.STATY_READY_YES,this.sabState[this.STATE_READ_INDEX]=0),!t)return null;var r=this.supportSpecialOptimization?this.readSpecial():this.readNormal();return null===r?this.shouldAdjustCacheBuffer():this._counter++,r}},{key:"readNormal",value:function(){var e=this.sabState[this.STATE_READ_INDEX],t=Atomics.load(this.sabState,this.STATE_DATA_COUNT);if(t<this.perFrameLength)return null;if(t>this.bufferLen){var r=Math.ceil((t-this.bufferLen)/this.perFrameLength)+1;e=(r*this.perFrameLength+e)%this.bufferLen,Atomics.sub(this.sabState,this.STATE_DATA_COUNT,r*this.perFrameLength)}var n=null;if(this.bufferLen-e>=this.perFrameLength)n=this.sabBuffer.subarray(e,e+this.perFrameLength);else{var i=this.sabBuffer.subarray(e),o=this.sabBuffer.subarray(0,this.perFrameLength-i.length);(n=this.placeBuffer).set(i),n.set(o,i.length)}return(e+=this.perFrameLength)>=this.bufferLen&&(e-=this.bufferLen),this.sabState[this.STATE_READ_INDEX]=e,Atomics.sub(this.sabState,this.STATE_DATA_COUNT,this.perFrameLength),n}},{key:"readSpecial",value:function(){var e=this.sabState[this.STATE_READ_INDEX],t=Atomics.load(this.sabState,this.STATE_DATA_COUNT);if(t<this.perFrameLength)return null;if(t>this.bufferLen){var r=Math.ceil((t-this.bufferLen)/this.perFrameLength)+1;e=(r+e)%this.bufferIndex.length,Atomics.sub(this.sabState,this.STATE_DATA_COUNT,r*this.perFrameLength)}var n=this.bufferIndex[e];return e=(e+1)%this.bufferIndex.length,this.sabState[this.STATE_READ_INDEX]=e,Atomics.sub(this.sabState,this.STATE_DATA_COUNT,this.perFrameLength),n}}]),e}(),h=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;i()(this,e),this.rframes=t,this.wframes=r,this.writeChannelNumb=n,this.cap=this.lcm(t,r),this.buffer=new Float32Array(this.cap),this.remain=0,this.woffset=0,this.roffset=0}return s()(e,[{key:"gcd",value:function(e,t){return 0===t?e:this.gcd(t,e%t)}},{key:"lcm",value:function(e,t){return e/this.gcd(e,t)*t}},{key:"push",value:function(e){if(null==e[0]||e[0].length*this.writeChannelNumb==this.wframes){for(var t=0;t<this.writeChannelNumb;t++)for(var r=0;r<e[0].length;r++)this.buffer[(this.woffset+r*this.writeChannelNumb+t)%this.cap]=e[t]?e[t][r]:e[0][r];this.woffset+=this.wframes,this.remain+=this.wframes,this.woffset>=this.cap&&(this.woffset=this.woffset%this.cap)}else{var n;console.error("[Audio] critical error in AudioWorklet: data.length:",e.length,"this.woffset:",this.woffset,"this.cap:",this.cap),_workletPrinter&&_workletPrinter.error("critical error in AudioWorklet: ".concat(null===(n=e[0])||void 0===n?void 0:n.length," ").concat(his.writeChannelNumb," ").concat(this.wframes))}}},{key:"read",value:function(){if(!this.hasData())return null;var e=this.buffer.subarray(this.roffset,this.roffset+this.rframes);return this.remain-=this.rframes,this.roffset+=this.rframes,this.roffset>=this.cap&&(this.roffset=this.roffset%this.cap),e}},{key:"hasData",value:function(){return this.remain>=this.rframes}},{key:"clear",value:function(){this.buffer.fill(0),this.remain=0,this.woffset=0,this.roffset=0}}]),e}()},function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s}));r(19),r(0),r(1);var n=[0,1,2,3,4,4,5,5,5,5,6,6,6,6,6,7,7,7,7,8,8,8,9,9,9,9,9,9,9,9,9,9,9];function i(e,t){for(var r=0,n=0,i=0;i<e.length;i+=t){n+=e[i]*e[i];var o=Math.abs(e[i]);o>r&&(r=o)}return{sumRms:n/e.length/t,absMax:r}}function o(e){if("number"!=typeof e||e<0||e>1)return-1;var t=parseInt(32768*e/1e3);return 0==t&&e>250&&(t=1),n[t]}function s(e){return e>.1995?15:e>.0794?14:e>.0316?13:e>.0126?12:e>.005?11:e>.002?10:e>79433e-8?9:e>31623e-8?8:e>12589e-8?7:e>50119e-9?6:e>19953e-9?5:e>79433e-10?4:e>31623e-10?3:e>12589e-10?2:e>5.0119e-7?1:0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0),i=r.n(n),o=r(1),s=r.n(o),a=function(){function e(){i()(this,e),this.cacheSize=0,this.sameCacheSizeCounter=0}return s()(e,[{key:"shouldSendCacheSize",value:function(e){return e===this.cacheSize&&this.sameCacheSizeCounter++,(this.cacheSize!==e||200===this.sameCacheSizeCounter)&&(this.sameCacheSizeCounter=0,this.cacheSize=e,!0)}}]),e}()},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t,n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(13);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(9).default,i=r(10);e.exports=function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(7),i=r(13),o=r(20),s=r(21);function a(t){var r="function"==typeof Map?new Map:void 0;return e.exports=a=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return s(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,a(t)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(9).default,i=r(23);e.exports=function(e){var t=i(e,"string");return"symbol"===n(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0),i=r.n(n),o=r(1),s=r.n(o),a=function(){function e(t){i()(this,e),this.messageQueue=[],this.auidoNodePort,this.userAgent="",this.isSafari=!1,this.debug=this.debug.bind(this),this.log=this.log.bind(this),this.warn=this.warn.bind(this),this.error=this.error.bind(this),this.print_=this.print_.bind(this),this.messageHeader=t}return s()(e,[{key:"setUserAgent",value:function(e){this.userAgent=e,this.userAgent.match(/AppleWebKit\/(\d+)\./)&&(this.isSafari=!0)}},{key:"setAuidoNodePort",value:function(e){this.auidoNodePort=e}},{key:"debug",value:function(e){e=this.messageHeader+e;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.print_({level:"debug",message:e,data:r})}},{key:"log",value:function(e){e=this.messageHeader+e;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.print_({level:"log",message:e,data:r})}},{key:"warn",value:function(e){e=this.messageHeader+e;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.print_({level:"warn",message:e,data:r})}},{key:"error",value:function(e){e=this.messageHeader+e;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.print_({level:"error",message:e,data:r})}},{key:"print_",value:function(e){if(this.messageQueue.push(e),this.auidoNodePort)for(;this.messageQueue.length;){var t=this.messageQueue.shift();this._postToWorkerPrint(t)}}},{key:"_postToWorkerPrint",value:function(e){this.auidoNodePort&&this.auidoNodePort.postMessage({status:"workletMessage",data:{level:e.level,message:e.message,data:e.data}})}}]),e}()},function(e,t,r){var n=r(17);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(13),i=r(22);function o(t,r,s){return i()?(e.exports=o=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=o=function(e,t,r){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return r&&n(o,r.prototype),o},e.exports.__esModule=!0,e.exports.default=e.exports),o.apply(null,arguments)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(9).default;e.exports=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(9).default;function i(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},r=Object.prototype,o=r.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",h=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,o=Object.create(i.prototype),a=new x(n||[]);return s(o,"_invoke",{value:T(e,r,a)}),o}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var p={};function b(){}function _(){}function m(){}var v={};f(v,u,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(k([])));y&&y!==r&&o.call(y,u)&&(v=y);var A=m.prototype=b.prototype=Object.create(v);function S(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;s(this,"_invoke",{value:function(i,s){function a(){return new t((function(r,a){!function r(i,s,a,u){var h=d(e[i],e,s);if("throw"!==h.type){var c=h.arg,f=c.value;return f&&"object"==n(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,u)}),(function(e){r("throw",e,a,u)})):t.resolve(f).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,u)}))}u(h.arg)}(i,s,r,a)}))}return r=r?r.then(a,a):a()}})}function T(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return L()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===p)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=d(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=d(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,p;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function k(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:L}}function L(){return{value:void 0,done:!0}}return _.prototype=m,s(A,"constructor",{value:m,configurable:!0}),s(m,"constructor",{value:_,configurable:!0}),_.displayName=f(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,f(e,c,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},S(E.prototype),f(E.prototype,h,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new E(l(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(A),f(A,c,"Generator"),f(A,u,(function(){return this})),f(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=k,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;M(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:k(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.r(t);var n=r(10),i=r.n(n),o=r(14),s=r.n(o),a=r(15),u=r.n(a),h=r(7),c=r.n(h),f=r(16),l=r.n(f),d=r(0),p=r.n(d),b=r(1),_=r.n(b),m=r(18),v=function(e,t){this._BYTES_PER_ELEMENT=t,this.capacity=(e.byteLength-8)/t,this.usableCapacity=this.capacity-1,this.buf=e,this.write_ptr=new Uint32Array(this.buf,0,1),this.read_ptr=new Uint32Array(this.buf,4,1),this.storageUint8s=new Uint8Array(this.buf,8,e.byteLength-8)};v.prototype.available_read=function(){var e=Atomics.load(this.read_ptr,0),t=Atomics.load(this.write_ptr,0);return this._available_read(e,t)},v.prototype._available_read=function(e,t){return(t+this.capacity-e)%this.capacity},v.prototype.dequeue=function(){var e=Atomics.load(this.read_ptr,0),t=new Uint32Array(this.buf,e*this._BYTES_PER_ELEMENT+8,1);return this.storageUint8s.subarray(e*this._BYTES_PER_ELEMENT+4,e*this._BYTES_PER_ELEMENT+4+t[0])},v.prototype.addReadPtr=function(){var e=Atomics.load(this.read_ptr,0);Atomics.store(this.read_ptr,0,(e+1)%this.capacity)},v.prototype.getReaderPtr=function(){return this.read_ptr[0]},v.prototype.setReaderPtr=function(e){Atomics.store(this.read_ptr,0,e%this.capacity)},v.prototype.get=function(e){var t=e%this.capacity,r=new Uint32Array(this.buf,t*this._BYTES_PER_ELEMENT+8,1);return this.storageUint8s.subarray(t*this._BYTES_PER_ELEMENT+4,t*this._BYTES_PER_ELEMENT+4+r[0])};var g=v,y=r(5),A=r(4),S=(r(6),r(8)),E=r(12);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var i=c()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u()(this,r)}}r.d(t,"Update_SSRC_Time",(function(){return K})),r.d(t,"Get_SSRC_Latest_Time",(function(){return J})),globalThis.onWasmModuleReady=function(){A.a.onWasmModuleReady(Module),O=Module.cwrap("_Audio_Init","number",["number","string","string","number","number","boolean","boolean","boolean","number","boolean"]),(I=O(H,z,W,0,0,!0,!1,F,1))?A.a.setAudioInstanceAndType(I,A.a.WASMTYPE.WORKLET,re):_workletPrinter.error("audio_handle not exist"),N=Module.cwrap("_Audio_Decode","number",["number","number","number","number"]),B=Module.cwrap("_Get_Mixed_Audio","number",["number","number","number","number"]),U=Module.cwrap("_setMultiViewFlag","number",["number","boolean"]),w=Module.cwrap("_Interpretation_Configure","number",["number","number","number","number"]),M=Module.cwrap("_Set_Speech_Volume_Level","number",["number","number","number"]),P=Module._malloc(4*X),Module.HEAPU32.subarray(P/4,P/4+X),U(I,Y),x=Module._malloc(Q),Module.HEAP8.subarray(x,x+Q),re.port.postMessage({status:"WASM_INIT_SUCCESS",data:{audio_handle:0!==I}})},globalThis.onAbort=function(e){_workletPrinter.error("WASM onAbort "+(e?e.message:""),e)},globalThis.preInit=function(e){_workletPrinter.debug("WASM preInit"+(e?e.message:""),e)},globalThis.preRun=function(e){_workletPrinter.debug("WASM preRun"+(e?e.message:""),e)},globalThis._workletPrinter=new m.a("[Audio][Worklet][WASM]"),globalThis.AudioWasmAdapter=A.a;var w,P,M,x,k=function(){function e(){p()(this,e),this.buffList=[],this.cacheMinSize=4,this.cacheMaxSize=16,this.cacheSize=this.cacheMinSize,this.onCacheSizeChange=null,this.onrollbackbuffer=null,this.onneedmoredata=null,this.isReady=!1,this.cacheSizeController=new E.a}return _()(e,[{key:"push",value:function(e){this.isReady=!0,this.buffList.push({buff:e,offset:0})}},{key:"copy",value:function(e,t,r,n){return e.length-t<=r.length-n?(0===t?r.set(e,n):r.set(e.subarray(t),n),e.length-t):(r.set(e.subarray(t,t+r.length-n),n),r.length-n)}},{key:"increaseCacheSize",value:function(){this.isReady&&this.cacheSize++,this.cacheSize>this.cacheMaxSize&&(this.cacheSize=this.cacheMaxSize),this.onCacheSizeChange&&this.isReady&&this.cacheSizeController.shouldSendCacheSize(this.cacheSize)&&this.onCacheSizeChange(this.cacheSize)}},{key:"copyTo",value:function(e){if(0===this.buffList.length)return e.fill(0),void this.increaseCacheSize();var t=this.buffList[0];if(t.buff.length-t.offset>=e.length)this.copy(t.buff,t.offset,e,0),t.offset+=e.length,t.offset===t.buff.length&&(this.buffList.shift(),this.onrollbackbuffer&&this.onrollbackbuffer(t.buff));else{if(this.buffList.length<2)return e.fill(0),void this.increaseCacheSize();var r=this.copy(t.buff,t.offset,e,0);this.buffList.shift(),this.onrollbackbuffer&&this.onrollbackbuffer(t.buff),t=this.buffList[0],r=this.copy(t.buff,t.offset,e,r),t.offset+=r}}},{key:"requestMoreData",value:function(){this.buffList.length<this.cacheSize&&this.onneedmoredata&&this.onneedmoredata()}},{key:"hasData",value:function(){return this.buffList.length>=2}}]),e}(),L=function(){function e(t){p()(this,e),this.buffList=[],this.frameLength=t,this.onframedata=null}return _()(e,[{key:"copy",value:function(e,t,r,n){if(e[0].length*Z<=r.length-n){for(var i=0;i<Z;i++)for(var o=0;e[i]&&o<e[i].length;o++)r[n+o*Z+i]=e[i][o];return(e[0].length-t)*Z}for(var s=0;s<Z;s++)for(var a=0;e[s]&&a<e[s].length&&n+a*Z+s<r.length;a++)r[n+a*Z+s]=e[s][a];return r.length-n}},{key:"rollbackbuffer",value:function(e){this.buffList.push({buff:e,offset:0})}},{key:"push",value:function(e){0===this.buffList.length&&this.buffList.push({buff:new Float32Array(this.frameLength),offset:0});var t=this.buffList[0];if(t.buff.length-t.offset>=e[0].length*Z){var r=this.copy(e,0,t.buff,t.offset);t.offset+=r,t.buff.length===t.offset&&(this.buffList.shift(),this.onframedata&&this.onframedata(t.buff))}else{var n=this.copy(e,0,t.buff,t.offset);if(this.buffList.shift(),this.onframedata&&this.onframedata(t.buff),e[0].length*Z>n){for(var i=[],o=0;o<Z;o++)i.push(e[o].subarray(Math.floor(n/Z)+(n%Z>o?1:0)));this.push(i)}}}}]),e}(),C=function(){function e(t,r){var n=this;p()(this,e),this.context=r,this.decodePort=null,this.encodePort=null,this.captureSize=t/100*Z,this.playBuffer=new k,this.playBuffer.onrollbackbuffer=function(e){n.decodePort},this.playBuffer.onneedmoredata=function(){n.decodePort&&n.decodePort.postMessage({status:1})},this.playBuffer.onCacheSizeChange=function(e){n.decodePort&&n.decodePort.postMessage({status:3,cacheSize:e})},this.quantum=new Float32Array(128*G),this.captureBuffer=new L(this.captureSize),this.captureBuffer.onframedata=function(e){n.encodePort&&n.encodePort.postMessage({command:2,buffer:e},[e.buffer])}}return _()(e,[{key:"setDecodePort",value:function(e){this.decodePort&&this.decodePort.close(),this.decodePort=e,this.decodePort.onmessage=this.handleDecodeData.bind(this)}},{key:"setEncodePort",value:function(e){this.encodePort&&this.encodePort.close(),this.encodePort=e,this.encodePort.onmessage=this.handleEncodeData.bind(this)}},{key:"handleDecodeData",value:function(e){this.context.isPlaying&&this.playBuffer.push(e.data.data)}},{key:"handleEncodeData",value:function(e){switch(e.data.event){case 0:this.captureBuffer.rollbackbuffer(e.data.buffer)}}},{key:"requestMoreData",value:function(){this.playBuffer.requestMoreData()}},{key:"close",value:function(){this.decodePort&&(this.decodePort=null,this.decodePort.close()),this.encodePort&&(this.encodePort=null,this.encodePort.close())}},{key:"write",value:function(e){this.captureBuffer.push(e)}},{key:"read",value:function(){return this.playBuffer.copyTo(this.quantum),this.requestMoreData(),this.quantum}}]),e}(),D="undefined"!=typeof SharedArrayBuffer,R=!0,O=null,N=null,I=null,B=null,U=null,W=0,z=0,F=!1,H=0,j=0,Y=!1,Z=1,G=1,V=null,X=10,Q=1500,q=new Map;function K(e){if(e){var t=e.length/16,r=0,n=0;for(r=0;r<t;r++){var i=0;for(n=16*r+0;n<16*r+4;n++)i+=e[n]*Math.pow(256,n-16*r);i>>=10;var o=0;for(n=16*r+4;n<16*r+12;n++)o+=e[n]*Math.pow(256,n-16*r-4);q.set(i,o)}}}function J(e){e>>=10;var t=q.get(e);return t?(q.set(e,0),t):0}function $(e){var t=e[1];return 4294967296*e[2]+t}globalThis.update_play_time=function(e,t){if(t){var r=new Uint8Array(t),n=Module.HEAP8.subarray(e+0,e+t);if(r.set(n),Y){var i;null===(i=re.videoDecodePort)||void 0===i||i.postMessage({status:1,data:r},[r.buffer])}else{for(var o=new Uint32Array(r.buffer),s=0,a=0,u=0;u<r.length/16;u++){var h=o[4*u];512&h?a=$(o.subarray(4*u,4*u+4)):h>>10==j>>10&&(s=$(o.subarray(4*u,4*u+4)))}if(!s&&!a)return;re.port.postMessage({status:y.b,at:s,st:a})}}};var ee=null,te=null;globalThis.frame_callback=function(e,t,r,n,i,o,s,a){ee===e&&te.length==t*s||(te=Module.HEAPF32.subarray(e/4,e/4+t*s),ee=e),V.push([te])};var re=null,ne=function(e){s()(r,e);var t=T(r);function r(e){var n,o,s;return p()(this,r),s=t.call(this),re=i()(s),monitorLOG("WIB"),s.port.onmessage=s.handleMessage.bind(i()(s)),s.isPlaying=!1,s.isCapturing=!1,s.wasmModule=null==e||null===(n=e.processorOptions)||void 0===n?void 0:n.wasmModule,e&&e.processorOptions&&(e.processorOptions.audioEncodeChannelsNum&&(Z=e.processorOptions.audioEncodeChannelsNum),e.processorOptions.audioDecodeChannelsNum&&(G=e.processorOptions.audioDecodeChannelsNum)),s.SABConstructor(e&&e.processorOptions?e.processorOptions.sharedBuffer:null),s.noSABConstructor(),globalThis.fsHandler&&globalThis.fsHandler.setPort(s.port),null!=e&&null!==(o=e.processorOptions)&&void 0!==o&&o.userAgent&&_workletPrinter.setUserAgent(e.processorOptions.userAgent),_workletPrinter.setAuidoNodePort(s.port),monitorLOG("WIE"),s}return _()(r,[{key:"SABConstructor",value:function(e){this.sampleRate_=0,this.g_sharedbuffer=e||null,this.encodeSAB=null,this.decodeSAB=null,this.audioEncodePort=null,this.audioDecodePort=null,this.videoDecodePort=null,this.rtpSAB=null,this.stopPlayAudio=!1,V=new S.a(128*G,sampleRate/100*G)}},{key:"noSABConstructor",value:function(){this.audioProcessBuffer=new C(sampleRate,this),this.isRunning=!0}},{key:"handleMessage",value:function(e){var t=e.data,r=t.status,n=t.data;switch(r){case"diableSharedArrayBuffer":D=!1;break;case"disableDecoderinworklet":R=!1;break;case"data":console.info("Dropped audio data before initialized");break;case"stopPlayAudio":this.isPlaying=!1;break;case"stopWorklet":se=!0;break;case"startPlayAudio":this.isPlaying=!0;break;case"StartCaptureAudio":this.isCapturing=!0;break;case"sampleRate":this.sampleRate_=n;break;case"audiowasm":try{initWasm(Module,this.wasmModule)}catch(e){_workletPrinter.error("init WASM failed, error message:"+e.message+e.stack)}break;case"initData":H=n.userid,W=n.meetingid,z=n.meetingnum,F=n.qoson;break;case"currentSSRC":j=n;break;case"stop_audio_incoming":this.stopPlayAudio=n;break;case"codecDoAVSync":Y=!0,U&&I&&U(I,!0);break;case"checkProcess":monitorLOG("PCC"+ae),ae=0;break;case"interpretation_set_lang":Module.HEAPU32.subarray(P/4,P/4+X)[0]=n.lang,w(I,1,P,1);break;case"interpretation_enable":Module.HEAPU32.subarray(P/4,P/4+X)[0]=n.enable?1:0,w(I,0,P,1);break;case"interpretation_mute_origin":Module.HEAPU32.subarray(P/4,P/4+X)[0]=n.mute?1:0,w(I,2,P,1);break;case"interpretation_set_interpreter":var i=Module.HEAPU32.subarray(P/4,P/4+X),o=P;n.interpreterList.length>=X&&(o=Module._malloc(4*n.interpreterList.length),i=Module.HEAPU32.subarray(o/4,o/4+n.interpreterList.length));for(var s=0;s<n.interpreterList.length;s++)i[s]=n.interpreterList[s];w(I,3,o,n.interpreterList.length),n.interpreterList.length>=X&&Module._free(o);break;case"setSpeechVolumeLevel":if(!I)return;M(I,n.userid,n.volume);break;default:D?this.handleMessageForSAB(e):this.handleMessageForNoSAB(e)}}},{key:"handleMessageForSAB",value:function(e){var t=this,r=e.data,n=r.status,i=r.data;switch(n){case"encodeAudioPort":this.audioEncodePort&&this.audioEncodePort.close(),this.audioEncodePort=e.ports[0];break;case"decodeAudioPort":this.audioDecodePort&&this.audioDecodePort.close(),this.audioDecodePort=e.ports[0],this.audioDecodePort.onmessage=function(e){};break;case"decodeVideoPort":this.videoDecodePort&&this.videoDecodePort.close(),this.videoDecodePort=e.ports[0];break;case"close":break;case"sharedBuffer":i&&(this.g_sharedbuffer=i),this.g_sharedbuffer&&(this.encodeSAB=new S.b(this.g_sharedbuffer.inputState,this.g_sharedbuffer.inputBuffer,128*Z,Z),this.decodeSAB=new S.b(this.g_sharedbuffer.outputState,this.g_sharedbuffer.outputBuffer,128*G),this.g_sharedbuffer.echoState&&this.g_sharedbuffer.echoBuffer&&(this.echoSAB=new S.b(this.g_sharedbuffer.echoState,this.g_sharedbuffer.echoBuffer,128*G,G)),this.rtpSAB=new g(this.g_sharedbuffer.rtpBuffer,1200),this.decodeSAB.onCacheSizeChange=function(e){t.audioDecodePort&&t.audioDecodePort.postMessage({status:3,cacheSize:e,isSAB:!0})});break;default:console.warn("unhanle commands in audioworklet",n)}}},{key:"handleMessageForNoSAB",value:function(e){var t=e.data.status;switch(t){case"encodeAudioPort":this.audioProcessBuffer.setEncodePort(e.ports[0]);break;case"decodeAudioPort":this.audioProcessBuffer.setDecodePort(e.ports[0]);break;case"close":this.audioProcessBuffer.close(),this.isPlaying=!1,this.isRunning=!1;break;default:console.warn("unhanle commands in audioworklet",t)}}},{key:"onReceivedRTP",value:function(){}},{key:"process",value:function(e,t,r){if(ae++,se)return!1;try{return D?R?this.SABDecodeProcess(e,t,r):this.SABProcess(e,t,r):this.NoSABprocess(e,t,r)}catch(e){return _workletPrinter.error("::process() exception: "+e.message+e.stack),!0}}},{key:"NoSABprocess",value:function(e,t,r){return!!this.isRunning&&(!this.isPlaying||(this.inputDataForNoSAB(e),this.outputDataForNoSAB(t),!0))}},{key:"inputDataForNoSAB",value:function(e){if(!e[0]||!e[0][0])return!0;var t=e[0];try{for(var r=e[0].length;!oe&&r<Z;r++)t.push(t[0])}catch(e){oe=!0,_workletPrinter.error("::inputDataForNoSAB() exception: "+e.message+e.stack)}this.audioProcessBuffer.write(t)}},{key:"outputDataForNoSAB",value:function(e){var t=this.audioProcessBuffer.read();if(this.stopPlayAudio)return!0;var r=e[0];if(1===G)for(var n=0;n<r.length;n++)r[n].set(t);else for(var i=0;i<G;i++)for(var o=0;r[i]&&o<r[i].length;o++)r[i][o]=t[o*G+i]}},{key:"inputData",value:function(e){if(!this.encodeSAB)return!0;this.encodeSAB.write(e),this.audioEncodePort.postMessage({command:2,buffer:!1})}},{key:"outputDecodeData",value:function(e,t){try{V.hasData()||B&&(sampleRate!=ie&&(globalThis.sampleRateLog(ie,sampleRate,"","",3),ie=sampleRate),B(I,sampleRate/100,0,sampleRate,G))}catch(e){_workletPrinter.error("::outputDecodeData() get_mixed_Audio exception: "+e.message+e.stack)}try{var r=V.read();if(!r)return;if(1===G)for(var n=0;n<e.length;n++)e[n].set(r);else for(var i=0;i<G;i++)for(var o=0;e[i]&&o<e[i].length;o++)e[i][o]=r[o*G+i];t&&this.echoSAB&&this.echoSAB.write(e)}catch(e){_workletPrinter.error("::outputDecodeData() set outputs exception: "+e.message+e.stack)}}},{key:"outputData",value:function(e){if(!this.decodeSAB)return!0;var t=this.decodeSAB.read();if(null===t||this.stopPlayAudio)return!0;if(1===G)for(var r=0;r<e.length;r++)e[r].set(t);else for(var n=0;n<G;n++)for(var i=0;e[n]&&i<e[n].length;i++)e[n][i]=t[i*G+n]}},{key:"SABDecodeProcess",value:function(e,t,r){try{if(!this.rtpSAB)return globalThis.monitorLOG("SABN"),!0;var n=this.rtpSAB.available_read();n>100&&(n=100);for(var i=this.rtpSAB.getReaderPtr(),o=0;o<n;){o++;var s=this.rtpSAB.get(i);i++,I&&x&&(Module.HEAP8.subarray(x,x+Q).set(s),N(I,0,x,s.length))}this.rtpSAB.setReaderPtr(i)}catch(e){_workletPrinter.error("::SABDecodeProcess() audio_decode exception: "+e.message+e.stack)}try{var a=e[0],u=t[0];if(!this.g_sharedbuffer)return!0;if(!this.sampleRate_||!u[0])return!0;var h=a[0]&&this.isCapturing;if(h){try{for(var c=a.length;!oe&&c<Z;c++)a.push(a[0])}catch(e){oe=!0,_workletPrinter.error("::SABDecodeProcess() exception: "+e.message+e.stack)}this.inputData(a)}return this.outputDecodeData(u,h),!0}catch(e){_workletPrinter.error("::SABDecodeProcess() inputs or outputs exception: "+e.message+e.stack)}return!0}},{key:"SABProcess",value:function(e,t,r){var n=e[0],i=t[0];if(!this.g_sharedbuffer)return!0;if(!this.sampleRate_||!i[0])return!0;if(n[0]&&this.isCapturing){try{for(var o=n.length;!oe&&o<Z;o++)n.push(n[0])}catch(e){oe=!0,_workletPrinter.error("::SABProcess() exception: "+e.message+e.stack)}this.inputData(n)}return this.outputData(i),!0}}],[{key:"parameterDescriptors",get:function(){return[{name:"pcm",defaultValue:1}]}}]),r}(l()(AudioWorkletProcessor)),ie=0,oe=!1,se=!1,ae=0;globalThis.LOG_OUT=function(){},globalThis.fsHandler?(globalThis.LOG_OUT_WEBRTC=globalThis.fsHandler.handleFile,globalThis.Get_ExternalRecord=globalThis.fsHandler.handleViperPrint):(globalThis.LOG_OUT_WEBRTC=function(){},globalThis.Get_ExternalRecord=function(){}),globalThis.send_data=function(){},globalThis.monitorLOG=function(e){e&&re.port.postMessage({status:"MONITOR_LOG",data:e})},globalThis.sampleRateLog=function(e,t,r,n,i){if(e||t){var o=null;switch(i){case 1:o="GGDS: ";break;case 2:o="SCAG: ";break;case 3:o="SCIW: "}var s=o+e+"|"+t+"|"+r+"|"+n;globalThis.monitorLOG(s)}},globalThis.wcl_trace_log=function(e,t){globalThis.fsHandler&&globalThis.fsHandler.handleAudioSDKUtilPrint(e,t)},globalThis.Viper_NetworkTrace=function(e,t){},registerProcessor("zoomAudioWorklet",ne)}]);
//# sourceMappingURL=https://d1cdksi819e9z7.cloudfront.net/sourcemap/js_audio_worklet.min.js-b07eb04658aecc23dea6.map