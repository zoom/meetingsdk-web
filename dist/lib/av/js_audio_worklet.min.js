!function(e){var t={};function r(u){if(t[u])return t[u].exports;var n=t[u]={i:u,l:!1,exports:{}};return e[u].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,u){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:u})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var u=Object.create(null);if(r.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(u,n,function(t){return e[t]}.bind(null,n));return u},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){function r(){this.a=[],this.b=0,this.residue=null}r.prototype.getLength=function(){return this.a.length-this.b},r.prototype.isEmpty=function(){return 0==this.a.length},r.prototype.enqueue=function(e){this.a.push(e)},r.prototype.dequeue=function(){if(0!=this.a.length){var e=this.a[this.b];return 2*++this.b>=this.a.length&&(this.a=this.a.slice(this.b),this.b=0),e}return null},r.prototype.peek=function(){return 0<this.a.length?this.a[this.b]:void 0};var n=function(){function e(){this.map=new Map,this.AudioQueueMGR=new function u(){this.ssrcQueueMap=new Map,u.prototype.AddQueue=function(e){var t=new r;return this.ssrcQueueMap.set(e,t),t},u.prototype.DeleteQueue=function(e){this.ssrcQueueMap.delete(e)},u.prototype.GetQueue=function(e){return this.ssrcQueueMap.get(e)},u.prototype.GetQueueData=function(e){return this.ssrcQueueMap.get(e).dequeue()},u.prototype.PutQueueData=function(e,t){this.ssrcQueueMap.get(e).enqueue(t)},u.prototype.GetQueueLength=function(e){var t=this.ssrcQueueMap.get(e);return null!==t?t.getLength():0}},this.timemap=new Map}return e.prototype.Add=function(e,t){this.map.put(e,t),this.AudioQueueMGR.AddQueue(e)},e.prototype.Clear=function(){this.map.clear()},e.prototype.Keys=function(){return this.map.keys()},e.prototype.UpdateSSRCTimeMap=function(e){this.timemap=e},e.prototype.GetSSRCTimeMap=function(e){return this.timemap?this.timemap.get(e):null},e}();function a(e,t){var r=0;if(null!==e){r=e.length;var u=new Float32Array(r+t.length);return u.set(e),u.set(t,r),u}return t}function i(e){p&&p.UpdateSSRCTimeMap(e)}var s,f,l=!1,p=new n,d=15,c=!1,h=null,g=0,b=0,M=new Float32Array(1280),v=null;function A(e,t,r,u){if(e=0,l&&p){var n=p.AudioQueueMGR.GetQueue(e);if(n||(n=p.AudioQueueMGR.AddQueue(e)),t=function(e){for(var t=new Int16Array(e.length/2),r=0;r<t.length;r++)t[r]=(255&e[2*r])+((255&e[2*r+1])<<8);return function(e,t,r){for(var u=new Float32Array(e.length-0),n=0;n<r;n++){var a=e[n]/32768;a>1&&(a=1),a<-1&&(a=-1),u[n]=a}return u}(t,0,t.length)}(t),r){var a=new Map,i=r.length/12,s=0,c=0;for(s=0;s<i;s++){for(e=0,c=12*s+0;c<12*s+4;c++)e+=r[c]*Math.pow(256,c-12*s);e>>=10;var h=0;for(c=12*s+4;c<12*s+12;c++)h+=r[c]*Math.pow(256,c-12*s-4);a.set(e,h)}var g={buffer:t,ntptime:a}}else g={buffer:t,ntptime:null};n.enqueue(g);var m=p?p.AudioQueueMGR.GetQueueLength(0):0;if(m>d+2)if(m>50)for(var b=m-d;b>=0;)Q(e),b--;else m>15&&f&&f.postMessage({status:"delay"})}}function Q(e){if(p){var t=p.AudioQueueMGR.GetQueue(0);return t?t.dequeue():null}}registerProcessor("zoomAudioWorklet",class extends AudioWorkletProcessor{static get parameterDescriptors(){return[{name:"pcm",defaultValue:1}]}constructor(){super(),this.port.onmessage=this.handleMessage.bind(this)}handleMessage(e){var t=e.data;switch(t.status){case"data":l&&(A(t.data.ssrc,t.data.data,t.data.time),h=t.data.ssrc);break;case"stopPlayAudio":l=!1;break;case"startPlayAudio":l=!0;break;case"close":break;case"StartCaptureAudio":c=!0,b=0;break;case"CurrentSSRC":h=t.data;break;case"encodeAudioPort":s&&s.close(),s=e.ports[0];break;case"decodeAudioPort":f&&f.close(),(f=e.ports[0]).onmessage=function(e){if(l&&(A(e.data.ssrc,e.data.data,e.data.time),h=e.data.ssrc),c){var t={command:"EchoCancel",data:e.data.aec,channels:e.data.channels,sampleHz:e.data.sampleHz};s.postMessage(t,[t.data.buffer])}};break;case"decodeAudioPortWithVideo":v=e.ports[0]}}process(e,t,r){let u=e[0],n=t[0];var o=function(e,t,r){if(p){var u=r,n=p.AudioQueueMGR.GetQueue(0),o=null;if(n){if(n.residue){if(n.residue.buffer.length>r)return o=n.residue.buffer.slice(0,r),n.residue.buffer=n.residue.buffer.slice(r),i(n.residue.ntptime),o;if(n.residue.buffer.length===r)return o=n.residue.buffer,i(n.residue.ntptime),n.residue=null,o;o=n.residue.buffer,i(n.residue.ntptime),n.residue=null,r-=o.length}for(var s=n.dequeue();s&&s.buffer.length<r;)i(s.ntptime),o=a(o,s.buffer),r-=s.buffer.length,s=n.dequeue();if(s&&(i(s.ntptime),0!==r&&s.buffer.length===r?o=a(o,s.buffer):0!==r&&s.buffer.length>r&&(o=a(o,s.buffer.slice(0,r)),n.residue={buffer:s.buffer.slice(r),ntptime:s.ntptime})),o){if(o.length<u)return n.residue={buffer:o,ntptime:null},null;if(o.length==u)return o}}return null}}(0,0,n[0].length);if(u[0]&&c&&(M.set(u[0],128*b),10==++b&&(b=0,s.postMessage({command:"EncodeAudioFrame",data:M}))),h&&23==++g){g=0;var f=function(e){if(e>>=10,p){var t=p.GetSSRCTimeMap(e);return null===t?0:t}}(h);f&&(v?v.postMessage({data:f}):this.port.postMessage({status:"InstantAudioTime",data:f}))}for(let e=0;e<n.length;++e){let t=n[e];for(let e=0;e<t.length;++e)o&&e<o.length&&(t[e]=o[e])}return!o||o.length,!0}})}]);