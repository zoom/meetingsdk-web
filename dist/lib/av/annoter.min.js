(window.webpackJsonpJsMediaSDK_Instance=window.webpackJsonpJsMediaSDK_Instance||[]).push([[0],{103:function(t,e,n){"use strict";var i,r,s,o,a,h,c,u,l,d,f,p,g,v,_;Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaultTool=e.getDefaultAnnoPageState=e.getDefaultAnnoPduPage=e.getDefaultAnnoObjScribble=e.getDefaultAnnoLineFormat=e.getDefaultPduDocRequestDrawAck=e.getDefaultPduDocRequestDraw=e.getDefaultAnnoPduHeader=e.getDefaultAnnoObjHeader=e.DEFAULT_CAPTURE_FRAME_RATE=e.MSG_TO_WHITEBOARD_TYPE=e.ANNOTATION_CLEAR_TYPE=e.AnnoToolType=e.ANNOTATION_ACTTION_TYPE=e.ANNO_MSG_TYPE=e.ANNO_ENCODE_TYPE=e.AnnoObjFlagMask=e.AnnoLineCapStyle=e.AnnoLineJoinStyle=e.AnnoLineDashStyle=e.AnnoLineFormatType=e.AnnoDocRequestDrawAckCode=e.AnnoDnSource=e.AnnoPduType=e.AnnoObjType=e.ANNO_PDU_CMD=e.ANNO_ENGINE_VERSION=e.NULL_NODE_ID=void 0,e.NULL_NODE_ID=4294967295,e.ANNO_ENGINE_VERSION=610,e.ANNO_PDU_CMD="SEND_ANNOTATION_PDU",function(t){t[t.kComposite=0]="kComposite",t[t.kGroup=1]="kGroup",t[t.kPen=2]="kPen",t[t.kSmoothPen=3]="kSmoothPen",t[t.kNull=77]="kNull"}(i||(e.AnnoObjType=i={})),function(t){t[t.kAppBase=4096]="kAppBase",t[t.kAppMax=8191]="kAppMax",t[t.kDocBase=8192]="kDocBase",t[t.kDocRequestDraw=8193]="kDocRequestDraw",t[t.kDocRequestDrawAck=8194]="kDocRequestDrawAck",t[t.kPageBase=12288]="kPageBase",t[t.kPageSync=12293]="kPageSync",t[t.kAnnoObjBase=65536]="kAnnoObjBase",t[t.kAnnoObjAdd=65537]="kAnnoObjAdd",t[t.kAnnoObjAddAck=65538]="kAnnoObjAddAck",t[t.kAnnoObjRemove=65539]="kAnnoObjRemove",t[t.kAnnoObjRestore=65540]="kAnnoObjRestore",t[t.kAnnoObjRemoveUser=65541]="kAnnoObjRemoveUser",t[t.kAnnoObjRestoreUser=65542]="kAnnoObjRestoreUser",t[t.kAnnoObjRemoveAll=65545]="kAnnoObjRemoveAll",t[t.kAnnoObjRestoreAll=65546]="kAnnoObjRestoreAll",t[t.kAnnoObjRemoveAllByHost=65547]="kAnnoObjRemoveAllByHost",t[t.kAnnoObjRestoreAllByHost=65548]="kAnnoObjRestoreAllByHost",t[t.kNull=143360]="kNull"}(r||(e.AnnoPduType=r={})),function(t){t[t.FROM_LOCAL=0]="FROM_LOCAL",t[t.FROM_REMOTE=1]="FROM_REMOTE"}(s||(e.AnnoDnSource=s={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.ACCPETED=1]="ACCPETED",t[t.DECLINED=2]="DECLINED"}(o||(e.AnnoDocRequestDrawAckCode=o={})),function(t){t[t.ANNO_LINE_FORMAT_TYPE_NONE=0]="ANNO_LINE_FORMAT_TYPE_NONE",t[t.ANNO_LINE_FORMAT_TYPE_COLOR=1]="ANNO_LINE_FORMAT_TYPE_COLOR",t[t.ANNO_LINE_FORMAT_TYPE_DEFAULT=1]="ANNO_LINE_FORMAT_TYPE_DEFAULT"}(a||(e.AnnoLineFormatType=a={})),function(t){t[t.ANNO_LINE_DASH_STYLE_SOLID=0]="ANNO_LINE_DASH_STYLE_SOLID",t[t.ANNO_LINE_DASH_STYLE_DASH=1]="ANNO_LINE_DASH_STYLE_DASH",t[t.ANNO_LINE_DASH_STYLE_DOT=2]="ANNO_LINE_DASH_STYLE_DOT",t[t.ANNO_LINE_DASH_STYLE_DASHDOT=3]="ANNO_LINE_DASH_STYLE_DASHDOT",t[t.ANNO_LINE_DASH_STYLE_DASHDOTDOT=4]="ANNO_LINE_DASH_STYLE_DASHDOTDOT",t[t.ANNO_LINE_DASH_STYLE_PATTERN=5]="ANNO_LINE_DASH_STYLE_PATTERN",t[t.ANNO_LINE_DASH_STYLE_DEFAULT=0]="ANNO_LINE_DASH_STYLE_DEFAULT"}(h||(e.AnnoLineDashStyle=h={})),function(t){t[t.ANNO_LINE_JOIN_STYLE_JOINMITER=0]="ANNO_LINE_JOIN_STYLE_JOINMITER",t[t.ANNO_LINE_JOIN_STYLE_JOINROUND=1]="ANNO_LINE_JOIN_STYLE_JOINROUND",t[t.ANNO_LINE_JOIN_STYLE_JOINBEVEL=2]="ANNO_LINE_JOIN_STYLE_JOINBEVEL",t[t.ANNO_LINE_JOIN_STYLE_MITERORBEVEL=3]="ANNO_LINE_JOIN_STYLE_MITERORBEVEL",t[t.ANNO_LINE_JOIN_STYLE_DEFAULT=1]="ANNO_LINE_JOIN_STYLE_DEFAULT"}(c||(e.AnnoLineJoinStyle=c={})),function(t){t[t.ANNO_LINE_CAP_STYLE_BUTT=0]="ANNO_LINE_CAP_STYLE_BUTT",t[t.ANNO_LINE_CAP_STYLE_CAPROUND=1]="ANNO_LINE_CAP_STYLE_CAPROUND",t[t.ANNO_LINE_CAP_STYLE_CAPSQUARE=2]="ANNO_LINE_CAP_STYLE_CAPSQUARE",t[t.ANNO_LINE_CAP_STYLE_CAPTRIANGLE=3]="ANNO_LINE_CAP_STYLE_CAPTRIANGLE",t[t.ANNO_LINE_CAP_STYLE_DEFAULT=1]="ANNO_LINE_CAP_STYLE_DEFAULT"}(u||(e.AnnoLineCapStyle=u={})),function(t){t[t.ANNO_OBJ_FLAG_NOTHING=0]="ANNO_OBJ_FLAG_NOTHING",t[t.ANNO_OBJ_FLAG_WITH_TRANSFORM=1]="ANNO_OBJ_FLAG_WITH_TRANSFORM",t[t.ANNO_OBJ_FLAG_WITH_LINE=2]="ANNO_OBJ_FLAG_WITH_LINE",t[t.ANNO_OBJ_FLAG_WITH_FILL=4]="ANNO_OBJ_FLAG_WITH_FILL",t[t.ANNO_OBJ_FLAG_WITH_TEXTFRAME=8]="ANNO_OBJ_FLAG_WITH_TEXTFRAME"}(l||(e.AnnoObjFlagMask=l={})),function(t){t[t.ANNO_ENCODE_TYPE_NONE=0]="ANNO_ENCODE_TYPE_NONE",t[t.ANNO_ENCODE_TYPE_BASE64=1]="ANNO_ENCODE_TYPE_BASE64",t[t.ANNO_ENCODE_TYPE_GZIP_BASE64=2]="ANNO_ENCODE_TYPE_GZIP_BASE64"}(d||(e.ANNO_ENCODE_TYPE=d={})),function(t){t.ADD_OBJECT="addObject",t.REMOVE_OBJECT="removeObject"}(f||(e.ANNO_MSG_TYPE=f={})),function(t){t[t.SELECT_MOUSE=0]="SELECT_MOUSE",t[t.SELECT_TOOL=1]="SELECT_TOOL",t[t.SELECT_ERASER=2]="SELECT_ERASER",t[t.UNDO=3]="UNDO",t[t.REDO=4]="REDO",t[t.CLEAR=5]="CLEAR",t[t.CLOSE_TOOL_BAR=6]="CLOSE_TOOL_BAR",t[t.UPDATE_PARAMS=7]="UPDATE_PARAMS",t[t.PAUSE_ANNOTATION=8]="PAUSE_ANNOTATION"}(p||(e.ANNOTATION_ACTTION_TYPE=p={})),function(t){t[t.ANNO_TOOL_TYPE_NONE=0]="ANNO_TOOL_TYPE_NONE",t[t.ANNO_TOOL_TYPE_PEN=1]="ANNO_TOOL_TYPE_PEN",t[t.ANNO_TOOL_TYPE_HIGHLIGHTER=2]="ANNO_TOOL_TYPE_HIGHLIGHTER",t[t.ANNO_TOOL_TYPE_SPOTLIGHT=3]="ANNO_TOOL_TYPE_SPOTLIGHT",t[t.ANNO_TOOL_TYPE_ARROW=4]="ANNO_TOOL_TYPE_ARROW",t[t.ANNO_TOOL_TYPE_TEXTBOX=5]="ANNO_TOOL_TYPE_TEXTBOX",t[t.ANNO_TOOL_TYPE_PICTURE=6]="ANNO_TOOL_TYPE_PICTURE",t[t.ANNO_TOOL_TYPE_ERASER=7]="ANNO_TOOL_TYPE_ERASER"}(g||(e.AnnoToolType=g={})),function(t){t[t.CLEAR_MINE=0]="CLEAR_MINE",t[t.CLEAR_VIEWER=1]="CLEAR_VIEWER",t[t.CLEAR_ALL=2]="CLEAR_ALL"}(v||(e.ANNOTATION_CLEAR_TYPE=v={})),function(t){t[t.ONACK=0]="ONACK",t[t.TOOL_SELECT=1]="TOOL_SELECT",t[t.ERASE_ALL=2]="ERASE_ALL",t[t.RESIZE=3]="RESIZE",t[t.REMOVE_OBJECTS=4]="REMOVE_OBJECTS",t[t.RESTORE_OBJECTS=5]="RESTORE_OBJECTS",t[t.TOOL_BAR_CLOSED=6]="TOOL_BAR_CLOSED",t[t.CHANGE_SESSION=7]="CHANGE_SESSION",t[t.UPDATE_CANVAS=8]="UPDATE_CANVAS",t[t.DESTROY_SESSION=9]="DESTROY_SESSION"}(_||(e.MSG_TO_WHITEBOARD_TYPE=_={})),e.DEFAULT_CAPTURE_FRAME_RATE=10,e.getDefaultAnnoObjHeader=function(){return{struSize:18,dataSize:18,objType:i.kNull,objFlag:e.NULL_NODE_ID,objId:e.NULL_NODE_ID}},e.getDefaultAnnoPduHeader=function(){return{struSize:22,dataSize:22,pduType:r.kNull,pduId:e.NULL_NODE_ID,appId:e.NULL_NODE_ID,pduTimeStamp:Date.now()}},e.getDefaultPduDocRequestDraw=function(){return{struSize:14,dataSize:14,requesterId:e.NULL_NODE_ID,docId:e.NULL_NODE_ID,requesterEngineVersion:e.ANNO_ENGINE_VERSION,requesterName:""}},e.getDefaultPduDocRequestDrawAck=function(){return{struSize:26,dataSize:26,requesterId:e.NULL_NODE_ID,composerId:e.NULL_NODE_ID,docId:e.NULL_NODE_ID,composerEngineVersion:e.NULL_NODE_ID,composerAckCode:o.UNKNOWN,docDpiScale:1,composerName:""}},e.getDefaultAnnoLineFormat=function(){return{struSize:10,dataSize:40,type:a.ANNO_LINE_FORMAT_TYPE_DEFAULT,annoLineData:{colorLine:{struSize:30,dataSize:30,dashStyle:h.ANNO_LINE_DASH_STYLE_DEFAULT,joinStyle:c.ANNO_LINE_JOIN_STYLE_DEFAULT,capStyle:u.ANNO_LINE_CAP_STYLE_DEFAULT,width:2,color:255,alpha:1}}}},e.getDefaultAnnoObjScribble=function(){return{struSize:6,dataSize:6,annoPoints:[]}},e.getDefaultAnnoPduPage=function(){return{struSize:14,dataSize:14,docId:e.NULL_NODE_ID,pageId:e.NULL_NODE_ID}},e.getDefaultAnnoPageState=function(){return{pageId:0,isErased:!1}},e.getDefaultTool=function(){return{toolType:g.ANNO_TOOL_TYPE_NONE,width:0,color:0,alpha:0}}},106:function(t,e,n){"use strict";function i(t){return t>>>10}function r(t){return t>>>8<<10|(t<<8>>>18)%1023}Object.defineProperty(e,"__esModule",{value:!0}),e.CAnnoReqId=e.CAnnoPduId=e.CAnnoObjId=e.CAnnoPageId=e.CAnnoDocId=e.CAnnoId=void 0;let s=0,o=0,a=0,h=0,c=0;class u{constructor(t){this._id=t}getId(){return this._id}setId(t){this._id=t}}e.CAnnoId=u;e.CAnnoDocId=class extends u{constructor(t){super(t)}acquireDocId(t){return s++,this._id=i(t)<<10|1023&s,this._id}amendDocId(t){return this._id=i(t)<<10|1023&this._id,this._id}};e.CAnnoPageId=class extends u{constructor(t){super(t)}acquirePageId(t){return o++,this._id=i(t)<<10|1023&o,this._id}amendDocId(t){return this._id=i(t)<<10|1023&this._id,this._id}};e.CAnnoObjId=class extends u{constructor(t){super(t)}acquireObjId(t){return a++,this._id=r(t)<<18|262143&a,this._id}amendDocId(t){return this._id=r(t)<<18|262143&this._id,this._id}};e.CAnnoPduId=class extends u{constructor(t){super(t)}acquirePduId(){return this._id=h++,this._id}};e.CAnnoReqId=class extends u{constructor(t){super(t)}acquirePduId(){return this._id=c++,this._id}}},107:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getCanvasScale=e.getShareSessionId=e.extractActionInfo=e.normalizePoints=e.getCanvasStyleSize=e.revertRGBValue=e.parseColorValue=e.annoLog=e.peekPduType=e.Base64toUInt8Array=e.UInt8Array2Base64=e.getDefaultAnnoData=e.skipUnrecognizedData=e.skipUnrecognizedStruct=e.overWriteDataSize=e.overWriteStructSize=e.CAnnoBuffer=void 0;const i=n(103);function r(t){const e=t.style;return{width:parseInt(e.width.substring(0,e.width.length-2)),height:parseInt(e.height.substring(0,e.height.length-2))}}e.CAnnoBuffer=class{constructor(t){this.mData=t?Array.from(t):[],this.currentPos=0}getSize(){return this.mData.length}writeInt8(t){this.mData.push(255&t),this.currentPos+=1}writeInt16(t){this.mData.push(255&t),this.mData.push(t>>>8&255),this.currentPos+=2}writeInt32(t){this.mData.push(255&t),this.mData.push(t>>>8&255),this.mData.push(t>>>16&255),this.mData.push(t>>>24&255),this.currentPos+=4}writeInt16At(t,e){this.mData[t]=255&e,this.mData[t+1]=e>>>8&255}writeInt32At(t,e){this.mData[t]=255&e,this.mData[t+1]=e>>>8&255,this.mData[t+2]=e>>>16&255,this.mData[t+3]=e>>>24&255}writeFloat32(t){const e=new DataView(new ArrayBuffer(4));e.setFloat32(0,t,!0);const n=new Uint8Array(e.buffer);for(let t=0;t<4;t++)this.mData.push(n[t]);this.currentPos+=4}writeString(t){const e=t.length;this.writeInt32(e);for(let n=0;n<e;n++)this.writeInt16(t.charCodeAt(n))}readInt8(){const t=this.currentPos;if(t>=this.mData.length)return 0;const e=this.mData[t];return this.currentPos+=1,e}readInt16(){const t=this.currentPos;if(t+1>=this.mData.length)return 0;const e=this.mData[t]|this.mData[t+1]<<8;return this.currentPos+=2,e}readInt32(){const t=this.currentPos;if(t+3>=this.mData.length)return 0;const e=this.mData[t]|this.mData[t+1]<<8|this.mData[t+2]<<16|this.mData[t+3]<<24;return this.currentPos+=4,e}readString(){const t=this.readInt32();let e="";for(let n=0;n<t&&n<this.mData.length;n++)e+=String.fromCharCode(this.readInt16());return e}readFloat32(){if(this.currentPos+3>=this.mData.length)return 0;const t=this.mData.slice(this.currentPos,this.currentPos+4),e=new DataView(new Uint8Array(t).buffer);return this.currentPos+=4,e.getFloat32(0)}toInt8Array(){return new Uint8Array(this.mData)}tell(){return this.currentPos}seek(t){this.currentPos=this.mData.length>t?t:this.mData.length-1}},e.overWriteStructSize=function(t,e,n){const i=t.tell();n.struSize!=i-e&&(n.struSize=i-e,t.writeInt16At(e,n.struSize))},e.overWriteDataSize=function(t,e,n){const i=t.tell();n.dataSize!=i-e&&(n.dataSize=i-e,t.writeInt32At(e+2,n.dataSize))},e.skipUnrecognizedStruct=function(t,e,n){t.tell()-e<n.struSize&&t.seek(e+n.struSize)},e.skipUnrecognizedData=function(t,e,n){t.tell()-e<n.dataSize&&t.seek(e+n.dataSize)},e.getDefaultAnnoData=function(t,e,n,r){return{dnSource:i.AnnoDnSource.FROM_LOCAL,appId:t||i.NULL_NODE_ID,userName:e||"",docId:n||i.NULL_NODE_ID,pageId:r||i.NULL_NODE_ID,annoObjIds:new Array}},e.UInt8Array2Base64=function(t){let e=[];for(let n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return btoa(e.join(""))},e.Base64toUInt8Array=function(t){return Uint8Array.from(atob(t),t=>t.charCodeAt(0))},e.peekPduType=function(t){t.seek(6);const e=t.readInt32();return t.seek(0),e},e.parseColorValue=function(t){const e=t.slice(1);return 6!==e.length?255:parseInt(e.substring(0,2),16)+(parseInt(e.substring(2,4),16)<<8)+(parseInt(e.substring(4,6),16)<<16)},e.revertRGBValue=function(t){return t>>>16&255|(t>>>8&255)<<8|(255&t)<<16},e.getCanvasStyleSize=r,e.normalizePoints=function(t,e){const n=[];return t.forEach(t=>{n.push({x:t.x,y:t.y})}),n},e.getCanvasScale=function(t){const e=r(t),{width:n,height:i}=t,{width:s,height:o}=e;return Object.assign(Object.assign({},e),{scale:{x:s/n,y:o/i}})},e.extractActionInfo=function(t,e){return{pduType:e,appId:t.appId||i.NULL_NODE_ID,docId:t.docId||i.NULL_NODE_ID,pageId:t.pageId||i.NULL_NODE_ID,annoObjIds:t.annoObjIds||[],whiteboardObjIds:t.whiteboardObjIds||[]}},e.getShareSessionId=function(t){return t},e.annoLog=function(t){console.log("Annotation Log ==> "+t.toString())}},110:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CAnnoDoc=e.CAnnoObjSmoothPen=e.CAnnoObj=e.CAnnoLineFormat=e.CAnnoFormat=e.CAnnoObjScribble=e.getDefaultAnnoPduObj=void 0;const i=n(106),r=n(107),s=n(103);e.getDefaultAnnoPduObj=function(){return{struSize:14,dataSize:14,docId:s.NULL_NODE_ID,pageId:s.NULL_NODE_ID}};class o{constructor(){this.annoObjScribble=(0,s.getDefaultAnnoObjScribble)()}pack(t){const e=t.tell(),n=this.annoObjScribble.annoPoints.length;if(t.writeInt16(this.annoObjScribble.struSize),t.writeInt32(this.annoObjScribble.dataSize),n>0){t.writeInt32(n);for(let e=0;e<n;e++)t.writeInt32(this.annoObjScribble.annoPoints[e].x),t.writeInt32(this.annoObjScribble.annoPoints[e].y)}(0,r.overWriteDataSize)(t,e,this.annoObjScribble)}setData(t){this.annoObjScribble.annoPoints=t}}e.CAnnoObjScribble=o;class a{constructor(){}pack(t){}unpack(){}}e.CAnnoFormat=a;class h extends a{constructor(t){super(),this.annoLineFormat=(0,s.getDefaultAnnoLineFormat)(),t&&(t.type in s.AnnoLineFormatType&&(this.annoLineFormat.type=t.type),t.lineData&&(this.annoLineFormat.annoLineData.colorLine.width=t.lineData.width,this.annoLineFormat.annoLineData.colorLine.color=(0,r.revertRGBValue)(t.lineData.color)))}pack(t){super.pack(t);const e=t.tell();switch(t.writeInt16(this.annoLineFormat.struSize),t.writeInt32(this.annoLineFormat.dataSize),t.writeInt32(this.annoLineFormat.type),this.annoLineFormat.type){case s.AnnoLineFormatType.ANNO_LINE_FORMAT_TYPE_NONE:break;case s.AnnoLineFormatType.ANNO_LINE_FORMAT_TYPE_DEFAULT:{const e=t.tell();t.writeInt16(this.annoLineFormat.annoLineData.colorLine.struSize),t.writeInt32(this.annoLineFormat.annoLineData.colorLine.dataSize),t.writeInt32(this.annoLineFormat.annoLineData.colorLine.dashStyle),t.writeInt32(this.annoLineFormat.annoLineData.colorLine.joinStyle),t.writeInt32(this.annoLineFormat.annoLineData.colorLine.capStyle),t.writeInt32(this.annoLineFormat.annoLineData.colorLine.width),t.writeInt32(this.annoLineFormat.annoLineData.colorLine.color),t.writeFloat32(this.annoLineFormat.annoLineData.colorLine.alpha),(0,r.overWriteDataSize)(t,e,this.annoLineFormat.annoLineData.colorLine);break}}(0,r.overWriteDataSize)(t,e,this.annoLineFormat)}}e.CAnnoLineFormat=h;class c extends i.CAnnoObjId{constructor(t){super(s.NULL_NODE_ID),this.annoObjHeader=(0,s.getDefaultAnnoObjHeader)(),this.annoObjHeader.objType=t,this.annoObjHeader.objFlag=2,this.annoLineFormat=null,this.appId=s.NULL_NODE_ID,this.docId=s.NULL_NODE_ID,this.pageId=s.NULL_NODE_ID}pack(t){var e;this.annoObjHeader.objId=this.getId();const n=t.tell();t.writeInt16(this.annoObjHeader.struSize),t.writeInt32(this.annoObjHeader.dataSize),t.writeInt32(this.annoObjHeader.objType),t.writeInt32(this.annoObjHeader.objFlag),t.writeInt32(this.annoObjHeader.objId),this.annoObjHeader.objFlag&s.AnnoObjFlagMask.ANNO_OBJ_FLAG_WITH_LINE&&(null===(e=this.annoLineFormat)||void 0===e||e.pack(t)),(0,r.overWriteDataSize)(t,n,this.annoObjHeader)}packIds(t){t.writeInt32(1),t.writeInt32(this.getId())}setObjHeader(t){this.annoObjHeader.objId=t.objectId}setLineFormat(t){const e=new h(t);this.annoLineFormat=e}makeCopy(){const t=new c(this.annoObjHeader.objType);return t.setObjHeader({objectId:this.annoObjHeader.objId}),t.setLineFormat(this.annoLineFormat.annoLineFormat),t}setData(t){}}e.CAnnoObj=c;e.CAnnoObjSmoothPen=class extends c{constructor(){super(s.AnnoObjType.kSmoothPen),this.annoObjScribble=new o}pack(t){super.pack(t),this.annoObjScribble.pack(t)}setData(t){this.annoObjScribble.setData(t)}};class u extends i.CAnnoDocId{constructor(t){super(t.appId),this.appId=t.appId,this.isPresenter=t.isPresenter,this.userName=t.userName,this.preseterId=t.preseterId}handlePageSync(t,e){this.setId(t),this.currentPageId=e}getPageId(){return this.currentPageId}}e.CAnnoDoc=u},111:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.parsePdu=e.CAnnoPduRestoreUserObj=e.CAnnoPduRemoveUserObj=e.CAnnoPduUserObj=e.CAnnoPduRestoreAllObjByHost=e.CAnnoPduRemoveAllObjByHost=e.CAnnoPduRestoreAllObj=e.CAnnoPduRemoveAllObj=e.CAnnoPduRestoreObj=e.CAnnoPduRemoveObj=e.CAnnoPduObjIds=e.CAnnoPduAddObjAck=e.CAnnoPduAddObj=e.CAnnoPduObj=e.CAnnoPduSyncPage=e.CAnnoPduDocRequestDrawAck=e.CAnnoPduDocRequestDraw=e.CAnnoPdu=void 0;const o=n(106),a=n(107),h=s(n(103)),c=n(110);class u extends o.CAnnoPduId{constructor(t,e,n){super(h.NULL_NODE_ID),this.annoPduHeader=h.getDefaultAnnoPduHeader(),this.annoPduHeader.pduType=t,n?this.data=n:(this.annoPduHeader.pduId=this.acquirePduId(),this.annoPduHeader.pduTimeStamp=Date.now(),this.data=new a.CAnnoBuffer(null))}pack(){this.data.writeInt16(this.annoPduHeader.struSize),this.data.writeInt32(this.annoPduHeader.dataSize),this.data.writeInt32(this.annoPduHeader.pduType),this.data.writeInt32(this.annoPduHeader.pduId),this.data.writeInt32(this.annoPduHeader.appId),this.data.writeInt32(this.annoPduHeader.pduTimeStamp)}unpack(){const t=this.data.tell();this.annoPduHeader.struSize=this.data.readInt16(),this.annoPduHeader.dataSize=this.data.readInt32(),this.annoPduHeader.pduType=this.data.readInt32(),this.annoPduHeader.pduId=this.data.readInt32(),this.annoPduHeader.appId=this.data.readInt32(),this.annoPduHeader.pduTimeStamp=this.data.readInt32(),(0,a.skipUnrecognizedStruct)(this.data,t,this.annoPduHeader.struSize),(0,a.skipUnrecognizedData)(this.data,t,this.annoPduHeader.dataSize)}getPduType(){return this.annoPduHeader.pduType||h.AnnoPduType.kNull}toInt8Array(){return this.data.toInt8Array()}}e.CAnnoPdu=u;e.CAnnoPduDocRequestDraw=class extends u{constructor(t,e,n){super(t,e,n),e&&(this.annoPduDocRequestDraw=h.getDefaultPduDocRequestDraw(),this.annoPduHeader.appId=e.appId,this.annoPduDocRequestDraw.requesterId=e.appId,this.annoPduDocRequestDraw.docId=e.docId,this.annoPduDocRequestDraw.requesterName=e.userName,this.pack()),n&&(this.data=n,this.unpack())}pack(){super.pack();const t=this.data.tell();this.data.writeInt16(this.annoPduDocRequestDraw.struSize),this.data.writeInt32(this.annoPduDocRequestDraw.dataSize),this.data.writeInt32(this.annoPduDocRequestDraw.docId),this.data.writeInt32(this.annoPduDocRequestDraw.requesterEngineVersion),(0,a.overWriteStructSize)(this.data,t,this.annoPduDocRequestDraw),this.data.writeString(this.annoPduDocRequestDraw.requesterName),(0,a.overWriteDataSize)(this.data,t,this.annoPduDocRequestDraw)}unpack(){}};class l extends u{constructor(t,e,n){super(t,e,n),this.annoPduDocRequestDrawAck=h.getDefaultPduDocRequestDrawAck(),e?(this.annoPduHeader.appId=e.appId,this.annoPduDocRequestDrawAck.requesterId=e.ackRequesterId||0,this.annoPduDocRequestDrawAck.composerId=e.appId,this.annoPduDocRequestDrawAck.docId=e.docId,this.annoPduDocRequestDrawAck.composerEngineVersion=h.ANNO_ENGINE_VERSION,this.annoPduDocRequestDrawAck.composerAckCode=e.docRequestDrawAckCode||0,this.annoPduDocRequestDrawAck.docDpiScale=1,this.annoPduDocRequestDrawAck.composerName=e.userName,this.pack()):n&&(this.data=n,this.unpack())}pack(){super.pack();const t=this.data.tell();this.data.writeInt16(this.annoPduDocRequestDrawAck.struSize),this.data.writeInt32(this.annoPduDocRequestDrawAck.dataSize),this.data.writeInt32(this.annoPduDocRequestDrawAck.requesterId),this.data.writeInt32(this.annoPduDocRequestDrawAck.docId),this.data.writeInt32(this.annoPduDocRequestDrawAck.composerEngineVersion),this.data.writeInt32(this.annoPduDocRequestDrawAck.composerAckCode),this.data.writeFloat32(this.annoPduDocRequestDrawAck.docDpiScale),this.data.writeString(this.annoPduDocRequestDrawAck.composerName),(0,a.overWriteDataSize)(this.data,t,this.annoPduDocRequestDrawAck)}unpack(){super.unpack();const t=this.data.tell();this.annoPduDocRequestDrawAck.struSize=this.data.readInt16(),this.annoPduDocRequestDrawAck.dataSize=this.data.readInt32(),this.annoPduDocRequestDrawAck.requesterId=this.data.readInt32(),this.annoPduDocRequestDrawAck.docId=this.data.readInt32(),this.annoPduDocRequestDrawAck.composerEngineVersion=this.data.readInt32(),this.annoPduDocRequestDrawAck.composerAckCode=this.data.readInt32(),this.annoPduDocRequestDrawAck.docDpiScale=this.data.readFloat32(),(0,a.skipUnrecognizedStruct)(this.data,t,this.annoPduDocRequestDrawAck),this.annoPduDocRequestDrawAck.composerName=this.data.readString(),(0,a.skipUnrecognizedData)(this.data,t,this.annoPduDocRequestDrawAck)}toInt8Array(){return this.data.toInt8Array()}}e.CAnnoPduDocRequestDrawAck=l;class d extends u{constructor(t,e,n){super(t,e,n),this.annoPduPage=h.getDefaultAnnoPduPage(),e?(this.annoPduHeader.appId=e.appId,this.annoPduPage.docId=e.appId,this.annoPduPage.pageId=e.pageId,this.pack()):n&&(this.data=n,this.unpack())}pack(){super.pack();const t=this.data.tell();this.data.writeInt16(this.annoPduPage.struSize),this.data.writeInt32(this.annoPduPage.dataSize),this.data.writeInt32(this.annoPduPage.docId),this.data.writeInt32(this.annoPduPage.pageId),(0,a.overWriteStructSize)(this.data,t,this.annoPduPage),(0,a.overWriteDataSize)(this.data,t,this.annoPduPage)}unpack(){super.unpack();const t=this.data.tell();this.annoPduPage.struSize=this.data.readInt16(),this.annoPduPage.dataSize=this.data.readInt32(),this.annoPduPage.docId=this.data.readInt32(),this.annoPduPage.pageId=this.data.readInt32(),(0,a.skipUnrecognizedStruct)(this.data,t,this.annoPduPage);const e=this.data.readInt32();if(e>0){this.annoPageStates=[];for(let t=0;t<e;t++){const t=h.getDefaultAnnoPageState();t.pageId=this.data.readInt32(),t.isErased=!!this.data.readInt8(),t.pageName=this.data.readString(),this.annoPageStates.push(t)}}(0,a.skipUnrecognizedData)(this.data,t,this.annoPduPage)}}e.CAnnoPduSyncPage=d;class f extends u{constructor(t,e,n){super(t,e,n),this.annoPduObj=(0,c.getDefaultAnnoPduObj)(),e&&(this.annoPduHeader.appId=e.appId,this.annoPduObj.docId=e.docId,this.annoPduObj.pageId=e.pageId,e.annoObj&&(this.annoPduObj.annoObj=e.annoObj),e.annoObjIds&&(this.annoPduObj.annoObjIds=e.annoObjIds))}getHeader(){return this.annoPduHeader}}e.CAnnoPduObj=f;e.CAnnoPduAddObj=class extends f{constructor(t,e,n){super(t,e,n),e?this.pack():n&&this.unpack()}pack(){super.pack();const t=this.data.tell();this.data.writeInt16(this.annoPduObj.struSize),this.data.writeInt32(this.annoPduObj.dataSize),this.data.writeInt32(this.annoPduObj.docId),this.data.writeInt32(this.annoPduObj.pageId),this.annoPduObj.annoObj&&this.annoPduObj.annoObj.pack(this.data),(0,a.overWriteDataSize)(this.data,t,this.annoPduObj)}unpack(){}};class p extends f{constructor(t,e,n){super(t,e,n),e?(this.timeStampOfRequest=e.timeStampOfAckRequest,this.captureFrameRate=e.captureFrameRate||h.DEFAULT_CAPTURE_FRAME_RATE,this.pack()):n&&this.unpack()}pack(){super.pack(),this.annoPduObj.struSize+=5,this.annoPduObj.dataSize=this.annoPduObj.struSize;const t=this.data.tell();this.data.writeInt16(this.annoPduObj.struSize),this.data.writeInt32(this.annoPduObj.dataSize),this.data.writeInt32(this.annoPduObj.docId),this.data.writeInt32(this.annoPduObj.pageId),this.data.writeInt32(this.timeStampOfRequest),this.data.writeInt8(this.captureFrameRate),this.annoPduObj.annoObj?this.annoPduObj.annoObj.packIds(this.data):this.data.writeInt32(0),(0,a.overWriteDataSize)(this.data,t,this.annoPduObj)}unpack(){super.unpack();const t=this.data.tell();this.annoPduObj.struSize=this.data.readInt16(),this.annoPduObj.dataSize=this.data.readInt32(),this.annoPduObj.docId=this.data.readInt32(),this.annoPduObj.pageId=this.data.readInt32(),this.timeStampOfRequest=this.data.readInt32(),this.captureFrameRate=this.data.readInt8(),(0,a.skipUnrecognizedStruct)(this.data,t,this.annoPduObj);const e=this.data.readInt32();if(e>0){this.annoPduObj.annoObjIds=this.annoPduObj.annoObjIds||[];for(let t=0;t<e;t++)this.annoPduObj.annoObjIds.push(this.data.readInt32())}(0,a.skipUnrecognizedData)(this.data,t,this.annoPduObj)}}e.CAnnoPduAddObjAck=p;class g extends f{constructor(t,e,n){super(t,e,n),e?this.pack():n&&this.unpack()}pack(){super.pack();const t=this.data.tell();if(this.data.writeInt16(this.annoPduObj.struSize),this.data.writeInt32(this.annoPduObj.dataSize),this.data.writeInt32(this.annoPduObj.docId),this.data.writeInt32(this.annoPduObj.pageId),this.annoPduObj.annoObjIds){const t=this.annoPduObj.annoObjIds.length;this.data.writeInt32(t);for(let e=0;e<t;e++)this.data.writeInt32(this.annoPduObj.annoObjIds[e])}else this.data.writeInt32(0);(0,a.overWriteDataSize)(this.data,t,this.annoPduObj)}unpack(){super.unpack();const t=this.data.tell();this.annoPduObj.struSize=this.data.readInt16(),this.annoPduObj.dataSize=this.data.readInt32(),this.annoPduObj.docId=this.data.readInt32(),this.annoPduObj.pageId=this.data.readInt32(),(0,a.skipUnrecognizedStruct)(this.data,t,this.annoPduObj);const e=this.data.readInt32();if(e>0){this.annoPduObj.annoObjIds=this.annoPduObj.annoObjIds||[];for(let t=0;t<e;t++)this.annoPduObj.annoObjIds.push(this.data.readInt32())}(0,a.skipUnrecognizedData)(this.data,t,this.annoPduObj)}}e.CAnnoPduObjIds=g;e.CAnnoPduRemoveObj=class extends g{constructor(t,e,n){super(t,e,n)}pack(){super.pack()}unpack(){super.unpack()}};e.CAnnoPduRestoreObj=class extends g{constructor(t,e,n){super(t,e,n)}pack(){super.pack()}unpack(){super.unpack()}};e.CAnnoPduRemoveAllObj=class extends g{constructor(t,e,n){super(t,e,n)}pack(){super.pack()}unpack(){super.unpack()}};e.CAnnoPduRestoreAllObj=class extends g{constructor(t,e,n){super(t,e,n)}pack(){super.pack()}unpack(){super.unpack()}};e.CAnnoPduRemoveAllObjByHost=class extends g{constructor(t,e,n){super(t,e,n)}pack(){super.pack()}unpack(){super.unpack()}};e.CAnnoPduRestoreAllObjByHost=class extends g{constructor(t,e,n){super(t,e,n)}pack(){super.pack()}unpack(){super.unpack()}};class v extends f{constructor(t,e,n){super(t,e,n),e?this.pack():n&&this.unpack()}pack(){super.pack();const t=this.data.tell();if(this.data.writeInt16(this.annoPduObj.struSize),this.data.writeInt32(this.annoPduObj.dataSize),this.data.writeInt32(this.annoPduObj.docId),this.data.writeInt32(this.annoPduObj.pageId),this.annoPduObj.annoObjIds){const t=this.annoPduObj.annoObjIds.length;this.data.writeInt32(t);for(let e=0;e<t;e++)this.data.writeInt32(this.annoPduObj.annoObjIds[e])}else this.data.writeInt32(0);(0,a.overWriteDataSize)(this.data,t,this.annoPduObj)}unpack(){super.unpack();const t=this.data.tell();this.annoPduObj.struSize=this.data.readInt16(),this.annoPduObj.dataSize=this.data.readInt32(),this.annoPduObj.docId=this.data.readInt32(),this.annoPduObj.pageId=this.data.readInt32(),(0,a.skipUnrecognizedStruct)(this.data,t,this.annoPduObj);const e=this.data.readInt32();if(e>0){this.annoPduObj.annoObjIds=this.annoPduObj.annoObjIds||[];for(let t=0;t<e;t++)this.annoPduObj.annoObjIds.push(this.data.readInt32())}(0,a.skipUnrecognizedData)(this.data,t,this.annoPduObj)}}e.CAnnoPduUserObj=v;e.CAnnoPduRemoveUserObj=class extends v{constructor(t,e,n){super(t,e,n)}pack(){super.pack()}unpack(){super.unpack()}};e.CAnnoPduRestoreUserObj=class extends v{constructor(t,e,n){super(t,e,n)}pack(){super.pack()}unpack(){super.unpack()}},e.parsePdu=function(t){const e=new a.CAnnoBuffer(t.subarray(8)),n=(0,a.peekPduType)(e);switch(n){case h.AnnoPduType.kDocRequestDrawAck:return new l(n,void 0,e);case h.AnnoPduType.kPageSync:return new d(n,void 0,e);case h.AnnoPduType.kAnnoObjAddAck:return new p(n,void 0,e)}return null}},115:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"MSG_TO_WHITEBOARD_TYPE",(function(){return Q})),n.d(e,"TOOL_TYPE",(function(){return Z})),n.d(e,"default",(function(){return $}));var i=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,c=(t,e,n)=>e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,u=(t,e)=>{for(var n in e||(e={}))a.call(e,n)&&c(t,n,e[n]);if(o)for(var n of o(e))h.call(e,n)&&c(t,n,e[n]);return t},l=(t,e,n)=>c(t,"symbol"!=typeof e?e+"":e,n)
/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */;const d={version:"4.6.0"},f={fabric:d};var p,g,v,_,b,m;typeof document<"u"&&typeof window<"u"&&(document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?d.document=document:d.document=document.implementation.createHTMLDocument(""),d.window=window),d.isTouchSupported="ontouchstart"in d.window||"ontouchstart"in d.document||d.window&&d.window.navigator&&d.window.navigator.maxTouchPoints>0,d.isLikelyNode=typeof t<"u"&&typeof window>"u",d.DPI=96,d.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",d.commaWsp="(?:\\s+,?\\s*|,\\s*)",d.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,d.reNonWord=/[ \n\.,;!\?\-]/,d.fontPaths={},d.iMatrix=[1,0,0,1,0,0],d.svgNS="http://www.w3.org/2000/svg",d.perfLimitSizeTotal=2097152,d.maxCacheSideLimit=4096,d.minCacheSideLimit=256,d.charWidthsCache={},d.textureSize=2048,d.disableStyleCopyPaste=!1,d.enableGLFiltering=!0,d.devicePixelRatio=d.window.devicePixelRatio||d.window.webkitDevicePixelRatio||d.window.mozDevicePixelRatio||1,d.browserShadowBlurConstant=1,d.arcToSegmentsCache={},d.boundsOfCurveCache={},d.cachesBoundsOfCurve=!0,d.forceGLPutImageData=!1,d.initFilterBackend=function(){return d.enableGLFiltering&&d.isWebglSupported&&d.isWebglSupported(d.textureSize)?(console.log("max texture size: "+d.maxTextureSize),new d.WebglFilterBackend({tileSize:d.textureSize})):d.Canvas2dFilterBackend?new d.Canvas2dFilterBackend:void 0},typeof document<"u"&&typeof window<"u"&&(window.fabric=d),function(){function t(t,e){if(this.__eventListeners[t]){var n=this.__eventListeners[t];e?n[n.indexOf(e)]=!1:d.util.array.fill(n,!1)}}function e(t,e){var n=function(){e.apply(this,arguments),this.off(t,n)}.bind(this);this.on(t,n)}d.Observable={fire:function(t,e){if(!this.__eventListeners)return this;var n=this.__eventListeners[t];if(!n)return this;for(var i=0,r=n.length;i<r;i++)n[i]&&n[i].call(this,e||{});return this.__eventListeners[t]=n.filter((function(t){return!1!==t})),this},on:function(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var n in t)this.on(n,t[n]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this},once:function(t,n){if(1===arguments.length)for(var i in t)e.call(this,i,t[i]);else e.call(this,t,n);return this},off:function(e,n){if(!this.__eventListeners)return this;if(0===arguments.length)for(e in this.__eventListeners)t.call(this,e);else if(1===arguments.length&&"object"==typeof arguments[0])for(var i in e)t.call(this,i,e[i]);else t.call(this,e,n);return this}}}(),d.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,n){var i=this._objects;return n?i[e]=t:i.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t,e=this._objects,n=!1,i=0,r=arguments.length;i<r;i++)-1!==(t=e.indexOf(arguments[i]))&&(n=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&n&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var n=this.getObjects(),i=0,r=n.length;i<r;i++)t.call(e,n[i],i,n);return this},getObjects:function(t){return typeof t>"u"?this._objects.concat():this._objects.filter((function(e){return e.type===t}))},item:function(t){return this._objects[t]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(t,e){return this._objects.indexOf(t)>-1||!!e&&this._objects.some((function(e){return"function"==typeof e.contains&&e.contains(t,!0)}))},complexity:function(){return this._objects.reduce((function(t,e){return t+=e.complexity?e.complexity():0}),0)}},d.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){t&&t.colorStops&&!(t instanceof d.Gradient)&&this.set(e,new d.Gradient(t))},_initPattern:function(t,e,n){!t||!t.source||t instanceof d.Pattern?n&&n():this.set(e,new d.Pattern(t,n))},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},get:function(t){return this[t]}},p=typeof f<"u"?f:void 0,g=Math.sqrt,v=Math.atan2,_=Math.pow,b=Math.PI/180,m=Math.PI/2,d.util={cos:function(t){if(0===t)return 1;switch(t<0&&(t=-t),t/m){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},sin:function(t){if(0===t)return 0;var e=1;switch(t<0&&(e=-1),t/m){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(t)},removeFromArray:function(t,e){var n=t.indexOf(e);return-1!==n&&t.splice(n,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*b},radiansToDegrees:function(t){return t/b},rotatePoint:function(t,e,n){var i=new d.Point(t.x-e.x,t.y-e.y),r=d.util.rotateVector(i,n);return new d.Point(r.x,r.y).addEquals(e)},rotateVector:function(t,e){var n=d.util.sin(e),i=d.util.cos(e);return{x:t.x*i-t.y*n,y:t.x*n+t.y*i}},transformPoint:function(t,e,n){return n?new d.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new d.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},makeBoundingBoxFromPoints:function(t,e){if(e)for(var n=0;n<t.length;n++)t[n]=d.util.transformPoint(t[n],e);var i=[t[0].x,t[1].x,t[2].x,t[3].x],r=d.util.array.min(i),s=d.util.array.max(i)-r,o=[t[0].y,t[1].y,t[2].y,t[3].y],a=d.util.array.min(o);return{left:r,top:a,width:s,height:d.util.array.max(o)-a}},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),n=[e*t[3],-e*t[1],-e*t[2],e*t[0]],i=d.util.transformPoint({x:t[4],y:t[5]},n,!0);return n[4]=-i.x,n[5]=-i.y,n},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var n=/\D{0,2}$/.exec(t),i=parseFloat(t);switch(e||(e=d.Text.DEFAULT_SVG_FONT_SIZE),n[0]){case"mm":return i*d.DPI/25.4;case"cm":return i*d.DPI/2.54;case"in":return i*d.DPI;case"pt":return i*d.DPI/72;case"pc":return i*d.DPI/72*12;case"em":return i*e;default:return i}},falseFunction:function(){return!1},getKlass:function(t,e){return t=d.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),d.util.resolveNamespace(e)[t]},getSvgAttributes:function(t){var e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":e=e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":e=e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":e=e.concat(["offset","stop-color","stop-opacity"])}return e},resolveNamespace:function(t){if(!t)return d;var e,n=t.split("."),i=n.length,r=p||d.window;for(e=0;e<i;++e)r=r[n[e]];return r},loadImage:function(t,e,n,i){if(t){var r=d.util.createImage(),s=function(){e&&e.call(n,r,!1),r=r.onload=r.onerror=null};r.onload=s,r.onerror=function(){d.log("Error loading "+r.src),e&&e.call(n,null,!0),r=r.onload=r.onerror=null},0!==t.indexOf("data")&&null!=i&&(r.crossOrigin=i),"data:image/svg"===t.substring(0,14)&&(r.onload=null,d.util.loadImageInDom(r,s)),r.src=t}else e&&e.call(n,t)},loadImageInDom:function(t,e){var n=d.document.createElement("div");n.style.width=n.style.height="1px",n.style.left=n.style.top="-100%",n.style.position="absolute",n.appendChild(t),d.document.querySelector("body").appendChild(n),t.onload=function(){e(),n.parentNode.removeChild(n),n=null}},enlivenObjects:function(t,e,n,i){var r=[],s=0,o=(t=t||[]).length;function a(){++s===o&&e&&e(r.filter((function(t){return t})))}o?t.forEach((function(t,e){t&&t.type?d.util.getKlass(t.type,n).fromObject(t,(function(n,s){s||(r[e]=n),i&&i(t,n,s),a()})):a()})):e&&e(r)},enlivenPatterns:function(t,e){function n(){++r===s&&e&&e(i)}var i=[],r=0,s=(t=t||[]).length;s?t.forEach((function(t,e){t&&t.source?new d.Pattern(t,(function(t){i[e]=t,n()})):(i[e]=t,n())})):e&&e(i)},groupSVGElements:function(t,e,n){var i;return t&&1===t.length?t[0]:(e&&(e.width&&e.height?e.centerPoint={x:e.width/2,y:e.height/2}:(delete e.width,delete e.height)),i=new d.Group(t,e),typeof n<"u"&&(i.sourcePath=n),i)},populateWithProperties:function(t,e,n){if(n&&"[object Array]"===Object.prototype.toString.call(n))for(var i=0,r=n.length;i<r;i++)n[i]in t&&(e[n[i]]=t[n[i]])},drawDashedLine:function(t,e,n,i,r,s){var o=i-e,a=r-n,h=g(o*o+a*a),c=v(a,o),u=s.length,l=0,d=!0;for(t.save(),t.translate(e,n),t.moveTo(0,0),t.rotate(c),e=0;h>e;)(e+=s[l++%u])>h&&(e=h),t[d?"lineTo":"moveTo"](e,0),d=!d;t.restore()},createCanvasElement:function(){return d.document.createElement("canvas")},copyCanvasElement:function(t){var e=d.util.createCanvasElement();return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e},toDataURL:function(t,e,n){return t.toDataURL("image/"+e,n)},createImage:function(){return d.document.createElement("img")},multiplyTransformMatrices:function(t,e,n){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],n?0:t[0]*e[4]+t[2]*e[5]+t[4],n?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(t){var e=v(t[1],t[0]),n=_(t[0],2)+_(t[1],2),i=g(n),r=(t[0]*t[3]-t[2]*t[1])/i,s=v(t[0]*t[2]+t[1]*t[3],n);return{angle:e/b,scaleX:i,scaleY:r,skewX:s/b,skewY:0,translateX:t[4],translateY:t[5]}},calcRotateMatrix:function(t){if(!t.angle)return d.iMatrix.concat();var e=d.util.degreesToRadians(t.angle),n=d.util.cos(e),i=d.util.sin(e);return[n,i,-i,n,0,0]},calcDimensionsMatrix:function(t){var e=typeof t.scaleX>"u"?1:t.scaleX,n=typeof t.scaleY>"u"?1:t.scaleY,i=[t.flipX?-e:e,0,0,t.flipY?-n:n,0,0],r=d.util.multiplyTransformMatrices,s=d.util.degreesToRadians;return t.skewX&&(i=r(i,[1,0,Math.tan(s(t.skewX)),1],!0)),t.skewY&&(i=r(i,[1,Math.tan(s(t.skewY)),0,1],!0)),i},composeMatrix:function(t){var e=[1,0,0,1,t.translateX||0,t.translateY||0],n=d.util.multiplyTransformMatrices;return t.angle&&(e=n(e,d.util.calcRotateMatrix(t))),(1!==t.scaleX||1!==t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY)&&(e=n(e,d.util.calcDimensionsMatrix(t))),e},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},saveObjectTransform:function(t){return{scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}},isTransparent:function(t,e,n,i){i>0&&(e>i?e-=i:e=0,n>i?n-=i:n=0);var r,s=!0,o=t.getImageData(e,n,2*i||1,2*i||1),a=o.data.length;for(r=3;r<a&&!1!=(s=o.data[r]<=0);r+=4);return o=null,s},parsePreserveAspectRatioAttribute:function(t){var e,n="meet",i=t.split(" ");return i&&i.length&&("meet"!==(n=i.pop())&&"slice"!==n?(e=n,n="meet"):i.length&&(e=i.pop())),{meetOrSlice:n,alignX:"none"!==e?e.slice(1,4):"none",alignY:"none"!==e?e.slice(5,8):"none"}},clearFabricFontCache:function(t){(t=(t||"").toLowerCase())?d.charWidthsCache[t]&&delete d.charWidthsCache[t]:d.charWidthsCache={}},limitDimsByArea:function(t,e){var n=Math.sqrt(e*t),i=Math.floor(e/n);return{x:Math.floor(n),y:i}},capValue:function(t,e,n){return Math.max(t,Math.min(e,n))},findScaleToFit:function(t,e){return Math.min(e.width/t.width,e.height/t.height)},findScaleToCover:function(t,e){return Math.max(e.width/t.width,e.height/t.height)},matrixToSVG:function(t){return"matrix("+t.map((function(t){return d.util.toFixed(t,d.Object.NUM_FRACTION_DIGITS)})).join(" ")+")"},removeTransformFromObject:function(t,e){var n=d.util.invertTransform(e),i=d.util.multiplyTransformMatrices(n,t.calcOwnMatrix());d.util.applyTransformToObject(t,i)},addTransformToObject:function(t,e){d.util.applyTransformToObject(t,d.util.multiplyTransformMatrices(e,t.calcOwnMatrix()))},applyTransformToObject:function(t,e){var n=d.util.qrDecompose(e),i=new d.Point(n.translateX,n.translateY);t.flipX=!1,t.flipY=!1,t.set("scaleX",n.scaleX),t.set("scaleY",n.scaleY),t.skewX=n.skewX,t.skewY=n.skewY,t.angle=n.angle,t.setPositionByOrigin(i,"center","center")},sizeAfterTransform:function(t,e,n){var i=t/2,r=e/2,s=[{x:-i,y:-r},{x:i,y:-r},{x:-i,y:r},{x:i,y:r}],o=d.util.calcDimensionsMatrix(n),a=d.util.makeBoundingBoxFromPoints(s,o);return{x:a.width,y:a.height}}},function(){var t=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},n={m:"l",M:"L"};function i(t,e,n,i,r,s,o,a,h,c,u){var l=d.util.cos(t),f=d.util.sin(t),p=d.util.cos(e),g=d.util.sin(e),v=n*r*p-i*s*g+o,_=i*r*p+n*s*g+a;return["C",c+h*(-n*r*f-i*s*l),u+h*(-i*r*f+n*s*l),v+h*(n*r*g+i*s*p),_+h*(i*r*g-n*s*p),v,_]}function r(t,e,n,r,o,a,h){var c=Math.PI,u=h*c/180,l=d.util.sin(u),f=d.util.cos(u),p=0,g=0,v=-f*t*.5-l*e*.5,_=-f*e*.5+l*t*.5,b=(n=Math.abs(n))*n,m=(r=Math.abs(r))*r,y=_*_,O=v*v,A=b*m-b*y-m*O,C=0;if(A<0){var w=Math.sqrt(1-A/(b*m));n*=w,r*=w}else C=(o===a?-1:1)*Math.sqrt(A/(b*y+m*O));var T=C*n*_/r,S=-C*r*v/n,P=f*T-l*S+.5*t,E=l*T+f*S+.5*e,I=s(1,0,(v-T)/n,(_-S)/r),j=s((v-T)/n,(_-S)/r,(-v-T)/n,(-_-S)/r);0===a&&j>0?j-=2*c:1===a&&j<0&&(j+=2*c);for(var x=Math.ceil(Math.abs(j/c*2)),D=[],k=j/x,R=8/3*Math.sin(k/4)*Math.sin(k/4)/Math.sin(k/2),N=I+k,M=0;M<x;M++)D[M]=i(I,N,f,l,n,r,P,E,R,p,g),p=D[M][5],g=D[M][6],I=N,N+=k;return D}function s(t,e,n,i){var r=Math.atan2(e,t),s=Math.atan2(i,n);return s>=r?s-r:2*Math.PI-(r-s)}function o(e,n,i,r,s,o,a,h){var c;if(d.cachesBoundsOfCurve&&(c=t.call(arguments),d.boundsOfCurveCache[c]))return d.boundsOfCurveCache[c];var u,l,f,p,g,v,_,b,m=Math.sqrt,y=Math.min,O=Math.max,A=Math.abs,C=[],w=[[],[]];l=6*e-12*i+6*s,u=-3*e+9*i-9*s+3*a,f=3*i-3*e;for(var T=0;T<2;++T)if(T>0&&(l=6*n-12*r+6*o,u=-3*n+9*r-9*o+3*h,f=3*r-3*n),A(u)<1e-12){if(A(l)<1e-12)continue;0<(p=-f/l)&&p<1&&C.push(p)}else!((_=l*l-4*f*u)<0)&&(0<(g=(-l+(b=m(_)))/(2*u))&&g<1&&C.push(g),0<(v=(-l-b)/(2*u))&&v<1&&C.push(v));for(var S,P,E,I=C.length,j=I;I--;)S=(E=1-(p=C[I]))*E*E*e+3*E*E*p*i+3*E*p*p*s+p*p*p*a,w[0][I]=S,P=E*E*E*n+3*E*E*p*r+3*E*p*p*o+p*p*p*h,w[1][I]=P;w[0][j]=e,w[1][j]=n,w[0][j+1]=a,w[1][j+1]=h;var x=[{x:y.apply(null,w[0]),y:y.apply(null,w[1])},{x:O.apply(null,w[0]),y:O.apply(null,w[1])}];return d.cachesBoundsOfCurve&&(d.boundsOfCurveCache[c]=x),x}function a(t,e,n){for(var i=n[1],s=n[2],o=n[3],a=n[4],h=n[5],c=r(n[6]-t,n[7]-e,i,s,a,h,o),u=0,l=c.length;u<l;u++)c[u][1]+=t,c[u][2]+=e,c[u][3]+=t,c[u][4]+=e,c[u][5]+=t,c[u][6]+=e;return c}function h(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))}function c(t,e,n,i,r,s,o,a){return function(h){var c=function(t){return t*t*t}(h),u=function(t){return 3*t*t*(1-t)}(h),l=function(t){return 3*t*(1-t)*(1-t)}(h),d=function(t){return(1-t)*(1-t)*(1-t)}(h);return{x:o*c+r*u+n*l+t*d,y:a*c+s*u+i*l+e*d}}}function u(t,e,n,i,r,s,o,a){return function(h){var c=1-h,u=3*c*c*(n-t)+6*c*h*(r-n)+3*h*h*(o-r),l=3*c*c*(i-e)+6*c*h*(s-i)+3*h*h*(a-s);return Math.atan2(l,u)}}function l(t,e,n,i,r,s){return function(o){var a=function(t){return t*t}(o),h=function(t){return 2*t*(1-t)}(o),c=function(t){return(1-t)*(1-t)}(o);return{x:r*a+n*h+t*c,y:s*a+i*h+e*c}}}function f(t,e,n,i,r,s){return function(o){var a=1-o,h=2*a*(n-t)+2*o*(r-n),c=2*a*(i-e)+2*o*(s-i);return Math.atan2(c,h)}}function p(t,e,n){var i,r,s={x:e,y:n},o=0;for(r=1;r<=100;r+=1)i=t(r/100),o+=h(s.x,s.y,i.x,i.y),s=i;return o}function g(t,e){for(var n,i,r,s=0,o=0,a=t.iterator,c={x:t.x,y:t.y},u=.01,l=t.angleFinder;o<e&&s<=1&&u>1e-4;)n=a(s),r=s,(i=h(c.x,c.y,n.x,n.y))+o>e?s-=u/=2:(c=n,s+=u,o+=i);return n.angle=l(r),n}function v(t){for(var e,n,i,r,s=0,o=t.length,a=0,d=0,g=0,v=0,_=[],b=0;b<o;b++){switch(i={x:a,y:d,command:(e=t[b])[0]},e[0]){case"M":i.length=0,g=a=e[1],v=d=e[2];break;case"L":i.length=h(a,d,e[1],e[2]),a=e[1],d=e[2];break;case"C":n=c(a,d,e[1],e[2],e[3],e[4],e[5],e[6]),r=u(a,d,e[1],e[2],e[3],e[4],e[5],e[6]),i.iterator=n,i.angleFinder=r,i.length=p(n,a,d),a=e[5],d=e[6];break;case"Q":n=l(a,d,e[1],e[2],e[3],e[4]),r=f(a,d,e[1],e[2],e[3],e[4]),i.iterator=n,i.angleFinder=r,i.length=p(n,a,d),a=e[3],d=e[4];break;case"Z":case"z":i.destX=g,i.destY=v,i.length=h(a,d,g,v),a=g,d=v}s+=i.length,_.push(i)}return _.push({length:s,x:a,y:d}),_}d.util.joinPath=function(t){return t.map((function(t){return t.join(" ")})).join(" ")},d.util.parsePath=function(t){var i,r,s,o,a,h=[],c=[],u=d.rePathCommand,l="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",f="("+l+")"+d.commaWsp,p="([01])"+d.commaWsp+"?",g=new RegExp(f+"?"+f+"?"+f+p+p+f+"?("+l+")","g");if(!t||!t.match)return h;for(var v,_=0,b=(a=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;_<b;_++){o=(i=a[_]).slice(1).trim(),c.length=0;var m=i.charAt(0);if(v=[m],"a"===m.toLowerCase())for(var y;y=g.exec(o);)for(var O=1;O<y.length;O++)c.push(y[O]);else for(;s=u.exec(o);)c.push(s[0]);O=0;for(var A=c.length;O<A;O++)r=parseFloat(c[O]),isNaN(r)||v.push(r);var C=e[m.toLowerCase()],w=n[m]||m;if(v.length-1>C)for(var T=1,S=v.length;T<S;T+=C)h.push([m].concat(v.slice(T,T+C))),m=w;else h.push(v)}return h},d.util.makePathSimpler=function(t){var e,n,i,r,s,o,h=0,c=0,u=t.length,l=0,d=0,f=[];for(n=0;n<u;++n){switch(i=!1,(e=t[n].slice(0))[0]){case"l":e[0]="L",e[1]+=h,e[2]+=c;case"L":h=e[1],c=e[2];break;case"h":e[1]+=h;case"H":e[0]="L",e[2]=c,h=e[1];break;case"v":e[1]+=c;case"V":e[0]="L",c=e[1],e[1]=h,e[2]=c;break;case"m":e[0]="M",e[1]+=h,e[2]+=c;case"M":h=e[1],c=e[2],l=e[1],d=e[2];break;case"c":e[0]="C",e[1]+=h,e[2]+=c,e[3]+=h,e[4]+=c,e[5]+=h,e[6]+=c;case"C":s=e[3],o=e[4],h=e[5],c=e[6];break;case"s":e[0]="S",e[1]+=h,e[2]+=c,e[3]+=h,e[4]+=c;case"S":"C"===r?(s=2*h-s,o=2*c-o):(s=h,o=c),h=e[3],c=e[4],e[0]="C",e[5]=e[3],e[6]=e[4],e[3]=e[1],e[4]=e[2],e[1]=s,e[2]=o,s=e[3],o=e[4];break;case"q":e[0]="Q",e[1]+=h,e[2]+=c,e[3]+=h,e[4]+=c;case"Q":s=e[1],o=e[2],h=e[3],c=e[4];break;case"t":e[0]="T",e[1]+=h,e[2]+=c;case"T":"Q"===r?(s=2*h-s,o=2*c-o):(s=h,o=c),e[0]="Q",h=e[1],c=e[2],e[1]=s,e[2]=o,e[3]=h,e[4]=c;break;case"a":e[0]="A",e[6]+=h,e[7]+=c;case"A":i=!0,f=f.concat(a(h,c,e)),h=e[6],c=e[7];break;case"z":case"Z":h=l,c=d}i||f.push(e),r=e[0]}return f},d.util.getSmoothPathFromPoints=function(t,e){var n,i=[],r=new d.Point(t[0].x,t[0].y),s=new d.Point(t[1].x,t[1].y),o=t.length,a=1,h=0,c=o>2;for(e=e||0,c&&(a=t[2].x<s.x?-1:t[2].x===s.x?0:1,h=t[2].y<s.y?-1:t[2].y===s.y?0:1),i.push(["M",r.x-a*e,r.y-h*e]),n=1;n<o;n++){if(!r.eq(s)){var u=r.midPointFrom(s);i.push(["Q",r.x,r.y,u.x,u.y])}r=t[n],n+1<t.length&&(s=t[n+1])}return c&&(a=r.x>t[n-2].x?1:r.x===t[n-2].x?0:-1,h=r.y>t[n-2].y?1:r.y===t[n-2].y?0:-1),i.push(["L",r.x+a*e,r.y+h*e]),i},d.util.getPathSegmentsInfo=v,d.util.getBoundsOfCurve=o,d.util.getPointOnPath=function(t,e,n){n||(n=v(t));for(var i=0;e-n[i].length>0&&i<n.length-2;)e-=n[i].length,i++;var r,s=n[i],o=e/s.length,a=s.command,h=t[i];switch(a){case"M":return{x:s.x,y:s.y,angle:0};case"Z":case"z":return(r=new d.Point(s.x,s.y).lerp(new d.Point(s.destX,s.destY),o)).angle=Math.atan2(s.destY-s.y,s.destX-s.x),r;case"L":return(r=new d.Point(s.x,s.y).lerp(new d.Point(h[1],h[2]),o)).angle=Math.atan2(h[2]-s.y,h[1]-s.x),r;case"C":case"Q":return g(s,e)}},d.util.transformPath=function(t,e,n){return n&&(e=d.util.multiplyTransformMatrices(e,[1,0,0,1,-n.x,-n.y])),t.map((function(t){for(var n=t.slice(0),i={},r=1;r<t.length-1;r+=2)i.x=t[r],i.y=t[r+1],i=d.util.transformPoint(i,e),n[r]=i.x,n[r+1]=i.y;return n}))},d.util.fromArcToBeizers=a,d.util.getBoundsOfArc=function(t,e,n,i,s,a,h,c,u){for(var l,d=0,f=0,p=[],g=r(c-t,u-e,n,i,a,h,s),v=0,_=g.length;v<_;v++)l=o(d,f,g[v][1],g[v][2],g[v][3],g[v][4],g[v][5],g[v][6]),p.push({x:l[0].x+t,y:l[0].y+e}),p.push({x:l[1].x+t,y:l[1].y+e}),d=g[v][5],f=g[v][6];return p},d.util.drawArc=function(t,e,n,i){a(e,n,i=i.slice(0).unshift("X")).forEach((function(e){t.bezierCurveTo.apply(t,e.slice(1))}))}}(),function(){var t=Array.prototype.slice;function e(t,e,n){if(t&&0!==t.length){var i=t.length-1,r=e?t[i][e]:t[i];if(e)for(;i--;)n(t[i][e],r)&&(r=t[i][e]);else for(;i--;)n(t[i],r)&&(r=t[i]);return r}}d.util.array={fill:function(t,e){for(var n=t.length;n--;)t[n]=e;return t},invoke:function(e,n){for(var i=t.call(arguments,2),r=[],s=0,o=e.length;s<o;s++)r[s]=i.length?e[s][n].apply(e[s],i):e[s][n].call(e[s]);return r},min:function(t,n){return e(t,n,(function(t,e){return t<e}))},max:function(t,n){return e(t,n,(function(t,e){return t>=e}))}}}(),function(){function t(e,n,i){if(i)if(!d.isLikelyNode&&n instanceof Element)e=n;else if(n instanceof Array){e=[];for(var r=0,s=n.length;r<s;r++)e[r]=t({},n[r],i)}else if(n&&"object"==typeof n)for(var o in n)"canvas"===o||"group"===o?e[o]=null:n.hasOwnProperty(o)&&(e[o]=t({},n[o],i));else e=n;else for(var o in n)e[o]=n[o];return e}d.util.object={extend:t,clone:function(e,n){return t({},e,n)}},d.util.object.extend(d.util,d.Observable)}(),function(){function t(t,e){var n=t.charCodeAt(e);if(isNaN(n))return"";if(n<55296||n>57343)return t.charAt(e);if(55296<=n&&n<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";var i=t.charCodeAt(e+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(0===e)throw"Low surrogate without preceding high surrogate";var r=t.charCodeAt(e-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1}d.util.string={camelize:function(t){return t.replace(/-+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(e){var n,i=0,r=[];for(i=0;i<e.length;i++)!1!==(n=t(e,i))&&r.push(n);return r}}}(),function(){var t=Array.prototype.slice,e=function(){},n=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),i=function(t,e,i){for(var r in e)r in t.prototype&&"function"==typeof t.prototype[r]&&(e[r]+"").indexOf("callSuper")>-1?t.prototype[r]=function(t){return function(){var n=this.constructor.superclass;this.constructor.superclass=i;var r=e[t].apply(this,arguments);if(this.constructor.superclass=n,"initialize"!==t)return r}}(r):t.prototype[r]=e[r],n&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};function r(){}function s(e){for(var n=null,i=this;i.constructor.superclass;){var r=i.constructor.superclass.prototype[e];if(i[e]!==r){n=r;break}i=i.constructor.superclass.prototype}return n?arguments.length>1?n.apply(this,t.call(arguments,1)):n.call(this):console.log("tried to callSuper "+e+", method not found in prototype chain",this)}d.util.createClass=function(){var n=null,o=t.call(arguments,0);function a(){this.initialize.apply(this,arguments)}"function"==typeof o[0]&&(n=o.shift()),a.superclass=n,a.subclasses=[],n&&(r.prototype=n.prototype,a.prototype=new r,n.subclasses.push(a));for(var h=0,c=o.length;h<c;h++)i(a,o[h],n);return a.prototype.initialize||(a.prototype.initialize=e),a.prototype.constructor=a,a.prototype.callSuper=s,a}}(),function(){var t=!!d.document.createElement("div").attachEvent,e=["touchstart","touchmove","touchend"];d.util.addListener=function(e,n,i,r){e&&e.addEventListener(n,i,!t&&r)},d.util.removeListener=function(e,n,i,r){e&&e.removeEventListener(n,i,!t&&r)},d.util.getPointer=function(t){var e=t.target,n=d.util.getScrollLeftTop(e),i=function(t){var e=t.changedTouches;return e&&e[0]?e[0]:t}(t);return{x:i.clientX+n.left,y:i.clientY+n.top}},d.util.isTouchEvent=function(t){return e.indexOf(t.type)>-1||"touch"===t.pointerType}}(),function(){var t=d.document.createElement("div"),e="string"==typeof t.style.opacity,n="string"==typeof t.style.filter,i=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,r=function(t){return t};e?r=function(t,e){return t.style.opacity=e,t}:n&&(r=function(t,e){var n=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(n.zoom=1),i.test(n.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",n.filter=n.filter.replace(i,e)):n.filter+=" alpha(opacity="+100*e+")",t}),d.util.setStyle=function(t,e){var n=t.style;if(!n)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?r(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var i in e)if("opacity"===i)r(t,e[i]);else{n["float"===i||"cssFloat"===i?typeof n.styleFloat>"u"?"cssFloat":"styleFloat":i]=e[i]}return t}}(),function(){var t=Array.prototype.slice;var e,n,i,r,s=function(e){return t.call(e,0)};try{e=s(d.document.childNodes)instanceof Array}catch(i){}function o(t,e){var n=d.document.createElement(t);for(var i in e)"class"===i?n.className=e[i]:"for"===i?n.htmlFor=e[i]:n.setAttribute(i,e[i]);return n}function a(t){for(var e=0,n=0,i=d.document.documentElement,r=d.document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&((t=t.parentNode||t.host)===d.document?(e=r.scrollLeft||i.scrollLeft||0,n=r.scrollTop||i.scrollTop||0):(e+=t.scrollLeft||0,n+=t.scrollTop||0),1!==t.nodeType||"fixed"!==t.style.position););return{left:e,top:n}}e||(s=function(t){for(var e=new Array(t.length),n=t.length;n--;)e[n]=t[n];return e}),n=d.document.defaultView&&d.document.defaultView.getComputedStyle?function(t,e){var n=d.document.defaultView.getComputedStyle(t,null);return n?n[e]:void 0}:function(t,e){var n=t.style[e];return!n&&t.currentStyle&&(n=t.currentStyle[e]),n},i=d.document.documentElement.style,r="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"",d.util.makeElementUnselectable=function(t){return typeof t.onselectstart<"u"&&(t.onselectstart=d.util.falseFunction),r?t.style[r]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t},d.util.makeElementSelectable=function(t){return typeof t.onselectstart<"u"&&(t.onselectstart=null),r?t.style[r]="":"string"==typeof t.unselectable&&(t.unselectable=""),t},d.util.setImageSmoothing=function(t,e){t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=e},d.util.getById=function(t){return"string"==typeof t?d.document.getElementById(t):t},d.util.toArray=s,d.util.addClass=function(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)},d.util.makeElement=o,d.util.wrapElement=function(t,e,n){return"string"==typeof e&&(e=o(e,n)),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e},d.util.getScrollLeftTop=a,d.util.getElementOffset=function(t){var e,i,r=t&&t.ownerDocument,s={left:0,top:0},o={left:0,top:0},h={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return o;for(var c in h)o[h[c]]+=parseInt(n(t,c),10)||0;return e=r.documentElement,typeof t.getBoundingClientRect<"u"&&(s=t.getBoundingClientRect()),i=a(t),{left:s.left+i.left-(e.clientLeft||0)+o.left,top:s.top+i.top-(e.clientTop||0)+o.top}},d.util.getNodeCanvas=function(t){var e=d.jsdomImplForWrapper(t);return e._canvas||e._image},d.util.cleanUpJsdomNode=function(t){if(d.isLikelyNode){var e=d.jsdomImplForWrapper(t);e&&(e._image=null,e._canvas=null,e._currentSrc=null,e._attributes=null,e._classList=null)}}}(),function(){function t(){}d.util.request=function(e,n){n||(n={});var i=n.method?n.method.toUpperCase():"GET",r=n.onComplete||function(){},s=new d.window.XMLHttpRequest,o=n.body||n.parameters;return s.onreadystatechange=function(){4===s.readyState&&(r(s),s.onreadystatechange=t)},"GET"===i&&(o=null,"string"==typeof n.parameters&&(e=function(t,e){return t+(/\?/.test(t)?"&":"?")+e}(e,n.parameters))),s.open(i,e,!0),("POST"===i||"PUT"===i)&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(o),s}}(),d.log=console.log,d.warn=console.warn,function(){function t(){return!1}function e(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e}var n=d.window.requestAnimationFrame||d.window.webkitRequestAnimationFrame||d.window.mozRequestAnimationFrame||d.window.oRequestAnimationFrame||d.window.msRequestAnimationFrame||function(t){return d.window.setTimeout(t,1e3/60)},i=d.window.cancelAnimationFrame||d.window.clearTimeout;function r(){return n.apply(d.window,arguments)}d.util.animate=function(n){var i=!1;return r((function(s){n||(n={});var o,a=s||+new Date,h=n.duration||500,c=a+h,u=n.onChange||t,l=n.abort||t,d=n.onComplete||t,f=n.easing||e,p="startValue"in n?n.startValue:0,g="endValue"in n?n.endValue:100,v=n.byValue||g-p;n.onStart&&n.onStart(),function t(e){var n=(o=e||+new Date)>c?h:o-a,s=n/h,_=f(n,p,v,h),b=Math.abs((_-p)/v);if(!i){if(l(_,b,s))return void d(g,1,1);if(o>c)return u(g,1,1),void d(g,1,1);u(_,b,s),r(t)}}(a)})),function(){i=!0}},d.util.requestAnimFrame=r,d.util.cancelAnimFrame=function(){return i.apply(d.window,arguments)}}(),function(){function t(t,e,n){var i="rgba("+parseInt(t[0]+n*(e[0]-t[0]),10)+","+parseInt(t[1]+n*(e[1]-t[1]),10)+","+parseInt(t[2]+n*(e[2]-t[2]),10);return i+=","+(t&&e?parseFloat(t[3]+n*(e[3]-t[3])):1),i+=")"}d.util.animateColor=function(e,n,i,r){var s=new d.Color(e).getSource(),o=new d.Color(n).getSource(),a=r.onComplete,h=r.onChange;return r=r||{},d.util.animate(d.util.object.extend(r,{duration:i||500,startValue:s,endValue:o,byValue:o,easing:function(e,n,i,s){return t(n,i,r.colorEasing?r.colorEasing(e,s):1-Math.cos(e/s*(Math.PI/2)))},onComplete:function(e,n,i){if(a)return a(t(o,o,0),n,i)},onChange:function(e,n,i){if(h){if(Array.isArray(e))return h(t(e,e,0),n,i);h(e,n,i)}}}))}}(),function(){function t(t,e,n,i){return t<Math.abs(e)?(t=e,i=n/4):i=0===e&&0===t?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:n,s:i}}function e(t,e,n){return t.a*Math.pow(2,10*(e-=1))*Math.sin((e*n-t.s)*(2*Math.PI)/t.p)}function n(t,e,n,r){return n-i(r-t,0,n,r)+e}function i(t,e,n,i){return(t/=i)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e}d.util.ease={easeInQuad:function(t,e,n,i){return n*(t/=i)*t+e},easeOutQuad:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInOutQuad:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,i){return n*(t/=i)*t*t+e},easeOutCubic:function(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,i){return n*(t/=i)*t*t*t+e},easeOutQuart:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},easeOutQuint:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,i){return n*Math.sin(t/i*(Math.PI/2))+e},easeInOutSine:function(t,e,n,i){return-n/2*(Math.cos(Math.PI*t/i)-1)+e},easeInExpo:function(t,e,n,i){return 0===t?e:n*Math.pow(2,10*(t/i-1))+e},easeOutExpo:function(t,e,n,i){return t===i?e+n:n*(1-Math.pow(2,-10*t/i))+e},easeInOutExpo:function(t,e,n,i){return 0===t?e:t===i?e+n:(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,n,i){return-n*(Math.sqrt(1-(t/=i)*t)-1)+e},easeOutCirc:function(t,e,n,i){return n*Math.sqrt(1-(t=t/i-1)*t)+e},easeInOutCirc:function(t,e,n,i){return(t/=i/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(n,i,r,s){var o=0;return 0===n?i:1===(n/=s)?i+r:(o||(o=.3*s),-e(t(r,r,o,1.70158),n,s)+i)},easeOutElastic:function(e,n,i,r){var s=0;if(0===e)return n;if(1===(e/=r))return n+i;s||(s=.3*r);var o=t(i,i,s,1.70158);return o.a*Math.pow(2,-10*e)*Math.sin((e*r-o.s)*(2*Math.PI)/o.p)+o.c+n},easeInOutElastic:function(n,i,r,s){var o=0;if(0===n)return i;if(2===(n/=s/2))return i+r;o||(o=s*(.3*1.5));var a=t(r,r,o,1.70158);return n<1?-.5*e(a,n,s)+i:a.a*Math.pow(2,-10*(n-=1))*Math.sin((n*s-a.s)*(2*Math.PI)/a.p)*.5+a.c+i},easeInBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),n*(t/=i)*t*((r+1)*t-r)+e},easeOutBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),n*((t=t/i-1)*t*((r+1)*t+r)+1)+e},easeInOutBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),(t/=i/2)<1?n/2*(t*t*((1+(r*=1.525))*t-r))+e:n/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},easeInBounce:n,easeOutBounce:i,easeInOutBounce:function(t,e,r,s){return t<s/2?.5*n(2*t,0,r,s)+e:.5*i(2*t-s,0,r,s)+.5*r+e}}}(),function(t){var e=t.fabric||(t.fabric={});function n(t,e){this.x=t,this.y=e}e.Point?e.warn("fabric.Point is already defined"):(e.Point=n,n.prototype={type:"point",constructor:n,add:function(t){return new n(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new n(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new n(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new n(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new n(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new n(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,e){return typeof e>"u"&&(e=.5),e=Math.max(Math.min(1,e),0),new n(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},distanceFrom:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new n(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new n(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,n=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=n},clone:function(){return new n(this.x,this.y)}})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={});function n(t){this.status=t,this.points=[]}e.Intersection?e.warn("fabric.Intersection is already defined"):(e.Intersection=n,e.Intersection.prototype={constructor:n,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},e.Intersection.intersectLineLine=function(t,i,r,s){var o,a=(s.x-r.x)*(t.y-r.y)-(s.y-r.y)*(t.x-r.x),h=(i.x-t.x)*(t.y-r.y)-(i.y-t.y)*(t.x-r.x),c=(s.y-r.y)*(i.x-t.x)-(s.x-r.x)*(i.y-t.y);if(0!==c){var u=a/c,l=h/c;0<=u&&u<=1&&0<=l&&l<=1?(o=new n("Intersection")).appendPoint(new e.Point(t.x+u*(i.x-t.x),t.y+u*(i.y-t.y))):o=new n}else o=new n(0===a||0===h?"Coincident":"Parallel");return o},e.Intersection.intersectLinePolygon=function(t,e,i){var r,s,o,a,h=new n,c=i.length;for(a=0;a<c;a++)r=i[a],s=i[(a+1)%c],o=n.intersectLineLine(t,e,r,s),h.appendPoints(o.points);return h.points.length>0&&(h.status="Intersection"),h},e.Intersection.intersectPolygonPolygon=function(t,e){var i,r=new n,s=t.length;for(i=0;i<s;i++){var o=t[i],a=t[(i+1)%s],h=n.intersectLinePolygon(o,a,e);r.appendPoints(h.points)}return r.points.length>0&&(r.status="Intersection"),r},e.Intersection.intersectPolygonRectangle=function(t,i,r){var s=i.min(r),o=i.max(r),a=new e.Point(o.x,s.y),h=new e.Point(s.x,o.y),c=n.intersectLinePolygon(s,a,t),u=n.intersectLinePolygon(a,o,t),l=n.intersectLinePolygon(o,h,t),d=n.intersectLinePolygon(h,s,t),f=new n;return f.appendPoints(c.points),f.appendPoints(u.points),f.appendPoints(l.points),f.appendPoints(d.points),f.points.length>0&&(f.status="Intersection"),f})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={});function n(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function i(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}e.Color?e.warn("fabric.Color is already defined."):(e.Color=n,e.Color.prototype={_tryParsingColor:function(t){var e;t in n.colorNameMap&&(t=n.colorNameMap[t]),"transparent"===t&&(e=[255,255,255,0]),e||(e=n.sourceFromHex(t)),e||(e=n.sourceFromRgb(t)),e||(e=n.sourceFromHsl(t)),e||(e=[0,0,0,1]),e&&this.setSource(e)},_rgbToHsl:function(t,n,i){t/=255,n/=255,i/=255;var r,s,o,a=e.util.array.max([t,n,i]),h=e.util.array.min([t,n,i]);if(o=(a+h)/2,a===h)r=s=0;else{var c=a-h;switch(s=o>.5?c/(2-a-h):c/(a+h),a){case t:r=(n-i)/c+(n<i?6:0);break;case n:r=(i-t)/c+2;break;case i:r=(t-n)/c+4}r/=6}return[Math.round(360*r),Math.round(100*s),Math.round(100*o)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,n,i=this.getSource();return t=1===(t=i[0].toString(16)).length?"0"+t:t,e=1===(e=i[1].toString(16)).length?"0"+e:e,n=1===(n=i[2].toString(16)).length?"0"+n:n,t.toUpperCase()+e.toUpperCase()+n.toUpperCase()},toHexa:function(){var t,e=this.getSource();return t=1===(t=(t=Math.round(255*e[3])).toString(16)).length?"0"+t:t,this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),n=t[3];return this.setSource([e,e,e,n]),this},toBlackWhite:function(t){var e=this.getSource(),n=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),i=e[3];return t=t||127,n=Number(n)<Number(t)?0:255,this.setSource([n,n,n,i]),this},overlayWith:function(t){t instanceof n||(t=new n(t));var e,i=[],r=this.getAlpha(),s=this.getSource(),o=t.getSource();for(e=0;e<3;e++)i.push(Math.round(.5*s[e]+.5*o[e]));return i[3]=r,this.setSource(i),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},e.Color.fromRgb=function(t){return n.fromSource(n.sourceFromRgb(t))},e.Color.sourceFromRgb=function(t){var e=t.match(n.reRGBa);if(e){var i=parseInt(e[1],10)/(/%$/.test(e[1])?100:1)*(/%$/.test(e[1])?255:1),r=parseInt(e[2],10)/(/%$/.test(e[2])?100:1)*(/%$/.test(e[2])?255:1),s=parseInt(e[3],10)/(/%$/.test(e[3])?100:1)*(/%$/.test(e[3])?255:1);return[parseInt(i,10),parseInt(r,10),parseInt(s,10),e[4]?parseFloat(e[4]):1]}},e.Color.fromRgba=n.fromRgb,e.Color.fromHsl=function(t){return n.fromSource(n.sourceFromHsl(t))},e.Color.sourceFromHsl=function(t){var e=t.match(n.reHSLa);if(e){var r,s,o,a=(parseFloat(e[1])%360+360)%360/360,h=parseFloat(e[2])/(/%$/.test(e[2])?100:1),c=parseFloat(e[3])/(/%$/.test(e[3])?100:1);if(0===h)r=s=o=c;else{var u=c<=.5?c*(h+1):c+h-c*h,l=2*c-u;r=i(l,u,a+1/3),s=i(l,u,a),o=i(l,u,a-1/3)}return[Math.round(255*r),Math.round(255*s),Math.round(255*o),e[4]?parseFloat(e[4]):1]}},e.Color.fromHsla=n.fromHsl,e.Color.fromHex=function(t){return n.fromSource(n.sourceFromHex(t))},e.Color.sourceFromHex=function(t){if(t.match(n.reHex)){var e=t.slice(t.indexOf("#")+1),i=3===e.length||4===e.length,r=8===e.length||4===e.length,s=i?e.charAt(0)+e.charAt(0):e.substring(0,2),o=i?e.charAt(1)+e.charAt(1):e.substring(2,4),a=i?e.charAt(2)+e.charAt(2):e.substring(4,6),h=r?i?e.charAt(3)+e.charAt(3):e.substring(6,8):"FF";return[parseInt(s,16),parseInt(o,16),parseInt(a,16),parseFloat((parseInt(h,16)/255).toFixed(2))]}},e.Color.fromSource=function(t){var e=new n;return e.setSource(t),e})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={}),n=["e","se","s","sw","w","nw","n","ne","e"],i=["ns","nesw","ew","nwse"],r={},s="left",o="top",a="right",h="bottom",c="center",u={top:h,bottom:o,left:a,right:s,center:c},l=e.util.radiansToDegrees,d=Math.sign||function(t){return(t>0)-(t<0)||+t};function f(t,e){var n=t.angle+l(Math.atan2(e.y,e.x))+360;return Math.round(n%360/45)}function p(t,n){var i=n.transform.target,r=i.canvas,s=e.util.object.clone(n);s.target=i,r&&r.fire("object:"+t,s),i.fire(t,n)}function g(t,e){var n=e.canvas,i=t[n.uniScaleKey];return n.uniformScaling&&!i||!n.uniformScaling&&i}function v(t){return t.originX===c&&t.originY===c}function _(t,e,n){var i=t.lockScalingX,r=t.lockScalingY;return!!(i&&r||!e&&(i||r)&&n||i&&"x"===e||r&&"y"===e)}function b(t,e,n,i){return{e:t,transform:e,pointer:{x:n,y:i}}}function m(t){return function(e,n,i,r){var s=n.target,o=s.getCenterPoint(),a=s.translateToOriginPoint(o,n.originX,n.originY),h=t(e,n,i,r);return s.setPositionByOrigin(a,n.originX,n.originY),h}}function y(t,e){return function(n,i,r,s){var o=e(n,i,r,s);return o&&p(t,b(n,i,r,s)),o}}function O(t,n,i,r,s){var o=t.target,a=o.controls[t.corner],h=o.canvas.getZoom(),c=o.padding/h,u=o.toLocalPoint(new e.Point(r,s),n,i);return u.x>=c&&(u.x-=c),u.x<=-c&&(u.x+=c),u.y>=c&&(u.y-=c),u.y<=c&&(u.y+=c),u.x-=a.offsetX,u.y-=a.offsetY,u}function A(t){return t.flipX!==t.flipY}function C(t,e,n,i,r){if(0!==t[e]){var s=r/t._getTransformedDimensions()[i]*t[n];t.set(n,s)}}function w(t,e,n,i){var r,c=e.target,u=c._getTransformedDimensions(0,c.skewY),d=O(e,e.originX,e.originY,n,i),f=Math.abs(2*d.x)-u.x,p=c.skewX;f<2?r=0:(r=l(Math.atan2(f/c.scaleX,u.y/c.scaleY)),e.originX===s&&e.originY===h&&(r=-r),e.originX===a&&e.originY===o&&(r=-r),A(c)&&(r=-r));var g=p!==r;if(g){var v=c._getTransformedDimensions().y;c.set("skewX",r),C(c,"skewY","scaleY","y",v)}return g}function T(t,e,n,i){var r,c=e.target,u=c._getTransformedDimensions(c.skewX,0),d=O(e,e.originX,e.originY,n,i),f=Math.abs(2*d.y)-u.y,p=c.skewY;f<2?r=0:(r=l(Math.atan2(f/c.scaleY,u.x/c.scaleX)),e.originX===s&&e.originY===h&&(r=-r),e.originX===a&&e.originY===o&&(r=-r),A(c)&&(r=-r));var g=p!==r;if(g){var v=c._getTransformedDimensions().x;c.set("skewY",r),C(c,"skewX","scaleX","x",v)}return g}function S(t,e,n,i,r){r=r||{};var s,o,a,h,c,l,f=e.target,p=f.lockScalingX,b=f.lockScalingY,m=r.by,y=g(t,f),A=_(f,m,y),C=e.gestureScale;if(A)return!1;if(C)o=e.scaleX*C,a=e.scaleY*C;else{if(s=O(e,e.originX,e.originY,n,i),c="y"!==m?d(s.x):1,l="x"!==m?d(s.y):1,e.signX||(e.signX=c),e.signY||(e.signY=l),f.lockScalingFlip&&(e.signX!==c||e.signY!==l))return!1;if(h=f._getTransformedDimensions(),y&&!m){var w=Math.abs(s.x)+Math.abs(s.y),T=e.original,S=w/(Math.abs(h.x*T.scaleX/f.scaleX)+Math.abs(h.y*T.scaleY/f.scaleY));o=T.scaleX*S,a=T.scaleY*S}else o=Math.abs(s.x*f.scaleX/h.x),a=Math.abs(s.y*f.scaleY/h.y);v(e)&&(o*=2,a*=2),e.signX!==c&&"y"!==m&&(e.originX=u[e.originX],o*=-1,e.signX=c),e.signY!==l&&"x"!==m&&(e.originY=u[e.originY],a*=-1,e.signY=l)}var P=f.scaleX,E=f.scaleY;return m?("x"===m&&f.set("scaleX",o),"y"===m&&f.set("scaleY",a)):(!p&&f.set("scaleX",o),!b&&f.set("scaleY",a)),P!==f.scaleX||E!==f.scaleY}r.scaleCursorStyleHandler=function(t,e,i){var r=g(t,i),s="";if(0!==e.x&&0===e.y?s="x":0===e.x&&0!==e.y&&(s="y"),_(i,s,r))return"not-allowed";var o=f(i,e);return n[o]+"-resize"},r.skewCursorStyleHandler=function(t,e,n){if(0!==e.x&&n.lockSkewingY||0!==e.y&&n.lockSkewingX)return"not-allowed";var r=f(n,e)%4;return i[r]+"-resize"},r.scaleSkewCursorStyleHandler=function(t,e,n){return t[n.canvas.altActionKey]?r.skewCursorStyleHandler(t,e,n):r.scaleCursorStyleHandler(t,e,n)},r.rotationWithSnapping=y("rotating",m((function(t,e,n,i){var r=e,s=r.target,o=s.translateToOriginPoint(s.getCenterPoint(),r.originX,r.originY);if(s.lockRotation)return!1;var a,h=Math.atan2(r.ey-o.y,r.ex-o.x),c=Math.atan2(i-o.y,n-o.x),u=l(c-h+r.theta);if(s.snapAngle>0){var d=s.snapAngle,f=s.snapThreshold||d,p=Math.ceil(u/d)*d,g=Math.floor(u/d)*d;Math.abs(u-g)<f?u=g:Math.abs(u-p)<f&&(u=p)}return u<0&&(u=360+u),u%=360,a=s.angle!==u,s.angle=u,a}))),r.scalingEqually=y("scaling",m((function(t,e,n,i){return S(t,e,n,i)}))),r.scalingX=y("scaling",m((function(t,e,n,i){return S(t,e,n,i,{by:"x"})}))),r.scalingY=y("scaling",m((function(t,e,n,i){return S(t,e,n,i,{by:"y"})}))),r.scalingYOrSkewingX=function(t,e,n,i){return t[e.target.canvas.altActionKey]?r.skewHandlerX(t,e,n,i):r.scalingY(t,e,n,i)},r.scalingXOrSkewingY=function(t,e,n,i){return t[e.target.canvas.altActionKey]?r.skewHandlerY(t,e,n,i):r.scalingX(t,e,n,i)},r.changeWidth=y("resizing",m((function(t,e,n,i){var r=e.target,s=O(e,e.originX,e.originY,n,i),o=r.strokeWidth/(r.strokeUniform?r.scaleX:1),a=v(e)?2:1,h=r.width,c=Math.abs(s.x*a/r.scaleX)-o;return r.set("width",Math.max(c,0)),h!==c}))),r.skewHandlerX=function(t,e,n,i){var r,h=e.target,u=h.skewX,l=e.originY;return!h.lockSkewingX&&(0===u?r=O(e,c,c,n,i).x>0?s:a:(u>0&&(r=l===o?s:a),u<0&&(r=l===o?a:s),A(h)&&(r=r===s?a:s)),e.originX=r,y("skewing",m(w))(t,e,n,i))},r.skewHandlerY=function(t,e,n,i){var r,a=e.target,u=a.skewY,l=e.originX;return!a.lockSkewingY&&(0===u?r=O(e,c,c,n,i).y>0?o:h:(u>0&&(r=l===s?o:h),u<0&&(r=l===s?h:o),A(a)&&(r=r===o?h:o)),e.originY=r,y("skewing",m(T))(t,e,n,i))},r.dragHandler=function(t,e,n,i){var r=e.target,s=n-e.offsetX,o=i-e.offsetY,a=!r.get("lockMovementX")&&r.left!==s,h=!r.get("lockMovementY")&&r.top!==o;return a&&r.set("left",s),h&&r.set("top",o),(a||h)&&p("moving",b(t,e,n,i)),a||h},r.scaleOrSkewActionName=function(t,e,n){var i=t[n.canvas.altActionKey];return 0===e.x?i?"skewX":"scaleY":0===e.y?i?"skewY":"scaleX":void 0},r.rotationStyleHandler=function(t,e,n){return n.lockRotation?"not-allowed":e.cursorStyle},r.fireEvent=p,r.wrapWithFixedAnchor=m,r.wrapWithFireEvent=y,r.getLocalPoint=O,e.controlsUtils=r}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={}),n=e.util.degreesToRadians,i=e.controlsUtils;i.renderCircleControl=function(t,e,n,i,r){i=i||{};var s,o=this.sizeX||i.cornerSize||r.cornerSize,a=this.sizeY||i.cornerSize||r.cornerSize,h=typeof i.transparentCorners<"u"?i.transparentCorners:r.transparentCorners,c=h?"stroke":"fill",u=!h&&(i.cornerStrokeColor||r.cornerStrokeColor),l=e,d=n;t.save(),t.fillStyle=i.cornerColor||r.cornerColor,t.strokeStyle=i.cornerStrokeColor||r.cornerStrokeColor,o>a?(s=o,t.scale(1,a/o),d=n*o/a):a>o?(s=a,t.scale(o/a,1),l=e*a/o):s=o,t.lineWidth=1,t.beginPath(),t.arc(l,d,s/2,0,2*Math.PI,!1),t[c](),u&&t.stroke(),t.restore()},i.renderSquareControl=function(t,e,i,r,s){r=r||{};var o=this.sizeX||r.cornerSize||s.cornerSize,a=this.sizeY||r.cornerSize||s.cornerSize,h=typeof r.transparentCorners<"u"?r.transparentCorners:s.transparentCorners,c=h?"stroke":"fill",u=!h&&(r.cornerStrokeColor||s.cornerStrokeColor),l=o/2,d=a/2;t.save(),t.fillStyle=r.cornerColor||s.cornerColor,t.strokeStyle=r.cornerStrokeColor||s.cornerStrokeColor,t.lineWidth=1,t.translate(e,i),t.rotate(n(s.angle)),t[c+"Rect"](-l,-d,o,a),u&&t.strokeRect(-l,-d,o,a),t.restore()}}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={});e.Control=function(t){for(var e in t)this[e]=t[e]},e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(t,e){return e.cursorStyle},getActionName:function(t,e){return e.actionName},getVisibility:function(t,e){var n=t._controlsVisibility;return n&&typeof n[e]<"u"?n[e]:this.visible},setVisibility:function(t){this.visible=t},positionHandler:function(t,n){return e.util.transformPoint({x:this.x*t.x+this.offsetX,y:this.y*t.y+this.offsetY},n)},calcCornerCoords:function(t,n,i,r,s){var o,a,h,c,u=s?this.touchSizeX:this.sizeX,l=s?this.touchSizeY:this.sizeY;if(u&&l&&u!==l){var d=Math.atan2(l,u),f=Math.sqrt(u*u+l*l)/2,p=d-e.util.degreesToRadians(t),g=Math.PI/2-d-e.util.degreesToRadians(t);o=f*e.util.cos(p),a=f*e.util.sin(p),h=f*e.util.cos(g),c=f*e.util.sin(g)}else{f=.7071067812*(u&&l?u:n);p=e.util.degreesToRadians(45-t);o=h=f*e.util.cos(p),a=c=f*e.util.sin(p)}return{tl:{x:i-c,y:r-h},tr:{x:i+o,y:r-a},bl:{x:i-o,y:r+a},br:{x:i+c,y:r+h}}},render:function(t,n,i,r,s){switch((r=r||{}).cornerStyle||s.cornerStyle){case"circle":e.controlsUtils.renderCircleControl.call(this,t,n,i,r,s);break;default:e.controlsUtils.renderSquareControl.call(this,t,n,i,r,s)}}}}(typeof f<"u"?f:void 0),d.util.object.clone,d.Gradient=d.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(t){t||(t={}),t.coords||(t.coords={});var e,n=this;Object.keys(t).forEach((function(e){n[e]=t[e]})),this.id?this.id+="_"+d.Object.__uid++:this.id=d.Object.__uid++,e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice()},addColorStop:function(t){for(var e in t){var n=new d.Color(t[e]);this.colorStops.push({offset:parseFloat(e),color:n.toRgb(),opacity:n.getAlpha()})}return this},toObject:function(t){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return d.util.populateWithProperties(this,e,t),e},toLive:function(t){var e,n,i,r=d.util.object.clone(this.coords);if(this.type){for("linear"===this.type?e=t.createLinearGradient(r.x1,r.y1,r.x2,r.y2):"radial"===this.type&&(e=t.createRadialGradient(r.x1,r.y1,r.r1,r.x2,r.y2,r.r2)),n=0,i=this.colorStops.length;n<i;n++){var s=this.colorStops[n].color,o=this.colorStops[n].opacity,a=this.colorStops[n].offset;typeof o<"u"&&(s=new d.Color(s).setAlpha(o).toRgba()),e.addColorStop(a,s)}return e}}}),d.util.object.extend(d.Gradient,{}),function(){if(d.StaticCanvas)d.warn("fabric.StaticCanvas is already defined.");else{var t=d.util.object.extend,e=d.util.getElementOffset,n=d.util.removeFromArray;d.util.toFixed;var i=d.util.transformPoint,r=d.util.invertTransform,s=d.util.getNodeCanvas,o=d.util.createCanvasElement,a=new Error("Could not initialize `canvas` element");d.StaticCanvas=d.util.createClass(d.CommonMethods,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:d.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(t,e){var n=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,n),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,n),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,n),e.overlayColor&&this.setOverlayColor(e.overlayColor,n),this.calcOffset()},_isRetinaScaling:function(){return 1!==d.devicePixelRatio&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?d.devicePixelRatio:1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var t=d.devicePixelRatio;this.__initRetinaScaling(t,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(t,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(t,e,n){e.setAttribute("width",this.width*t),e.setAttribute("height",this.height*t),n.scale(t,t)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,n){return this.__setBgOverlayImage("overlayImage",t,e,n)},setBackgroundImage:function(t,e,n){return this.__setBgOverlayImage("backgroundImage",t,e,n)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},__setBgOverlayImage:function(t,e,n,i){return"string"==typeof e?d.util.loadImage(e,(function(e,r){if(e){var s=new d.Image(e,i);this[t]=s,s.canvas=this}n&&n(e,r)}),this,i&&i.crossOrigin):(i&&e.setOptions(i),this[t]=e,e&&(e.canvas=this),n&&n(e,!1)),this},__setBgOverlayColor:function(t,e,n){return this[t]=e,this._initGradient(e,t),this._initPattern(e,t,n),this},_createCanvasElement:function(){var t=o();if(!t||(t.style||(t.style={}),typeof t.getContext>"u"))throw a;return t},_initOptions:function(t){var e=this.lowerCanvasEl;this._setOptions(t),this.width=this.width||parseInt(e.width,10)||0,this.height=this.height||parseInt(e.height,10)||0,this.lowerCanvasEl.style&&(e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){t&&t.getContext?this.lowerCanvasEl=t:this.lowerCanvasEl=d.util.getById(t)||this._createCanvasElement(),d.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var n;for(var i in e=e||{},t)n=t[i],e.cssOnly||(this._setBackstoreDimension(i,t[i]),n+="px",this.hasLostContext=!0),e.backstoreOnly||this._setCssDimension(i,n);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(),this._initRetinaScaling(),this.calcOffset(),e.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var e,n,i,r=this._activeObject,s=this.backgroundImage,o=this.overlayImage;for(this.viewportTransform=t,n=0,i=this._objects.length;n<i;n++)(e=this._objects[n]).group||e.setCoords(!0);return r&&r.setCoords(),s&&s.setCoords(!0),o&&o.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,e){var n=t,s=this.viewportTransform.slice(0);t=i(t,r(this.viewportTransform)),s[0]=e,s[3]=e;var o=i(t,s);return s[4]+=n.x-o.x,s[5]+=n.y-o.y,this.setViewportTransform(s)},setZoom:function(t){return this.zoomToPoint(new d.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new d.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=d.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},e=this.width,n=this.height,s=r(this.viewportTransform);return t.tl=i({x:0,y:0},s),t.br=i({x:e,y:n},s),t.tr=new d.Point(t.br.x,t.tl.y),t.bl=new d.Point(t.tl.x,t.br.y),this.vptCoords=t,t},cancelRequestedRender:function(){this.isRendering&&(d.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(t,e){var n=this.viewportTransform,i=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(t),d.util.setImageSmoothing(t,this.imageSmoothingEnabled),this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),i&&(i.canvas=this,i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t)),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render",{ctx:t})},drawClipPathOnCanvas:function(t){var e=this.viewportTransform,n=this.clipPath;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.globalCompositeOperation="destination-in",n.transform(t),t.scale(1/n.zoomX,1/n.zoomY),t.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),t.restore()},_renderObjects:function(t,e){var n,i;for(n=0,i=e.length;n<i;++n)e[n]&&e[n].render(t)},_renderBackgroundOrOverlay:function(t,e){var n=this[e+"Color"],i=this[e+"Image"],r=this.viewportTransform,s=this[e+"Vpt"];if(n||i){if(n){t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=n.toLive?n.toLive(t,this):n,s&&t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),t.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);var o=n.gradientTransform||n.patternTransform;o&&t.transform(o[0],o[1],o[2],o[3],o[4],o[5]),t.fill(),t.restore()}i&&(t.save(),s&&t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),i.render(t),t.restore())}},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(t){return this._centerObject(t,new d.Point(this.getCenter().left,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new d.Point(t.getCenterPoint().x,this.getCenter().top))},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new d.Point(e.left,e.top))},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new d.Point(e.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new d.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenter(),e=r(this.viewportTransform);return i({x:t.left,y:t.top},e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,n){var i=this.clipPath,r={version:d.version,objects:this._toObjects(e,n)};return i&&!i.excludeFromExport&&(r.clipPath=this._toObject(this.clipPath,e,n)),t(r,this.__serializeBgOverlay(e,n)),d.util.populateWithProperties(this,r,n),r},_toObjects:function(t,e){return this._objects.filter((function(t){return!t.excludeFromExport})).map((function(n){return this._toObject(n,t,e)}),this)},_toObject:function(t,e,n){var i;this.includeDefaultValues||(i=t.includeDefaultValues,t.includeDefaultValues=!1);var r=t[e](n);return this.includeDefaultValues||(t.includeDefaultValues=i),r},__serializeBgOverlay:function(t,e){var n={},i=this.backgroundImage,r=this.overlayImage,s=this.backgroundColor,o=this.overlayColor;return s&&s.toObject?s.excludeFromExport||(n.background=s.toObject(e)):s&&(n.background=s),o&&o.toObject?o.excludeFromExport||(n.overlay=o.toObject(e)):o&&(n.overlay=o),i&&!i.excludeFromExport&&(n.backgroundImage=this._toObject(i,t,e)),r&&!r.excludeFromExport&&(n.overlayImage=this._toObject(r,t,e)),n},sendToBack:function(t){if(!t)return this;var e,i,r,s=this._activeObject;if(t===s&&"activeSelection"===t.type)for(e=(r=s._objects).length;e--;)i=r[e],n(this._objects,i),this._objects.unshift(i);else n(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var e,i,r,s=this._activeObject;if(t===s&&"activeSelection"===t.type)for(r=s._objects,e=0;e<r.length;e++)i=r[e],n(this._objects,i),this._objects.push(i);else n(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,e){if(!t)return this;var i,r,s,o,a,h=this._activeObject,c=0;if(t===h&&"activeSelection"===t.type)for(a=h._objects,i=0;i<a.length;i++)r=a[i],(s=this._objects.indexOf(r))>0+c&&(o=s-1,n(this._objects,r),this._objects.splice(o,0,r)),c++;else 0!==(s=this._objects.indexOf(t))&&(o=this._findNewLowerIndex(t,s,e),n(this._objects,t),this._objects.splice(o,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,e,n){var i,r;if(n)for(i=e,r=e-1;r>=0;--r){if(t.intersectsWithObject(this._objects[r])||t.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(t)){i=r;break}}else i=e-1;return i},bringForward:function(t,e){if(!t)return this;var i,r,s,o,a,h=this._activeObject,c=0;if(t===h&&"activeSelection"===t.type)for(i=(a=h._objects).length;i--;)r=a[i],(s=this._objects.indexOf(r))<this._objects.length-1-c&&(o=s+1,n(this._objects,r),this._objects.splice(o,0,r)),c++;else(s=this._objects.indexOf(t))!==this._objects.length-1&&(o=this._findNewUpperIndex(t,s,e),n(this._objects,t),this._objects.splice(o,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,e,n){var i,r,s;if(n)for(i=e,r=e+1,s=this._objects.length;r<s;++r){if(t.intersectsWithObject(this._objects[r])||t.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(t)){i=r;break}}else i=e+1;return i},moveTo:function(t,e){return n(this._objects,t),this._objects.splice(e,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(d.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject((function(t){t.dispose&&t.dispose()})),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),this.lowerCanvasEl.style=this._originalCanvasStyle,delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),d.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(d.StaticCanvas.prototype,d.Observable),t(d.StaticCanvas.prototype,d.Collection),t(d.StaticCanvas.prototype,d.DataURLExporter),t(d.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=o();if(!e||!e.getContext)return null;var n=e.getContext("2d");if(!n)return null;switch(t){case"setLineDash":return typeof n.setLineDash<"u";default:return null}}}),d.StaticCanvas.prototype.toJSON=d.StaticCanvas.prototype.toObject,d.isLikelyNode&&(d.StaticCanvas.prototype.createPNGStream=function(){var t=s(this.lowerCanvasEl);return t&&t.createPNGStream()},d.StaticCanvas.prototype.createJPEGStream=function(t){var e=s(this.lowerCanvasEl);return e&&e.createJPEGStream(t)})}}(),function(){var t=d.util.getPointer,e=d.util.degreesToRadians,n=d.util.isTouchEvent;for(var i in d.Canvas=d.util.createClass(d.StaticCanvas,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=d.PencilBrush&&new d.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e,n,i=this.getActiveObjects();if(i.length>0&&!this.preserveObjectStacking){e=[],n=[];for(var r=0,s=this._objects.length;r<s;r++)t=this._objects[r],-1===i.indexOf(t)?e.push(t):n.push(t);i.length>1&&(this._activeObject._objects=n),e.push.apply(e,n)}else e=this._objects;return e},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&this.renderTopLayer(this.contextTop);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this},_normalizePointer:function(t,e){var n=t.calcTransformMatrix(),i=d.util.invertTransform(n),r=this.restorePointerVpt(e);return d.util.transformPoint(r,i)},isTargetTransparent:function(t,e,n){if(t.shouldCache()&&t._cacheCanvas&&t!==this._activeObject){var i=this._normalizePointer(t,{x:e,y:n}),r=Math.max(t.cacheTranslationX+i.x*t.zoomX,0),s=Math.max(t.cacheTranslationY+i.y*t.zoomY,0);return d.util.isTransparent(t._cacheContext,Math.round(r),Math.round(s),this.targetFindTolerance)}var o=this.contextCache,a=t.selectionBackgroundColor,h=this.viewportTransform;return t.selectionBackgroundColor="",this.clearContext(o),o.save(),o.transform(h[0],h[1],h[2],h[3],h[4],h[5]),t.render(o),o.restore(),t.selectionBackgroundColor=a,d.util.isTransparent(o,e,n,this.targetFindTolerance)},_isSelectionKeyPressed:function(t){return"[object Array]"===Object.prototype.toString.call(this.selectionKey)?!!this.selectionKey.find((function(e){return!0===t[e]})):t[this.selectionKey]},_shouldClearSelection:function(t,e){var n=this.getActiveObjects(),i=this._activeObject;return!e||e&&i&&n.length>1&&-1===n.indexOf(e)&&i!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&i&&i!==e},_shouldCenterTransform:function(t,e,n){var i;if(t)return"scale"===e||"scaleX"===e||"scaleY"===e||"resizing"===e?i=this.centeredScaling||t.centeredScaling:"rotate"===e&&(i=this.centeredRotation||t.centeredRotation),i?!n:n},_getOriginFromCorner:function(t,e){var n={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?n.x="right":("mr"===e||"tr"===e||"br"===e)&&(n.x="left"),"tl"===e||"mt"===e||"tr"===e?n.y="bottom":("bl"===e||"mb"===e||"br"===e)&&(n.y="top"),n},_getActionFromCorner:function(t,e,n,i){if(!e||!t)return"drag";var r=i.controls[e];return r.getActionName(n,r,i)},_setupCurrentTransform:function(t,n,i){if(n){var r=this.getPointer(t),s=n.__corner,o=n.controls[s],a=i&&s?o.getActionHandler(t,n,o):d.controlsUtils.dragHandler,h=this._getActionFromCorner(i,s,t,n),c=this._getOriginFromCorner(n,s),u=t[this.centeredKey],l={target:n,action:h,actionHandler:a,corner:s,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:r.x-n.left,offsetY:r.y-n.top,originX:c.x,originY:c.y,ex:r.x,ey:r.y,lastX:r.x,lastY:r.y,theta:e(n.angle),width:n.width*n.scaleX,shiftKey:t.shiftKey,altKey:u,original:d.util.saveObjectTransform(n)};this._shouldCenterTransform(n,h,u)&&(l.originX="center",l.originY="center"),l.original.originX=c.x,l.original.originY=c.y,this._currentTransform=l,this._beforeTransform(t)}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var e=this._groupSelector,n=new d.Point(e.ex,e.ey),i=d.util.transformPoint(n,this.viewportTransform),r=new d.Point(e.ex+e.left,e.ey+e.top),s=d.util.transformPoint(r,this.viewportTransform),o=Math.min(i.x,s.x),a=Math.min(i.y,s.y),h=Math.max(i.x,s.x),c=Math.max(i.y,s.y),u=this.selectionLineWidth/2;this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(o,a,h-o,c-a)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,o+=u,a+=u,h-=u,c-=u,d.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(o,a,h-o,c-a))},findTarget:function(t,e){if(!this.skipTargetFind){var i,r,s=this.getPointer(t,!0),o=this._activeObject,a=this.getActiveObjects(),h=n(t),c=a.length>1&&!e||1===a.length;if(this.targets=[],c&&o._findTargetCorner(s,h)||a.length>1&&!e&&o===this._searchPossibleTargets([o],s))return o;if(1===a.length&&o===this._searchPossibleTargets([o],s)){if(!this.preserveObjectStacking)return o;i=o,r=this.targets,this.targets=[]}var u=this._searchPossibleTargets(this._objects,s);return t[this.altSelectionKey]&&u&&i&&u!==i&&(u=i,this.targets=r),u}},_checkTarget:function(t,e,n){if(e&&e.visible&&e.evented&&e.containsPoint(t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;if(!this.isTargetTransparent(e,n.x,n.y))return!0}},_searchPossibleTargets:function(t,e){for(var n,i,r=t.length;r--;){var s=t[r],o=s.group?this._normalizePointer(s.group,e):e;if(this._checkTarget(o,s,e)){(n=t[r]).subTargetCheck&&n instanceof d.Group&&((i=this._searchPossibleTargets(n._objects,e))&&this.targets.push(i));break}}return n},restorePointerVpt:function(t){return d.util.transformPoint(t,d.util.invertTransform(this.viewportTransform))},getPointer:function(e,n){if(this._absolutePointer&&!n)return this._absolutePointer;if(this._pointer&&n)return this._pointer;var i,r=t(e),s=this.upperCanvasEl,o=s.getBoundingClientRect(),a=o.width||0,h=o.height||0;(!a||!h)&&("top"in o&&"bottom"in o&&(h=Math.abs(o.top-o.bottom)),"right"in o&&"left"in o&&(a=Math.abs(o.right-o.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,n||(r=this.restorePointerVpt(r));var c=this.getRetinaScaling();return 1!==c&&(r.x/=c,r.y/=c),i=0===a||0===h?{width:1,height:1}:{width:s.width/a,height:s.height/h},{x:r.x*i.width,y:r.y*i.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),e=this.lowerCanvasEl,n=this.upperCanvasEl;n?n.className="":(n=this._createCanvasElement(),this.upperCanvasEl=n),d.util.addClass(n,"upper-canvas "+t),this.wrapperEl.appendChild(n),this._copyCanvasStyle(e,n),this._applyCanvasStyle(n),this.contextTop=n.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=d.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),d.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),d.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.width||t.width,n=this.height||t.height;d.util.setStyle(t,{position:"absolute",width:e+"px",height:n+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=e,t.height=n,d.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?"activeSelection"===t.type&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),t===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,e){var n=!1,i=this.getActiveObjects(),r=[],s=[];t.forEach((function(t){-1===i.indexOf(t)&&(n=!0,t.fire("deselected",{e:e,target:t}),s.push(t))})),i.forEach((function(i){-1===t.indexOf(i)&&(n=!0,i.fire("selected",{e:e,target:i}),r.push(i))})),t.length>0&&i.length>0?n&&this.fire("selection:updated",{e:e,selected:r,deselected:s,updated:r[0]||s[0],target:this._activeObject}):i.length>0?this.fire("selection:created",{e:e,selected:r,target:this._activeObject}):t.length>0&&this.fire("selection:cleared",{e:e,deselected:s})},setActiveObject:function(t,e){var n=this.getActiveObjects();return this._setActiveObject(t,e),this._fireSelectionEvents(n,e),this},_setActiveObject:function(t,e){return!(this._activeObject===t||!this._discardActiveObject(e,t)||t.onSelect({e:e}))&&(this._activeObject=t,!0)},_discardActiveObject:function(t,e){var n=this._activeObject;if(n){if(n.onDeselect({e:t,object:e}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var e=this.getActiveObjects(),n=this.getActiveObject();return e.length&&this.fire("before:selection:cleared",{target:n,e:t}),this._discardActiveObject(t),this._fireSelectionEvents(e,t),this},dispose:function(){var t=this.wrapperEl;return t?(this.removeListeners(),t.contains(this.upperCanvasEl)&&t.removeChild(this.upperCanvasEl),t.contains(this.lowerCanvasEl)&&t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(t){d.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,d.StaticCanvas.prototype.dispose.call(this),this):this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this._activeObject;e&&e._renderControls(t)},_toObject:function(t,e,n){var i=this._realizeGroupTransformOnObject(t),r=this.callSuper("_toObject",t,e,n);return this._unwindGroupTransformOnObject(t,i),r},_realizeGroupTransformOnObject:function(t){if(t.group&&"activeSelection"===t.group.type&&this._activeObject===t.group){var e={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach((function(n){e[n]=t[n]})),d.util.addTransformToObject(t,this._activeObject.calcOwnMatrix()),e}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,n){var i=this._realizeGroupTransformOnObject(e);this.callSuper("_setSVGObject",t,e,n),this._unwindGroupTransformOnObject(e,i)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),d.StaticCanvas.prototype.setViewportTransform.call(this,t)}}),d.StaticCanvas)"prototype"!==i&&(d.Canvas[i]=d.StaticCanvas[i])}(),function(){var t=d.util.addListener,e=d.util.removeListener,n={passive:!1};function i(t,e){return t.button&&t.button===e-1}d.util.object.extend(d.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(t,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(t,e){var i=this.upperCanvasEl,r=this._getEventPrefix();t(d.window,"resize",this._onResize),t(i,r+"down",this._onMouseDown),t(i,r+"move",this._onMouseMove,n),t(i,r+"out",this._onMouseOut),t(i,r+"enter",this._onMouseEnter),t(i,"wheel",this._onMouseWheel),t(i,"contextmenu",this._onContextMenu),t(i,"dblclick",this._onDoubleClick),t(i,"dragover",this._onDragOver),t(i,"dragenter",this._onDragEnter),t(i,"dragleave",this._onDragLeave),t(i,"drop",this._onDrop),this.enablePointerEvents||t(i,"touchstart",this._onTouchStart,n),typeof eventjs<"u"&&e in eventjs&&(eventjs[e](i,"gesture",this._onGesture),eventjs[e](i,"drag",this._onDrag),eventjs[e](i,"orientation",this._onOrientationChange),eventjs[e](i,"shake",this._onShake),eventjs[e](i,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var t=this._getEventPrefix();e(d.document,t+"up",this._onMouseUp),e(d.document,"touchend",this._onTouchEnd,n),e(d.document,t+"move",this._onMouseMove,n),e(d.document,"touchmove",this._onMouseMove,n)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._simpleEventHandler.bind(this,"drop"),this.eventsBound=!0)},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var e=this._hoveredTarget;this.fire("mouse:out",{target:e,e:t}),this._hoveredTarget=null,e&&e.fire("mouseout",{e:t});var n=this;this._hoveredTargets.forEach((function(i){n.fire("mouse:out",{target:e,e:t}),i&&e.fire("mouseout",{e:t})})),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach((function(t){t.isEditing&&t.hiddenTextarea.focus()}))},_onMouseEnter:function(t){!this._currentTransform&&!this.findTarget(t)&&(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onDragOver:function(t){t.preventDefault();var e=this._simpleEventHandler("dragover",t);this._fireEnterLeaveEvents(e,t)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData(t)},getPointerId:function(t){var e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1},_isMainEvent:function(t){return!0===t.isPrimary||!1!==t.isPrimary&&("touchend"===t.type&&0===t.touches.length||(!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId))},_onTouchStart:function(i){i.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(i)),this.__onMouseDown(i),this._resetTransformEventData();var r=this.upperCanvasEl,s=this._getEventPrefix();t(d.document,"touchend",this._onTouchEnd,n),t(d.document,"touchmove",this._onMouseMove,n),e(r,s+"down",this._onMouseDown)},_onMouseDown:function(i){this.__onMouseDown(i),this._resetTransformEventData();var r=this.upperCanvasEl,s=this._getEventPrefix();e(r,s+"move",this._onMouseMove,n),t(d.document,s+"up",this._onMouseUp),t(d.document,s+"move",this._onMouseMove,n)},_onTouchEnd:function(i){if(!(i.touches.length>0)){this.__onMouseUp(i),this._resetTransformEventData(),this.mainTouchId=null;var r=this._getEventPrefix();e(d.document,"touchend",this._onTouchEnd,n),e(d.document,"touchmove",this._onMouseMove,n);var s=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((function(){t(s.upperCanvasEl,r+"down",s._onMouseDown),s._willAddMouseDown=0}),400)}},_onMouseUp:function(i){this.__onMouseUp(i),this._resetTransformEventData();var r=this.upperCanvasEl,s=this._getEventPrefix();this._isMainEvent(i)&&(e(d.document,s+"up",this._onMouseUp),e(d.document,s+"move",this._onMouseMove,n),t(r,s+"move",this._onMouseMove,n))},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t){var e=this._activeObject;return!!(!!e!=!!t||e&&t&&e!==t)||(e&&e.isEditing,!1)},__onMouseUp:function(t){var e,n=this._currentTransform,r=this._groupSelector,s=!1,o=!r||0===r.left&&0===r.top;if(this._cacheTransformEventData(t),e=this._target,this._handleEvent(t,"up:before"),i(t,3))this.fireRightClick&&this._handleEvent(t,"up",3,o);else{if(i(t,2))return this.fireMiddleClick&&this._handleEvent(t,"up",2,o),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(t);else if(this._isMainEvent(t)){if(n&&(this._finalizeCurrentTransform(t),s=n.actionPerformed),!o){var a=e===this._activeObject;this._maybeGroupObjects(t),s||(s=this._shouldRender(e)||!a&&e===this._activeObject)}if(e){if(e.selectable&&e!==this._activeObject&&"up"===e.activeOn)this.setActiveObject(e,t),s=!0;else{var h=e._findTargetCorner(this.getPointer(t,!0),d.util.isTouchEvent(t)),c=e.controls[h],u=c&&c.getMouseUpHandler(t,e,c);if(u){var l=this.getPointer(t);u(t,n,l.x,l.y)}}e.isMoving=!1}this._setCursorFromEvent(t,e),this._handleEvent(t,"up",1,o),this._groupSelector=null,this._currentTransform=null,e&&(e.__corner=0),s?this.requestRenderAll():o||this.renderTop()}}},_simpleEventHandler:function(t,e){var n=this.findTarget(e),i=this.targets,r={e:e,target:n,subTargets:i};if(this.fire(t,r),n&&n.fire(t,r),!i)return n;for(var s=0;s<i.length;s++)i[s].fire(t,r);return n},_handleEvent:function(t,e,n,i){var r=this._target,s=this.targets||[],o={e:t,target:r,subTargets:s,button:n||1,isClick:i||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===e&&(o.currentTarget=this.findTarget(t),o.currentSubTargets=this.targets),this.fire("mouse:"+e,o),r&&r.fire("mouse"+e,o);for(var a=0;a<s.length;a++)s[a].fire("mouse"+e,o)},_finalizeCurrentTransform:function(t){var e,n=this._currentTransform,i=n.target,r={e:t,target:i,transform:n,action:n.action};i._scaling&&(i._scaling=!1),i.setCoords(),(n.actionPerformed||this.stateful&&i.hasStateChanged())&&(n.actionPerformed&&(e=this._addEventOptions(r,n),this._fire(e,r)),this._fire("modified",r))},_addEventOptions:function(t,e){var n,i;switch(e.action){case"scaleX":n="scaled",i="x";break;case"scaleY":n="scaled",i="y";break;case"skewX":n="skewed",i="x";break;case"skewY":n="skewed",i="y";break;case"scale":n="scaled",i="equally";break;case"rotate":n="rotated";break;case"drag":n="moved"}return t.by=i,n},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(t).requestRenderAll();var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=this.getPointer(t);this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){var e=this.getPointer(t);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:t,pointer:e}),this._handleEvent(t,"up")},__onMouseDown:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"down:before");var e=this._target;if(i(t,3))this.fireRightClick&&this._handleEvent(t,"down",3);else if(i(t,2))this.fireMiddleClick&&this._handleEvent(t,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(t);else if(this._isMainEvent(t)&&!this._currentTransform){var n=this._pointer;this._previousPointer=n;var r=this._shouldRender(e),s=this._shouldGroup(t,e);if(this._shouldClearSelection(t,e)?this.discardActiveObject(t):s&&(this._handleGrouping(t,e),e=this._activeObject),this.selection&&(!e||!e.selectable&&!e.isEditing&&e!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),e){var o=e===this._activeObject;e.selectable&&"down"===e.activeOn&&this.setActiveObject(e,t);var a=e._findTargetCorner(this.getPointer(t,!0),d.util.isTouchEvent(t));if(e.__corner=a,e===this._activeObject&&(a||!s)){this._setupCurrentTransform(t,e,o);var h=e.controls[a],c=(n=this.getPointer(t),h&&h.getMouseDownHandler(t,e,h));c&&c(t,this._currentTransform,n.x,n.y)}}this._handleEvent(t,"down"),(r||s)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(t){this._resetTransformEventData(),this._pointer=this.getPointer(t,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)||null},_beforeTransform:function(t){var e=this._currentTransform;this.stateful&&e.target.saveState(),this.fire("before:transform",{e:t,transform:e})},__onMouseMove:function(t){var e,n;if(this._handleEvent(t,"move:before"),this._cacheTransformEventData(t),this.isDrawingMode)this._onMouseMoveInDrawingMode(t);else if(this._isMainEvent(t)){var i=this._groupSelector;i?(n=this._absolutePointer,i.left=n.x-i.ex,i.top=n.y-i.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t)||null,this._setCursorFromEvent(t,e),this._fireOverOutEvents(e,t)),this._handleEvent(t,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(t,e){var n=this._hoveredTarget,i=this._hoveredTargets,r=this.targets,s=Math.max(i.length,r.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:n,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var o=0;o<s;o++)this.fireSyntheticInOutEvents(r[o],e,{oldTarget:i[o],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(t,e){var n=this._draggedoverTarget,i=this._hoveredTargets,r=this.targets,s=Math.max(i.length,r.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:n,evtOut:"dragleave",evtIn:"dragenter"});for(var o=0;o<s;o++)this.fireSyntheticInOutEvents(r[o],e,{oldTarget:i[o],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=t},fireSyntheticInOutEvents:function(t,e,n){var i,r,s,o=n.oldTarget,a=o!==t,h=n.canvasEvtIn,c=n.canvasEvtOut;a&&(i={e:e,target:t,previousTarget:o},r={e:e,target:o,nextTarget:t}),s=t&&a,o&&a&&(c&&this.fire(c,r),o.fire(n.evtOut,r)),s&&(h&&this.fire(h,i),t.fire(n.evtIn,i))},__onMouseWheel:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()},_transformObject:function(t){var e=this.getPointer(t),n=this._currentTransform;n.reset=!1,n.shiftKey=t.shiftKey,n.altKey=t[this.centeredKey],this._performTransformAction(t,n,e),n.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,e,n){var i=n.x,r=n.y,s=e.action,o=!1,a=e.actionHandler;a&&(o=a(t,e,i,r)),"drag"===s&&o&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||o},_fire:d.controlsUtils.fireEvent,_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var n=e.hoverCursor||this.hoverCursor,i=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,r=(!i||!i.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));r?this.setCursor(this.getCornerCursor(r,e,t)):(e.subTargetCheck&&this.targets.concat().reverse().map((function(t){n=t.hoverCursor||n})),this.setCursor(n))},getCornerCursor:function(t,e,n){var i=e.controls[t];return i.cursorStyleHandler(n,i,e)}})}(),function(){var t=Math.min,e=Math.max;d.util.object.extend(d.Canvas.prototype,{_shouldGroup:function(t,e){var n=this._activeObject;return n&&this._isSelectionKeyPressed(t)&&e&&e.selectable&&this.selection&&(n!==e||"activeSelection"===n.type)&&!e.onSelect({e:t})},_handleGrouping:function(t,e){var n=this._activeObject;n.__corner||e===n&&(!(e=this.findTarget(t,!0))||!e.selectable)||(n&&"activeSelection"===n.type?this._updateActiveSelection(e,t):this._createActiveSelection(e,t))},_updateActiveSelection:function(t,e){var n=this._activeObject,i=n._objects.slice(0);n.contains(t)?(n.removeWithUpdate(t),this._hoveredTarget=t,this._hoveredTargets=this.targets.concat(),1===n.size()&&this._setActiveObject(n.item(0),e)):(n.addWithUpdate(t),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(i,e)},_createActiveSelection:function(t,e){var n=this.getActiveObjects(),i=this._createGroup(t);this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents(n,e)},_createGroup:function(t){var e=this._objects,n=e.indexOf(this._activeObject)<e.indexOf(t)?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new d.ActiveSelection(n,{canvas:this})},_groupSelectedObjects:function(t){var e,n=this._collectObjects(t);1===n.length?this.setActiveObject(n[0],t):n.length>1&&(e=new d.ActiveSelection(n.reverse(),{canvas:this}),this.setActiveObject(e,t))},_collectObjects:function(n){for(var i,r=[],s=this._groupSelector.ex,o=this._groupSelector.ey,a=s+this._groupSelector.left,h=o+this._groupSelector.top,c=new d.Point(t(s,a),t(o,h)),u=new d.Point(e(s,a),e(o,h)),l=!this.selectionFullyContained,f=s===a&&o===h,p=this._objects.length;p--&&!((i=this._objects[p])&&i.selectable&&i.visible&&(l&&i.intersectsWithRect(c,u,!0)||i.isContainedWithinRect(c,u,!0)||l&&i.containsPoint(c,null,!0)||l&&i.containsPoint(u,null,!0))&&(r.push(i),f)););return r.length>1&&(r=r.filter((function(t){return!t.onSelect({e:n})}))),r},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),d.util.object.extend(d.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",n=t.quality||1,i=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),r=this.toCanvasElement(i,t);return d.util.toDataURL(r,e,n)},toCanvasElement:function(t,e){t=t||1;var n=((e=e||{}).width||this.width)*t,i=(e.height||this.height)*t,r=this.getZoom(),s=this.width,o=this.height,a=r*t,h=this.viewportTransform,c=(h[4]-(e.left||0))*t,u=(h[5]-(e.top||0))*t,l=this.interactive,f=[a,0,0,a,c,u],p=this.enableRetinaScaling,g=d.util.createCanvasElement(),v=this.contextTop;return g.width=n,g.height=i,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=f,this.width=n,this.height=i,this.calcViewportBoundaries(),this.renderCanvas(g.getContext("2d"),this._objects),this.viewportTransform=h,this.width=s,this.height=o,this.calcViewportBoundaries(),this.interactive=l,this.enableRetinaScaling=p,this.contextTop=v,g}}),function(t){var e=t.fabric||(t.fabric={}),n=e.util.object.extend,i=e.util.object.clone,r=e.util.toFixed,s=e.util.string.capitalize,o=e.util.degreesToRadians,a=!e.isLikelyNode;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:a,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(t){var n=e.perfLimitSizeTotal,i=t.width,r=t.height,s=e.maxCacheSideLimit,o=e.minCacheSideLimit;if(i<=s&&r<=s&&i*r<=n)return i<o&&(t.width=o),r<o&&(t.height=o),t;var a=i/r,h=e.util.limitDimsByArea(a,n),c=e.util.capValue,u=c(o,h.x,s),l=c(o,h.y,s);return i>u&&(t.zoomX/=i/u,t.width=u,t.capped=!0),r>l&&(t.zoomY/=r/l,t.height=l,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.getTotalObjectScaling(),e=this._getTransformedDimensions(0,0),n=e.x*t.scaleX/this.scaleX,i=e.y*t.scaleY/this.scaleY;return{width:n+2,height:i+2,zoomX:t.scaleX,zoomY:t.scaleY,x:n,y:i}},_updateCacheCanvas:function(){var t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){var n=t._currentTransform.target,i=t._currentTransform.action;if(this===n&&i.slice&&"scale"===i.slice(0,5))return!1}var r,s,o=this._cacheCanvas,a=this._limitCacheSize(this._getCacheCanvasDimensions()),h=e.minCacheSideLimit,c=a.width,u=a.height,l=a.zoomX,d=a.zoomY,f=c!==this.cacheWidth||u!==this.cacheHeight,p=this.zoomX!==l||this.zoomY!==d,g=f||p,v=0,_=0,b=!1;if(f){var m=this._cacheCanvas.width,y=this._cacheCanvas.height,O=c>m||u>y;b=O||(c<.9*m||u<.9*y)&&m>h&&y>h,O&&!a.capped&&(c>h||u>h)&&(v=.1*c,_=.1*u)}return this instanceof e.Text&&this.path&&(g=!0,b=!0,v+=this.getHeightOfLine(0)*this.zoomX,_+=this.getHeightOfLine(0)*this.zoomY),!!g&&(b?(o.width=Math.ceil(c+v),o.height=Math.ceil(u+_)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,o.width,o.height)),r=a.x/2,s=a.y/2,this.cacheTranslationX=Math.round(o.width/2-r)+r,this.cacheTranslationY=Math.round(o.height/2-s)+s,this.cacheWidth=c,this.cacheHeight=u,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(l,d),this.zoomX=l,this.zoomY=d,!0)},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,n=this.calcTransformMatrix(!e);t.transform(n[0],n[1],n[2],n[3],n[4],n[5])},toObject:function(t){var n=e.Object.NUM_FRACTION_DIGITS,i={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:r(this.left,n),top:r(this.top,n),width:r(this.width,n),height:r(this.height,n),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,n),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:r(this.strokeMiterLimit,n),scaleX:r(this.scaleX,n),scaleY:r(this.scaleY,n),angle:r(this.angle,n),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,n),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:r(this.skewX,n),skewY:r(this.skewY,n)};return this.clipPath&&!this.clipPath.excludeFromExport&&(i.clipPath=this.clipPath.toObject(t),i.clipPath.inverted=this.clipPath.inverted,i.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,i,t),this.includeDefaultValues||(i=this._removeDefaultValues(i)),i},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var n=e.util.getKlass(t.type).prototype;return n.stateProperties.forEach((function(e){"left"!==e&&"top"!==e&&(t[e]===n[e]&&delete t[e],"[object Array]"===Object.prototype.toString.call(t[e])&&"[object Array]"===Object.prototype.toString.call(n[e])&&0===t[e].length&&0===n[e].length&&delete t[e])})),t},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var t=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(t.scaleX),scaleY:Math.abs(t.scaleY)}},getTotalObjectScaling:function(){var t=this.getObjectScaling(),e=t.scaleX,n=t.scaleY;if(this.canvas){var i=this.canvas.getZoom(),r=this.canvas.getRetinaScaling();e*=i*r,n*=i*r}return{scaleX:e,scaleY:n}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,n){var i="scaleX"===t||"scaleY"===t,r=this[t]!==n,s=!1;return i&&(n=this._constrainScale(n)),"scaleX"===t&&n<0?(this.flipX=!this.flipX,n*=-1):"scaleY"===t&&n<0?(this.flipY=!this.flipY,n*=-1):"shadow"!==t||!n||n instanceof e.Shadow?"dirty"===t&&this.group&&this.group.set("dirty",n):n=new e.Shadow(n),this[t]=n,r&&(s=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(t)>-1?(this.dirty=!0,s&&this.group.set("dirty",!0)):s&&this.stateProperties.indexOf(t)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),t.restore())},renderCache:function(t){t=t||{},this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,t.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!!("stroke"===this.paintFirst&&this.hasFill()&&this.hasStroke()&&"object"==typeof this.shadow||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(t){var n=this.clipPath;if(t.save(),n.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",n.absolutePositioned){var i=e.util.invertTransform(this.calcTransformMatrix());t.transform(i[0],i[1],i[2],i[3],i[4],i[5])}n.transform(t),t.scale(1/n.zoomX,1/n.zoomY),t.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),t.restore()},drawObject:function(t,e){var n=this.fill,i=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t),this.fill=n,this.stroke=i},_drawClipPath:function(t){var e=this.clipPath;e&&(e.canvas=this.canvas,e.shouldCache(),e._transformDone=!0,e.renderCache({forClipping:!0}),this.drawClipPathOnCache(t))},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){if(this.isNotVisible())return!1;if(this._cacheCanvas&&!t&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&!t){var e=this.cacheWidth/this.zoomX,n=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-n/2,e,n)}return!0}return!1},_renderBackground:function(t){if(this.backgroundColor){var e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){var n=e.stroke;n&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,n.toLive?"percentage"===n.gradientUnits||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(t,n):(t.strokeStyle=n.toLive(t,this),this._applyPatternGradientTransform(t,n)):t.strokeStyle=e.stroke)},_setFillStyles:function(t,e){var n=e.fill;n&&(n.toLive?(t.fillStyle=n.toLive(t,this),this._applyPatternGradientTransform(t,e.fill)):t.fillStyle=n)},_setClippingProperties:function(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"},_setLineDash:function(t,e){!e||0===e.length||(1&e.length&&e.push.apply(e,e),t.setLineDash(e))},_renderControls:function(t,n){var i,r,s,a=this.getViewportTransform(),h=this.calcTransformMatrix();r=typeof(n=n||{}).hasBorders<"u"?n.hasBorders:this.hasBorders,s=typeof n.hasControls<"u"?n.hasControls:this.hasControls,h=e.util.multiplyTransformMatrices(a,h),i=e.util.qrDecompose(h),t.save(),t.translate(i.translateX,i.translateY),t.lineWidth=1*this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),t.rotate(o(i.angle)),n.forActiveSelection||this.group?r&&this.drawBordersInGroup(t,i,n):r&&this.drawBorders(t,n),s&&this.drawControls(t,n),t.restore()},_setShadow:function(t){if(this.shadow){var n,i=this.shadow,r=this.canvas,s=r&&r.viewportTransform[0]||1,o=r&&r.viewportTransform[3]||1;n=i.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),r&&r._isRetinaScaling()&&(s*=e.devicePixelRatio,o*=e.devicePixelRatio),t.shadowColor=i.color,t.shadowBlur=i.blur*e.browserShadowBlurConstant*(s+o)*(n.scaleX+n.scaleY)/4,t.shadowOffsetX=i.offsetX*s*n.scaleX,t.shadowOffsetY=i.offsetY*o*n.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,e){if(!e||!e.toLive)return{offsetX:0,offsetY:0};var n=e.gradientTransform||e.patternTransform,i=-this.width/2+e.offsetX||0,r=-this.height/2+e.offsetY||0;return"percentage"===e.gradientUnits?t.transform(this.width,0,0,this.height,i,r):t.transform(1,0,0,1,i,r),n&&t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:i,offsetY:r}},_renderPaintInOrder:function(t){"stroke"===this.paintFirst?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_render:function(){},_renderFill:function(t){this.fill&&(t.save(),this._setFillStyles(t,this),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform&&this.group){var e=this.getObjectScaling();t.scale(1/e.scaleX,1/e.scaleY)}else this.strokeUniform&&t.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}},_applyPatternForTransformedGradient:function(t,n){var i,r=this._limitCacheSize(this._getCacheCanvasDimensions()),s=e.util.createCanvasElement(),o=this.canvas.getRetinaScaling(),a=r.x/this.scaleX/o,h=r.y/this.scaleY/o;s.width=a,s.height=h,(i=s.getContext("2d")).beginPath(),i.moveTo(0,0),i.lineTo(a,0),i.lineTo(a,h),i.lineTo(0,h),i.closePath(),i.translate(a/2,h/2),i.scale(r.zoomX/this.scaleX/o,r.zoomY/this.scaleY/o),this._applyPatternGradientTransform(i,n),i.fillStyle=n.toLive(t),i.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(o*this.scaleX/r.zoomX,o*this.scaleY/r.zoomY),t.strokeStyle=i.createPattern(s,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var t=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0}},_removeTransformMatrix:function(t){var n=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),n=e.util.transformPoint(n,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,n.x+=t.offsetLeft,n.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(n,"center","center")},clone:function(t,n){var i=this.toObject(n);this.constructor.fromObject?this.constructor.fromObject(i,t):e.Object._fromObject("Object",i,t)},cloneAsImage:function(t,n){var i=this.toCanvasElement(n);return t&&t(new e.Image(i)),this},toCanvasElement:function(t){t||(t={});var n=e.util,i=n.saveObjectTransform(this),r=this.group,s=this.shadow,o=Math.abs,a=(t.multiplier||1)*(t.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,t.withoutTransform&&n.resetObjectTransform(this),t.withoutShadow&&(this.shadow=null);var h,c,u,l,d=e.util.createCanvasElement(),f=this.getBoundingRect(!0,!0),p=this.shadow,g={x:0,y:0};p&&(c=p.blur,h=p.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),g.x=2*Math.round(o(p.offsetX)+c)*o(h.scaleX),g.y=2*Math.round(o(p.offsetY)+c)*o(h.scaleY)),u=f.width+g.x,l=f.height+g.y,d.width=Math.ceil(u),d.height=Math.ceil(l);var v=new e.StaticCanvas(d,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===t.format&&(v.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(v.width/2,v.height/2),"center","center");var _=this.canvas;v.add(this);var b=v.toCanvasElement(a||1,t);return this.shadow=s,this.set("canvas",_),r&&(this.group=r),this.set(i).setCoords(),v._objects=[],v.dispose(),v=null,b},toDataURL:function(t){return t||(t={}),e.util.toDataURL(this.toCanvasElement(t),t.format||"png",t.quality||1)},isType:function(t){return this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},rotate:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,n){n=n||this.canvas.getPointer(t);var i=new e.Point(n.x,n.y),r=this._getLeftTopCoords();return this.angle&&(i=e.util.rotatePoint(i,r,o(-this.angle))),{x:i.x-r.x,y:i.y-r.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),n(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object._fromObject=function(t,n,r,s){var o=e[t];n=i(n,!0),e.util.enlivenPatterns([n.fill,n.stroke],(function(t){typeof t[0]<"u"&&(n.fill=t[0]),typeof t[1]<"u"&&(n.stroke=t[1]),e.util.enlivenObjects([n.clipPath],(function(t){n.clipPath=t[0];var e=s?new o(n[s],n):new o(n);r&&r(e)}))}))},e.Object.__uid=0)}(typeof f<"u"?f:void 0),function(){var t=d.util.degreesToRadians,e={left:-.5,center:0,right:.5},n={top:-.5,center:0,bottom:.5};d.util.object.extend(d.Object.prototype,{translateToGivenOrigin:function(t,i,r,s,o){var a,h,c,u=t.x,l=t.y;return"string"==typeof i?i=e[i]:i-=.5,"string"==typeof s?s=e[s]:s-=.5,"string"==typeof r?r=n[r]:r-=.5,"string"==typeof o?o=n[o]:o-=.5,h=o-r,((a=s-i)||h)&&(c=this._getTransformedDimensions(),u=t.x+a*c.x,l=t.y+h*c.y),new d.Point(u,l)},translateToCenterPoint:function(e,n,i){var r=this.translateToGivenOrigin(e,n,i,"center","center");return this.angle?d.util.rotatePoint(r,e,t(this.angle)):r},translateToOriginPoint:function(e,n,i){var r=this.translateToGivenOrigin(e,"center","center",n,i);return this.angle?d.util.rotatePoint(r,e,t(this.angle)):r},getCenterPoint:function(){var t=new d.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var n=this.getCenterPoint();return this.translateToOriginPoint(n,t,e)},toLocalPoint:function(e,n,i){var r,s,o=this.getCenterPoint();return r=typeof n<"u"&&typeof i<"u"?this.translateToGivenOrigin(o,"center","center",n,i):new d.Point(this.left,this.top),s=new d.Point(e.x,e.y),this.angle&&(s=d.util.rotatePoint(s,o,-t(this.angle))),s.subtractEquals(r)},setPositionByOrigin:function(t,e,n){var i=this.translateToCenterPoint(t,e,n),r=this.translateToOriginPoint(i,this.originX,this.originY);this.set("left",r.x),this.set("top",r.y)},adjustPosition:function(n){var i,r,s=t(this.angle),o=this.getScaledWidth(),a=d.util.cos(s)*o,h=d.util.sin(s)*o;i="string"==typeof this.originX?e[this.originX]:this.originX-.5,r="string"==typeof n?e[n]:n-.5,this.left+=a*(r-i),this.top+=h*(r-i),this.setCoords(),this.originX=n},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){var t=d.util,e=t.degreesToRadians,n=t.multiplyTransformMatrices,i=t.transformPoint;t.object.extend(d.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(t,e){return e?t?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),t?this.aCoords:this.lineCoords)},getCoords:function(t,e){return function(t){return[new d.Point(t.tl.x,t.tl.y),new d.Point(t.tr.x,t.tr.y),new d.Point(t.br.x,t.br.y),new d.Point(t.bl.x,t.bl.y)]}(this._getCoords(t,e))},intersectsWithRect:function(t,e,n,i){var r=this.getCoords(n,i);return"Intersection"===d.Intersection.intersectPolygonRectangle(r,t,e).status},intersectsWithObject:function(t,e,n){return"Intersection"===d.Intersection.intersectPolygonPolygon(this.getCoords(e,n),t.getCoords(e,n)).status||t.isContainedWithinObject(this,e,n)||this.isContainedWithinObject(t,e,n)},isContainedWithinObject:function(t,e,n){for(var i=this.getCoords(e,n),r=e?t.aCoords:t.lineCoords,s=0,o=t._getImageLines(r);s<4;s++)if(!t.containsPoint(i[s],o))return!1;return!0},isContainedWithinRect:function(t,e,n,i){var r=this.getBoundingRect(n,i);return r.left>=t.x&&r.left+r.width<=e.x&&r.top>=t.y&&r.top+r.height<=e.y},containsPoint:function(t,e,n,i){var r=this._getCoords(n,i),s=(e=e||this._getImageLines(r),this._findCrossPoints(t,e));return 0!==s&&s%2==1},isOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br;return!(!this.getCoords(!0,t).some((function(t){return t.x<=n.x&&t.x>=e.x&&t.y<=n.y&&t.y>=e.y}))&&!this.intersectsWithRect(e,n,!0,t))||this._containsCenterOfCanvas(e,n,t)},_containsCenterOfCanvas:function(t,e,n){var i={x:(t.x+e.x)/2,y:(t.y+e.y)/2};return!!this.containsPoint(i,null,!0,n)},isPartiallyOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br;return!!this.intersectsWithRect(e,n,!0,t)||this.getCoords(!0,t).every((function(t){return(t.x>=n.x||t.x<=e.x)&&(t.y>=n.y||t.y<=e.y)}))&&this._containsCenterOfCanvas(e,n,t)},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var n,i,r,s,o,a=0;for(var h in e)if(!((o=e[h]).o.y<t.y&&o.d.y<t.y||o.o.y>=t.y&&o.d.y>=t.y||(o.o.x===o.d.x&&o.o.x>=t.x?s=o.o.x:(0,n=(o.d.y-o.o.y)/(o.d.x-o.o.x),i=t.y-0*t.x,r=o.o.y-n*o.o.x,s=-(i-r)/(0-n)),s>=t.x&&(a+=1),2!==a)))break;return a},getBoundingRect:function(e,n){var i=this.getCoords(e,n);return t.makeBoundingBoxFromPoints(i)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:0===t?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,e){var n=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(t/this.width/n)},scaleToHeight:function(t,e){var n=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(t/this.height/n)},calcCoords:function(t){return t?this.calcACoords():this.calcOCoords()},calcLineCoords:function(){var n=this.getViewportTransform(),r=this.padding,s=e(this.angle),o=t.cos(s)*r,a=t.sin(s)*r,h=o+a,c=o-a,u=this.calcACoords(),l={tl:i(u.tl,n),tr:i(u.tr,n),bl:i(u.bl,n),br:i(u.br,n)};return r&&(l.tl.x-=c,l.tl.y-=h,l.tr.x+=h,l.tr.y-=c,l.bl.x-=h,l.bl.y+=c,l.br.x+=c,l.br.y+=h),l},calcOCoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),i=this.getViewportTransform(),r=n(i,e),s=n(r,t),o=(s=n(s,[1/i[0],0,0,1/i[3],0,0]),this._calculateCurrentDimensions()),a={};return this.forEachControl((function(t,e,n){a[e]=t.positionHandler(o,s,n)})),a},calcACoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),r=n(e,t),s=this._getTransformedDimensions(),o=s.x/2,a=s.y/2;return{tl:i({x:-o,y:-a},r),tr:i({x:o,y:-a},r),bl:i({x:-o,y:a},r),br:i({x:o,y:a},r)}},setCoords:function(t){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),t||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return t.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var t=this.getCenterPoint();return[1,0,0,1,t.x,t.y]},transformMatrixKey:function(t){var e="_",n="";return!t&&this.group&&(n=this.group.transformMatrixKey(t)+e),n+this.top+e+this.left+e+this.scaleX+e+this.scaleY+e+this.skewX+e+this.skewY+e+this.angle+e+this.originX+e+this.originY+e+this.width+e+this.height+e+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(t){var e=this.calcOwnMatrix();if(t||!this.group)return e;var i=this.transformMatrixKey(t),r=this.matrixCache||(this.matrixCache={});return r.key===i?r.value:(this.group&&(e=n(this.group.calcTransformMatrix(!1),e)),r.key=i,r.value=e,e)},calcOwnMatrix:function(){var e=this.transformMatrixKey(!0),n=this.ownMatrixCache||(this.ownMatrixCache={});if(n.key===e)return n.value;var i=this._calcTranslateMatrix(),r={angle:this.angle,translateX:i[4],translateY:i[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return n.key=e,n.value=t.composeMatrix(r),n.value},_calcDimensionsTransformMatrix:function(e,n,i){return t.calcDimensionsMatrix({skewX:e,skewY:n,scaleX:this.scaleX*(i&&this.flipX?-1:1),scaleY:this.scaleY*(i&&this.flipY?-1:1)})},_getNonTransformedDimensions:function(){var t=this.strokeWidth;return{x:this.width+t,y:this.height+t}},_getTransformedDimensions:function(e,n){typeof e>"u"&&(e=this.skewX),typeof n>"u"&&(n=this.skewY);var i,r,s,o=0===e&&0===n;if(this.strokeUniform?(r=this.width,s=this.height):(r=(i=this._getNonTransformedDimensions()).x,s=i.y),o)return this._finalizeDimensions(r*this.scaleX,s*this.scaleY);var a=t.sizeAfterTransform(r,s,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:e,skewY:n});return this._finalizeDimensions(a.x,a.y)},_finalizeDimensions:function(t,e){return this.strokeUniform?{x:t+this.strokeWidth,y:e+this.strokeWidth}:{x:t,y:e}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions();return i(e,t,!0).scalarAdd(2*this.padding)}})}(),d.util.object.extend(d.Object.prototype,{sendToBack:function(){return this.group?d.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?d.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?d.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas&&this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?d.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas&&this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&"activeSelection"!==this.group.type?d.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas&&this.canvas.moveTo(this,t),this}}),function(){var t=d.util.object.extend,e="stateProperties";function n(e,n,i){var r={};i.forEach((function(t){r[t]=e[t]})),t(e[n],r,!0)}d.util.object.extend(d.Object.prototype,{hasStateChanged:function(t){var n="_"+(t=t||e);return Object.keys(this[n]).length<this[t].length||!function t(e,n,i){if(e===n)return!0;if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var r=0,s=e.length;r<s;r++)if(!t(e[r],n[r]))return!1;return!0}if(e&&"object"==typeof e){var o,a=Object.keys(e);if(!n||"object"!=typeof n||!i&&a.length!==Object.keys(n).length)return!1;for(r=0,s=a.length;r<s;r++)if("canvas"!==(o=a[r])&&"group"!==o&&!t(e[o],n[o]))return!1;return!0}}(this[n],this,!0)},saveState:function(t){var i=t&&t.propertySet||e,r="_"+i;return this[r]?(n(this,r,this[i]),t&&t.stateProperties&&n(this,r,t.stateProperties),this):this.setupState(t)},setupState:function(t){var n=(t=t||{}).propertySet||e;return t.propertySet=n,this["_"+n]={},this.saveState(t),this}})}(),function(){var t=d.util.degreesToRadians;d.util.object.extend(d.Object.prototype,{_findTargetCorner:function(t,e){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var n,i,r,s=t.x,o=t.y,a=Object.keys(this.oCoords),h=a.length-1;for(this.__corner=0;h>=0;h--)if(r=a[h],this.isControlVisible(r)&&(i=this._getImageLines(e?this.oCoords[r].touchCorner:this.oCoords[r].corner),0!==(n=this._findCrossPoints({x:s,y:o},i))&&n%2==1))return this.__corner=r,r;return!1},forEachControl:function(t){for(var e in this.controls)t(this.controls[e],e,this)},_setCornerCoords:function(){var t=this.oCoords;for(var e in t){var n=this.controls[e];t[e].corner=n.calcCornerCoords(this.angle,this.cornerSize,t[e].x,t[e].y,!1),t[e].touchCorner=n.calcCornerCoords(this.angle,this.touchCornerSize,t[e].x,t[e].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var n=this.getCenterPoint(),i=this._calculateCurrentDimensions(),r=this.canvas.viewportTransform;return e.translate(n.x,n.y),e.scale(1/r[0],1/r[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-i.x/2,-i.y/2,i.x,i.y),e.restore(),this},drawBorders:function(t,e){e=e||{};var n=this._calculateCurrentDimensions(),i=this.borderScaleFactor,r=n.x+i,s=n.y+i,o=typeof e.hasControls<"u"?e.hasControls:this.hasControls,a=!1;return t.save(),t.strokeStyle=e.borderColor||this.borderColor,this._setLineDash(t,e.borderDashArray||this.borderDashArray),t.strokeRect(-r/2,-s/2,r,s),o&&(t.beginPath(),this.forEachControl((function(e,n,i){e.withConnection&&e.getVisibility(i,n)&&(a=!0,t.moveTo(e.x*r,e.y*s),t.lineTo(e.x*r+e.offsetX,e.y*s+e.offsetY))})),a&&t.stroke()),t.restore(),this},drawBordersInGroup:function(t,e,n){n=n||{};var i=d.util.sizeAfterTransform(this.width,this.height,e),r=this.strokeWidth,s=this.strokeUniform,o=this.borderScaleFactor,a=i.x+r*(s?this.canvas.getZoom():e.scaleX)+o,h=i.y+r*(s?this.canvas.getZoom():e.scaleY)+o;return t.save(),this._setLineDash(t,n.borderDashArray||this.borderDashArray),t.strokeStyle=n.borderColor||this.borderColor,t.strokeRect(-a/2,-h/2,a,h),t.restore(),this},drawControls:function(t,e){e=e||{},t.save();var n,i,r=this.canvas.getRetinaScaling();return t.setTransform(r,0,0,r,0,0),t.strokeStyle=t.fillStyle=e.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=e.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,e.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl((function(r,s,o){i=o.oCoords[s],r.getVisibility(o,s)&&(n&&(i=d.util.transformPoint(i,n)),r.render(t,i.x,i.y,e,o))})),t.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,e){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e,this},setControlsVisibility:function(t){for(var e in t||(t={}),t)this.setControlVisible(e,t[e]);return this},onDeselect:function(){},onSelect:function(){}})}(),d.util.object.extend(d.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){var n=function(){},i=(e=e||{}).onComplete||n,r=e.onChange||n,s=this;return d.util.animate({startValue:t.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),s.requestRenderAll(),r()},onComplete:function(){t.setCoords(),i()}}),this},fxCenterObjectV:function(t,e){var n=function(){},i=(e=e||{}).onComplete||n,r=e.onChange||n,s=this;return d.util.animate({startValue:t.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),s.requestRenderAll(),r()},onComplete:function(){t.setCoords(),i()}}),this},fxRemove:function(t,e){var n=function(){},i=(e=e||{}).onComplete||n,r=e.onChange||n,s=this;return d.util.animate({startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){t.set("opacity",e),s.requestRenderAll(),r()},onComplete:function(){s.remove(t),i()}}),this}}),d.util.object.extend(d.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,n=[];for(t in arguments[0])n.push(t);for(var i=0,r=n.length;i<r;i++)t=n[i],e=i!==r-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,n,i){var r,s=this;e=e.toString(),n=n?d.util.object.clone(n):{},~t.indexOf(".")&&(r=t.split("."));var o=s.colorProperties.indexOf(t)>-1||r&&s.colorProperties.indexOf(r[1])>-1,a=r?this.get(r[0])[r[1]]:this.get(t);"from"in n||(n.from=a),o||(e=~e.indexOf("=")?a+parseFloat(e.replace("=","")):parseFloat(e));var h={startValue:n.from,endValue:e,byValue:n.by,easing:n.easing,duration:n.duration,abort:n.abort&&function(t,e,i){return n.abort.call(s,t,e,i)},onChange:function(e,o,a){r?s[r[0]][r[1]]=e:s.set(t,e),!i&&n.onChange&&n.onChange(e,o,a)},onComplete:function(t,e,r){i||(s.setCoords(),n.onComplete&&n.onComplete(t,e,r))}};return o?d.util.animateColor(h.startValue,h.endValue,h.duration,h):d.util.animate(h)}}),function(t){var e=t.fabric||(t.fabric={}),n=e.util.object.extend,i=e.util.object.clone,r={x1:1,x2:1,y1:1,y2:1};function s(t,e){var n=t.origin,i=t.axis1,r=t.axis2,s=t.dimension,o=e.nearest,a=e.center,h=e.farthest;return function(){switch(this.get(n)){case o:return Math.min(this.get(i),this.get(r));case a:return Math.min(this.get(i),this.get(r))+.5*this.get(s);case h:return Math.max(this.get(i),this.get(r))}}}e.Line?e.warn("fabric.Line is already defined"):(e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(t,e){t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),typeof r[t]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t){t.beginPath();var e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;var n=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=n},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(t){return n(this.callSuper("toObject",t),this.calcLinePoints())},_getNonTransformedDimensions:function(){var t=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(t.y-=this.strokeWidth),0===this.height&&(t.x-=this.strokeWidth)),t},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,n=t*this.width*.5,i=e*this.height*.5;return{x1:n,x2:t*this.width*-.5,y1:i,y2:e*this.height*-.5}}}),e.Line.fromObject=function(t,n){var r=i(t,!0);r.points=[t.x1,t.y1,t.x2,t.y2],e.Object._fromObject("Line",r,(function(t){delete t.points,n&&n(t)}),"points")})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={}),n=Math.PI;e.Circle?e.warn("fabric.Circle is already defined."):(e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*n,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},_render:function(t){t.beginPath(),t.arc(0,0,this.radius,this.startAngle,this.endAngle,!1),this._renderPaintInOrder(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",2*t).set("height",2*t)}}),e.Circle.fromObject=function(t,n){e.Object._fromObject("Circle",t,n)})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={});e.Triangle?e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(t){var e=this.width/2,n=this.height/2;t.beginPath(),t.moveTo(-e,n),t.lineTo(0,-n),t.lineTo(e,n),t.closePath(),this._renderPaintInOrder(t)}}),e.Triangle.fromObject=function(t,n){return e.Object._fromObject("Triangle",t,n)})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={}),n=2*Math.PI;e.Ellipse?e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this.set("rx",t&&t.rx||0),this.set("ry",t&&t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_render:function(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,n,!1),t.restore(),this._renderPaintInOrder(t)}}),e.Ellipse.fromObject=function(t,n){e.Object._fromObject("Ellipse",t,n)})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={});e.util.object.extend,e.Rect?e.warn("fabric.Rect is already defined"):(e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t){var e=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,r=this.height,s=-this.width/2,o=-this.height/2,a=0!==e||0!==n,h=.4477152502;t.beginPath(),t.moveTo(s+e,o),t.lineTo(s+i-e,o),a&&t.bezierCurveTo(s+i-h*e,o,s+i,o+h*n,s+i,o+n),t.lineTo(s+i,o+r-n),a&&t.bezierCurveTo(s+i,o+r-h*n,s+i-h*e,o+r,s+i-e,o+r),t.lineTo(s+e,o+r),a&&t.bezierCurveTo(s+h*e,o+r,s,o+r-h*n,s,o+r-n),t.lineTo(s,o+n),a&&t.bezierCurveTo(s,o+h*n,s+h*e,o,s+e,o),t.closePath(),this._renderPaintInOrder(t)},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))}}),e.Rect.fromObject=function(t,n){return e.Object._fromObject("Rect",t,n)})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={}),n=e.util.object.extend,i=e.util.array.min,r=e.util.array.max;e.util.toFixed,e.Polyline?e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._setPositionDimensions(e)},_setPositionDimensions:function(t){var e,n=this._calcDimensions(t);this.width=n.width,this.height=n.height,t.fromSVG||(e=this.translateToGivenOrigin({x:n.left-this.strokeWidth/2,y:n.top-this.strokeWidth/2},"left","top",this.originX,this.originY)),typeof t.left>"u"&&(this.left=t.fromSVG?n.left:e.x),typeof t.top>"u"&&(this.top=t.fromSVG?n.top:e.y),this.pathOffset={x:n.left+this.width/2,y:n.top+this.height/2}},_calcDimensions:function(){var t=this.points,e=i(t,"x")||0,n=i(t,"y")||0;return{left:e,top:n,width:(r(t,"x")||0)-e,height:(r(t,"y")||0)-n}},toObject:function(t){return n(this.callSuper("toObject",t),{points:this.points.concat()})},commonRender:function(t){var e,n=this.points.length,i=this.pathOffset.x,r=this.pathOffset.y;if(!n||isNaN(this.points[n-1].y))return!1;t.beginPath(),t.moveTo(this.points[0].x-i,this.points[0].y-r);for(var s=0;s<n;s++)e=this.points[s],t.lineTo(e.x-i,e.y-r);return!0},_render:function(t){this.commonRender(t)&&this._renderPaintInOrder(t)},complexity:function(){return this.get("points").length}}),e.Polyline.fromObject=function(t,n){return e.Object._fromObject("Polyline",t,n,"points")})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={});e.Polygon?e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_render:function(t){this.commonRender(t)&&(t.closePath(),this._renderPaintInOrder(t))}}),e.Polygon.fromObject=function(t,n){e.Object._fromObject("Polygon",t,n,"points")})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={}),n=e.util.array.min,i=e.util.array.max,r=e.util.object.extend,s=Object.prototype.toString;e.util.toFixed,e.Path?e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(t,n){n=n||{},this.callSuper("initialize",n),t||(t=[]);var i="[object Array]"===s.call(t);this.path=e.util.makePathSimpler(i?t:e.util.parsePath(t)),this.path&&e.Polyline.prototype._setPositionDimensions.call(this,n)},_renderPathCommands:function(t){var e,n=0,i=0,r=0,s=0,o=0,a=0,h=-this.pathOffset.x,c=-this.pathOffset.y;t.beginPath();for(var u=0,l=this.path.length;u<l;++u)switch(e=this.path[u],e[0]){case"L":r=e[1],s=e[2],t.lineTo(r+h,s+c);break;case"M":n=r=e[1],i=s=e[2],t.moveTo(r+h,s+c);break;case"C":r=e[5],s=e[6],o=e[3],a=e[4],t.bezierCurveTo(e[1]+h,e[2]+c,o+h,a+c,r+h,s+c);break;case"Q":t.quadraticCurveTo(e[1]+h,e[2]+c,e[3]+h,e[4]+c),r=e[3],s=e[4],o=e[1],a=e[2];break;case"z":case"Z":r=n,s=i,t.closePath()}},_render:function(t){this._renderPathCommands(t),this._renderPaintInOrder(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){return r(this.callSuper("toObject",t),{path:this.path.map((function(t){return t.slice()}))})},toDatalessObject:function(t){var e=this.toObject(["sourcePath"].concat(t));return e.sourcePath&&delete e.path,e},complexity:function(){return this.path.length},_calcDimensions:function(){for(var t,r,s=[],o=[],a=0,h=0,c=0,u=0,l=0,d=this.path.length;l<d;++l){switch((t=this.path[l])[0]){case"L":c=t[1],u=t[2],r=[];break;case"M":a=c=t[1],h=u=t[2],r=[];break;case"C":r=e.util.getBoundsOfCurve(c,u,t[1],t[2],t[3],t[4],t[5],t[6]),c=t[5],u=t[6];break;case"Q":r=e.util.getBoundsOfCurve(c,u,t[1],t[2],t[1],t[2],t[3],t[4]),c=t[3],u=t[4];break;case"z":case"Z":c=a,u=h}r.forEach((function(t){s.push(t.x),o.push(t.y)})),s.push(c),o.push(u)}var f=n(s)||0,p=n(o)||0;return{left:f,top:p,width:(i(s)||0)-f,height:(i(o)||0)-p}}}),e.Path.fromObject=function(t,n){if("string"==typeof t.sourcePath){var i=t.sourcePath;e.loadSVGFromURL(i,(function(e){var i=e[0];i.setOptions(t),n&&n(i)}))}else e.Object._fromObject("Path",t,n,"path")})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={}),n=e.util.array.min,i=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,e,n){e=e||{},this._objects=[],n&&this.callSuper("initialize",e),this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;if(n)this._updateObjectsACoords();else{var r=e&&e.centerPoint;void 0!==e.originX&&(this.originX=e.originX),void 0!==e.originY&&(this.originY=e.originY),r||this._calcBounds(),this._updateObjectsCoords(r),delete e.centerPoint,this.callSuper("initialize",e)}this.setCoords()},_updateObjectsACoords:function(){for(var t=this._objects.length;t--;)this._objects[t].setCoords(!0)},_updateObjectsCoords:function(t){t=t||this.getCenterPoint();for(var e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){var n=t.left,i=t.top;t.set({left:n-e.x,top:i-e.y}),t.group=this,t.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){var n=!!this.group;return this._restoreObjectsState(),e.util.resetObjectTransform(this),t&&(n&&e.util.removeTransformFromObject(t,this.group.calcTransformMatrix()),this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,n?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,n){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(t,n);if("canvas"===t)for(;i--;)this._objects[i]._set(t,n);e.Object.prototype._set.call(this,t,n)},toObject:function(t){var n=this.includeDefaultValues,i=this._objects.filter((function(t){return!t.excludeFromExport})).map((function(e){var i=e.includeDefaultValues;e.includeDefaultValues=n;var r=e.toObject(t);return e.includeDefaultValues=i,r})),r=e.Object.prototype.toObject.call(this,t);return r.objects=i,r},toDatalessObject:function(t){var n,i=this.sourcePath;if(i)n=i;else{var r=this.includeDefaultValues;n=this._objects.map((function(e){var n=e.includeDefaultValues;e.includeDefaultValues=r;var i=e.toDatalessObject(t);return e.includeDefaultValues=n,i}))}var s=e.Object.prototype.toDatalessObject.call(this,t);return s.objects=n,s},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=e.Object.prototype.shouldCache.call(this);if(t)for(var n=0,i=this._objects.length;n<i;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1;return t},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var t=0,n=this._objects.length;t<n;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var e=0,n=this._objects.length;e<n;e++)this._objects[e].render(t);this._drawClipPath(t)},isCacheDirty:function(t){if(this.callSuper("isCacheDirty",t))return!0;if(!this.statefullCache)return!1;for(var e=0,n=this._objects.length;e<n;e++)if(this._objects[e].isCacheDirty(!0)){if(this._cacheCanvas){var i=this.cacheWidth/this.zoomX,r=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-i/2,-r/2,i,r)}return!0}return!1},_restoreObjectsState:function(){var t=this.calcOwnMatrix();return this._objects.forEach((function(n){e.util.addTransformToObject(n,t),delete n.group,n.setCoords()})),this},realizeTransform:function(t,n){return e.util.addTransformToObject(t,n),t},destroy:function(){return this._objects.forEach((function(t){t.set("dirty",!0)})),this._restoreObjectsState()},toActiveSelection:function(){if(this.canvas){var t=this._objects,n=this.canvas;this._objects=[];var i=this.toObject();delete i.objects;var r=new e.ActiveSelection([]);return r.set(i),r.type="activeSelection",n.remove(this),t.forEach((function(t){t.group=r,t.dirty=!0,n.add(t)})),r.canvas=n,r._objects=t,n._activeObject=r,r.setCoords(),r}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject((function(t){t.setCoords(!0)})),this},_calcBounds:function(t){for(var e,n,i,r,s=[],o=[],a=["tr","br","bl","tl"],h=0,c=this._objects.length,u=a.length;h<c;++h){for(i=(e=this._objects[h]).calcACoords(),r=0;r<u;r++)n=a[r],s.push(i[n].x),o.push(i[n].y);e.aCoords=i}this._getBounds(s,o,t)},_getBounds:function(t,r,s){var o=new e.Point(n(t),n(r)),a=new e.Point(i(t),i(r)),h=o.y||0,c=o.x||0,u=a.x-o.x||0,l=a.y-o.y||0;this.width=u,this.height=l,s||this.setPositionByOrigin({x:c,y:h},"left","top")}}),e.Group.fromObject=function(t,n){var i=t.objects,r=e.util.object.clone(t,!0);delete r.objects,"string"!=typeof i?e.util.enlivenObjects(i,(function(i){e.util.enlivenObjects([t.clipPath],(function(r){var s=e.util.object.clone(t,!0);s.clipPath=r[0],delete s.objects,n&&n(new e.Group(i,s,!0))}))})):e.loadSVGFromURL(i,(function(s){var o=e.util.groupSVGElements(s,t,i);o.set(r),n&&n(o)}))})}(typeof f<"u"?f:void 0),function(t){var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(t,n){n=n||{},this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;n.originX&&(this.originX=n.originX),n.originY&&(this.originY=n.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,n),this.setCoords()},toGroup:function(){var t=this._objects.concat();this._objects=[];var n=e.Object.prototype.toObject.call(this),i=new e.Group([]);if(delete n.type,i.set(n),t.forEach((function(t){t.canvas.remove(t),t.group=i})),i._objects=t,!this.canvas)return i;var r=this.canvas;return r.add(i),r._activeObject=i,i.setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(t,e,n){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",t,e),typeof(n=n||{}).hasControls>"u"&&(n.hasControls=!1),n.forActiveSelection=!0;for(var i=0,r=this._objects.length;i<r;i++)this._objects[i]._renderControls(t,n);t.restore()}}),e.ActiveSelection.fromObject=function(t,n){e.util.enlivenObjects(t.objects,(function(i){delete t.objects,n&&n(new e.ActiveSelection(i,t,!0))}))})}(typeof f<"u"?f:void 0),function(t){var e=d.util.object.extend;t.fabric||(t.fabric={}),t.fabric.Image?d.warn("fabric.Image is already defined."):(d.Image=d.util.createClass(d.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:d.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:d.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(t,e){e||(e={}),this.filters=[],this.cacheKey="texture"+d.Object.__uid++,this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element||{}},setElement:function(t,e){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=t,this._originalElement=t,this._initConfig(e),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(t){var e=d.filterBackend;e&&e.evictCachesForKey&&e.evictCachesForKey(t)},dispose:function(){this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(t){d.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var t=this.getElement();return{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,n=this.height/2;t.beginPath(),t.moveTo(-e,-n),t.lineTo(e,-n),t.lineTo(e,n),t.lineTo(-e,n),t.lineTo(-e,-n),t.closePath()}},toObject:function(t){var n=[];this.filters.forEach((function(t){t&&n.push(t.toObject())}));var i=e(this.callSuper("toObject",["cropX","cropY"].concat(t)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:n});return this.resizeFilter&&(i.resizeFilter=this.resizeFilter.toObject()),i},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},getSrc:function(t){var e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src"):e.src:this.src||""},setSrc:function(t,e,n){return d.util.loadImage(t,(function(t,i){this.setElement(t,n),this._setWidthHeight(),e&&e(this,i)}),this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var t=this.resizeFilter,e=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),i=n.scaleX,r=n.scaleY,s=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||i>e&&r>e)return this._element=s,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=r);d.filterBackend||(d.filterBackend=d.initFilterBackend());var o=d.util.createCanvasElement(),a=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,h=s.width,c=s.height;o.width=h,o.height=c,this._element=o,this._lastScaleX=t.scaleX=i,this._lastScaleY=t.scaleY=r,d.filterBackend.applyFilters([t],s,h,c,this._element,a),this._filterScalingX=o.width/this._originalElement.width,this._filterScalingY=o.height/this._originalElement.height},applyFilters:function(t){if(t=(t=t||this.filters||[]).filter((function(t){return t&&!t.isNeutralState()})),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===t.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var e=this._originalElement,n=e.naturalWidth||e.width,i=e.naturalHeight||e.height;if(this._element===this._originalElement){var r=d.util.createCanvasElement();r.width=n,r.height=i,this._element=r,this._filteredEl=r}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,i),this._lastScaleX=1,this._lastScaleY=1;return d.filterBackend||(d.filterBackend=d.initFilterBackend()),d.filterBackend.applyFilters(t,this._originalElement,n,i,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(t){d.util.setImageSmoothing(t,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)},drawCacheOnCanvas:function(t){d.util.setImageSmoothing(t,this.imageSmoothing),d.Object.prototype.drawCacheOnCanvas.call(this,t)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(t){var e=this._element;if(e){var n=this._filterScalingX,i=this._filterScalingY,r=this.width,s=this.height,o=Math.min,a=Math.max,h=a(this.cropX,0),c=a(this.cropY,0),u=e.naturalWidth||e.width,l=e.naturalHeight||e.height,d=h*n,f=c*i,p=o(r*n,u-d),g=o(s*i,l-f),v=-r/2,_=-s/2,b=o(r,u/n-h),m=o(s,l/i-c);e&&t.drawImage(e,d,f,p,g,v,_,b,m)}},_needsResize:function(){var t=this.getTotalObjectScaling();return t.scaleX!==this._lastScaleX||t.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(t,e){this.setElement(d.util.getById(t),e),d.util.addClass(this.getElement(),d.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t)},_initFilters:function(t,e){t&&t.length?d.util.enlivenObjects(t,(function(t){e&&e(t)}),"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){t||(t={});var e=this.getElement();this.width=t.width||e.naturalWidth||e.width||0,this.height=t.height||e.naturalHeight||e.height||0},parsePreserveAspectRatioAttribute:function(){var t,e=d.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),n=this._element.width,i=this._element.height,r=1,s=1,o=0,a=0,h=0,c=0,u=this.width,l=this.height,f={width:u,height:l};return!e||"none"===e.alignX&&"none"===e.alignY?(r=u/n,s=l/i):("meet"===e.meetOrSlice&&(t=(u-n*(r=s=d.util.findScaleToFit(this._element,f)))/2,"Min"===e.alignX&&(o=-t),"Max"===e.alignX&&(o=t),t=(l-i*s)/2,"Min"===e.alignY&&(a=-t),"Max"===e.alignY&&(a=t)),"slice"===e.meetOrSlice&&(t=n-u/(r=s=d.util.findScaleToCover(this._element,f)),"Mid"===e.alignX&&(h=t/2),"Max"===e.alignX&&(h=t),t=i-l/s,"Mid"===e.alignY&&(c=t/2),"Max"===e.alignY&&(c=t),n=u/r,i=l/s)),{width:n,height:i,scaleX:r,scaleY:s,offsetLeft:o,offsetTop:a,cropX:h,cropY:c}}}),d.Image.CSS_CANVAS="canvas-img",d.Image.prototype.getSvgSrc=d.Image.prototype.getSrc,d.Image.fromObject=function(t,e){var n=d.util.object.clone(t);d.util.loadImage(n.src,(function(t,i){i?e&&e(null,!0):d.Image.prototype._initFilters.call(n,n.filters,(function(i){n.filters=i||[],d.Image.prototype._initFilters.call(n,[n.resizeFilter],(function(i){n.resizeFilter=i[0],d.util.enlivenObjects([n.clipPath],(function(i){n.clipPath=i[0];var r=new d.Image(t,n);e(r,!1)}))}))}))}),null,n.crossOrigin)},d.Image.fromURL=function(t,e,n){d.util.loadImage(t,(function(t,i){e&&e(new d.Image(t,n),i)}),null,n&&n.crossOrigin)})}(typeof f<"u"?f:void 0),d.util.object.extend(d.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten()),this},fxStraighten:function(t){var e=function(){},n=(t=t||{}).onComplete||e,i=t.onChange||e,r=this;return d.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){r.rotate(t),i()},onComplete:function(){r.setCoords(),n()}}),this}}),d.util.object.extend(d.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound}),this}}),function(){var t=d.controlsUtils,e=t.scaleSkewCursorStyleHandler,n=t.scaleCursorStyleHandler,i=t.scalingEqually,r=t.scalingYOrSkewingX,s=t.scalingXOrSkewingY,o=t.scaleOrSkewActionName,a=d.Object.prototype.controls;if(a.ml=new d.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:s,getActionName:o}),a.mr=new d.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:s,getActionName:o}),a.mb=new d.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:r,getActionName:o}),a.mt=new d.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:r,getActionName:o}),a.tl=new d.Control({x:-.5,y:-.5,cursorStyleHandler:n,actionHandler:i}),a.tr=new d.Control({x:.5,y:-.5,cursorStyleHandler:n,actionHandler:i}),a.bl=new d.Control({x:-.5,y:.5,cursorStyleHandler:n,actionHandler:i}),a.br=new d.Control({x:.5,y:.5,cursorStyleHandler:n,actionHandler:i}),a.mtr=new d.Control({x:0,y:-.5,actionHandler:t.rotationWithSnapping,cursorStyleHandler:t.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),d.Textbox){var h=d.Textbox.prototype.controls={};h.mtr=a.mtr,h.tr=a.tr,h.br=a.br,h.tl=a.tl,h.bl=a.bl,h.mt=a.mt,h.mb=a.mb,h.mr=new d.Control({x:.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),h.ml=new d.Control({x:-.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}}();const{Object:y,util:{requestAnimFrame:O,cancelAnimFrame:A}}=d;y.prototype.transparentCorners=!1,y.prototype.shouldCache=()=>!1,y.prototype.hasControls=!1,y.prototype.hasBorders=!1,y.prototype.lockMovementX=!0,y.prototype.lockMovementY=!0;class C extends d.Canvas{constructor(){super(...arguments),l(this,"isRenderingTop",0)}renderTop(){const t=this.contextTop;return t?(this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this.fire("after:renderTop"),this):this}setCursor(){}setActiveObject(){return this}getObjsInArea(t,e){const n=this._objects,i=[];for(let r=0;r<n.length;r++){const s=n[r];!s||!s.visible||(s.intersectsWithRect(t,e,!0)||s.isContainedWithinRect(t,e,!0))&&i.push(s)}return i}requestRenderTop(){this.isRenderingTop||(this.isRenderingTop=O(()=>{try{this.renderTop()}finally{this.isRenderingTop=0}}))}dispose(){return this.isRendering&&A(this.isRendering),this.isRenderingTop&&A(this.isRenderingTop),super.dispose()}}const w=["scribble:created","eraser:removed","tool:updated"];class T{constructor(t){l(this,"canvas"),l(this,"tool",null),l(this,"providers",[]),this.canvas=new C(t);const{canvas:e}=this;e.selection=!1}setViewport(t){this.canvas.setViewportTransform(t),this.canvas.requestRenderAll()}getCanvas(){return this.canvas}clear(){this.canvas.clear()}getTool(){return this.tool}clearTool(){this.tool=null}switchTool(t,e={}){this.tool={type:t,props:e},this.emit("tool:updated")}add(...t){this.canvas.add(...t)}getObjs(){return this.canvas._objects}getObjById(t){return this.canvas._objects.find(e=>e.id===t)}removeObjById(t){const e=this.canvas._objects.find(e=>e.id===t);e&&(this.canvas.remove(e),this.canvas.requestRenderAll())}removeAll(){const t=this.canvas._objects;t.length&&(this.canvas.remove(...t),this.canvas.requestRenderAll())}requestRenderAll(){this.canvas.requestRenderAll()}resize(t,e,n){this.canvas.setDimensions({width:t,height:e}),this.canvas.calcOffset(),n&&n.x&&n.y&&this.setViewport([n.x,0,0,n.y,0,0])}register(t){t.register(this),this.providers.push(t)}hideObjById(t){const e=this.canvas._objects.find(e=>e.id===t);e&&(e.set("stroke","transparent"),this.canvas.requestRenderAll())}destroy(){this.providers.forEach(t=>t.unregister()),this.providers.length=0,this.canvas.dispose()}emit(t,e){if(w.includes(t))try{this.canvas.fire(t,e)}catch(t){console.error(t)}}on(t,e){return w.includes(t)?(this.canvas.on(t,e),()=>{this.canvas.off(t,e)}):()=>{}}off(t,e){w.includes(t)&&this.canvas.off(t,e)}}function S(t,e){return(t[0]-e[0])**2+(t[1]-e[1])**2}function P(t,e,n){const i=S(e,n);if(0===i)return S(t,e);let r=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/i;return r=Math.max(0,Math.min(1,r)),S(t,function(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}(e,n,r))}function E(t,e){return function t(e,n,i,r,s){const o=s||[],a=e[n],h=e[i-1];let c=0,u=1;for(let t=n+1;t<i-1;++t){const n=P(e[t],a,h);n>c&&(c=n,u=t)}return Math.sqrt(c)>r?(t(e,n,u+1,r,o),t(e,u,i,r,o)):(o.length||o.push(a),o.push(h)),o}(t,0,t.length,e)}function I(t){return[...t]}function j(t,e){return{x:t.x+e.x,y:t.y+e.y}}function x(t,e){return t.map(t=>j(t,e))}function D(t,e){return new d.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])}function k(t,e){return t.map(t=>D(t,e))}function R(t){return{x:-t.x,y:-t.y}}function N(t){const e=function(t){if(!t.length)return{left:0,top:0,width:0,height:0,center:{x:0,y:0}};const{minX:e,minY:n,maxX:i,maxY:r}=t.reduce((t,e,n)=>(0===n||(t.minX=Math.min(t.minX,e.x),t.minY=Math.min(t.minY,e.y),t.maxX=Math.max(t.maxX,e.x),t.maxY=Math.max(t.maxY,e.y)),t),{minX:t[0].x,minY:t[0].y,maxX:t[0].x,maxY:t[0].y}),s=i-e,o=r-n;return{left:e,top:n,width:s,height:o,center:{x:e+s/2,y:n+o/2}}}(t);return{points:x(t,R(e.center)),center:e.center,transform:[1,0,0,1,e.center.x,e.center.y]}}function M(t,e){return D(t,d.util.invertTransform(e))}function L(t){if(!t.length)return[];if(1===t.length){const e=t[0];return[["M",e.x,e.y],["L",e.x,e.y]]}if(2===t.length){const e=t[0],n=t[1];return[["M",e.x,e.y],["L",n.x,n.y]]}const e=function(t,e=0){const n=t.length;if(n<3)throw new Error("A curve must have at least three points.");const i=[];if(3===n)i.push(I(t[0]),I(t[1]),I(t[2]),I(t[2]));else{const n=[];n.push(t[0],t[0]);for(let e=1;e<t.length;e++)n.push(t[e]),e===t.length-1&&n.push(t[e]);const r=[],s=1-e;i.push(I(n[0]));for(let t=1;t+2<n.length;t++){const e=n[t];r[0]=[e[0],e[1]],r[1]=[e[0]+(s*n[t+1][0]-s*n[t-1][0])/6,e[1]+(s*n[t+1][1]-s*n[t-1][1])/6],r[2]=[n[t+1][0]+(s*n[t][0]-s*n[t+2][0])/6,n[t+1][1]+(s*n[t][1]-s*n[t+2][1])/6],r[3]=[n[t+1][0],n[t+1][1]],i.push(r[1],r[2],r[3])}}return i}(t.map(t=>[t.x,t.y])),n=[["M",e[0][0],e[0][1]]];for(let t=1;t<e.length;t+=3){const i=e[t],r=e[t+1],s=e[t+2];n.push(["C",i[0],i[1],r[0],r[1],s[0],s[1]])}return n}function F(t,e){const n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}function Y(t,e){return Math.abs(t.x-e.x)<1e-6&&Math.abs(t.y-e.y)<1e-6}function B(t,e){return{x:e.x-t.x,y:e.y-t.y}}function X(t,e){return t.x*e.x+t.y*e.y}class U{constructor(t,e){l(this,"start"),l(this,"end"),l(this,"_length"),this.start=t,this.end=e}get length(){return void 0===this._length&&(this._length=this.calculateLength()),this._length}calculateLength(){return F(this.start,this.end)}project(t,e=!1){if(Y(this.start,this.end))return this.start;const n=this.start,i=this.end,r=t,s=((i.x-n.x)*(r.x-n.x)+(i.y-n.y)*(r.y-n.y))/((i.x-n.x)**2+(i.y-n.y)**2),o={x:n.x+(i.x-n.x)*s,y:n.y+(i.y-n.y)*s};return e?o:X(B(n,i),B(n,o))<0?n:X(B(i,n),B(i,o))<0?i:o}}function z({ctx:t,obj:e}){t.save();try{e.render(t)}catch(t){}t.restore()}function H(t,e,n){return t.on(e,n),()=>{t.off(e,n)}}var W=(t=>(t[t.LEFT=0]="LEFT",t[t.MIDDLE=1]="MIDDLE",t[t.RIGHT=2]="RIGHT",t))(W||{});class q extends d.Path{constructor(t,e){const n=t;1===n.length&&n.push(j(n[0],{x:.1,y:.1}));const i=void 0!==e.strokeWidth?e.strokeWidth:2,o=void 0!==e.stroke?e.stroke:"#005AC8";super(L(n),((t,e)=>r(t,s(e)))(u({},e),{strokeWidth:i,stroke:o})),l(this,"type","ZoomScribble"),l(this,"id"),l(this,"opacity",1),l(this,"fill","transparent"),l(this,"strokeLineCap","round"),l(this,"strokeLineJoin","round"),l(this,"noScaleCache",!1),l(this,"originX","left"),l(this,"originY","top"),l(this,"strokeWidth"),l(this,"stroke"),l(this,"points",[]),l(this,"pointsObjs",[]),l(this,"pointsObjSpace",[]),l(this,"vptMinDistanceToCheckContain",20),l(this,"vptMinDistanceToPreciseSelect",10),l(this,"hoverCursor","auto"),l(this,"strokeUniform",!0),l(this,"objectCaching",!1),this.id=4294967296*Math.floor(65536*Math.random())+((null==crypto?void 0:crypto.getRandomValues(new Uint32Array(1))[0])||Math.floor(4294967296*Math.random())),this.strokeWidth=i,this.stroke=o,this.setPoints(n)}setPoints(t){this.points=t,this.pointsObjs=t.map(t=>new d.Point(t.x,t.y)),this.pointsObjSpace=N(t).points}updatePoints(t,e="normal"){this.setPoints(t);const n="simple"===e?function(t){if(!t.length)return[];if(1===t.length){const e=t[0];return[["M",e.x,e.y],["L",e.x,e.y]]}if(2===t.length){const e=t[0],n=t[1];return[["M",e.x,e.y],["L",n.x,n.y]]}const e=[];for(let n=0;n<t.length;n++){const i=t[n];if(0===n)e.push(["M",i.x,i.y]);else{if(1===n)continue;{const i=t[n-1],r=t[n],s={x:(i.x+r.x)/2,y:(i.y+r.y)/2};e.push(["Q",i.x,i.y,s.x,s.y])}}}return e}(t):L(t);d.Path.prototype.initialize.call(this,n),this.dirty=!0}containsPoint(t,e,n,i){var r;const s=super.containsPoint(t,e,n,i);if(!this.strokeUniform)return s;if(!e&&(void 0===n||n)){if(!s)return!1;if((null==(r=this.canvas)?void 0:r._activeObject)===this)return s;let e;e=n?M(t,this.calcTransformMatrix()):this.group?D(t,d.util.invertTransform(this.calcOwnMatrix())):function(t,e,n){return M(D(t,d.util.invertTransform(e)),n)}(t,this.getViewportTransform(),this.calcTransformMatrix());const i=k(k(this.pointsObjSpace,this.calcTransformMatrix()),this.getViewportTransform()),o=1/(this.scaleX||1);return this.checkContainsPointInViewport(function(t,e,n){return D(D(t,n),e)}(e,this.getViewportTransform(),this.calcTransformMatrix()),Math.max(this.vptMinDistanceToCheckContain,this.strokeWidth*o/2),i)}return s}checkContainsPointInViewport(t,e,n){const i=this.closestPointTo(t,n);return!!i&&i.closestDistance<=e}closestPointTo(t,e){let n;return e.forEach((e,i,r)=>{const s=r[i+1];if(e&&s){const i=new U(e,s).project(t,!1),r=F(i,t);(void 0===n||n.closestDistance>r)&&(n={closestPoint:i,closestDistance:r})}}),n}}const V=t=>t**.3;class G{constructor(){l(this,"tool",{type:"eraser",props:{}}),l(this,"cleanups",[]),l(this,"detecting",!1),l(this,"mouseMovePoints",[]),l(this,"cancelAnimate",null),l(this,"updateTrailPath",null),l(this,"trailPath",null),l(this,"radius",5)}register(t){const e=t.getCanvas(),n=()=>{const e=t.getTool();return(null==e?void 0:e.type)===this.tool.type};function i(e){e&&(t.removeObjById(e.id),t.emit("eraser:removed",e))}const r=()=>{e.requestRenderTop()};this.cleanups.push(H(e,"after:renderTop",()=>{if(this.trailPath){const t=e.getSelectionContext();t.save();const n=e.viewportTransform;n&&t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),z({obj:this.trailPath,ctx:t}),t.restore()}}),H(e,"mouse:down",t=>{const r=t.e;if(!n()||this.detecting||r.button===W.RIGHT||r.button===W.MIDDLE)return;const s=e.getPointer(r);this.mouseMovePoints.push(new d.Point(s.x,s.y)),this.detecting=!0,t.target&&i(t.target),this.trailPath=new q([],{stroke:"#DFE3E8",opacity:.4,strokeWidth:2*this.radius,strokeLineCap:"round",strokeLineJoin:"round",objectCaching:!1}),this.animate()}),H(e,"mouse:move",t=>{const n=t.e;if(!this.detecting)return;const r=e.getPointer(n);if(this.mouseMovePoints.push(new d.Point(r.x,r.y)),t.target)i(t.target);else{const t=this.mouseMovePoints,n=t[t.length-2],r=t[t.length-1];if(n&&r&&!Y(n,r)){const{min:t,max:s}=Math,o=new d.Point(t(n.x,r.x),t(n.y,r.y)),a=new d.Point(s(n.x,r.x),s(n.y,r.y)),h=e.getObjsInArea(o,a);if(h.length){const t=d.Intersection.intersectLinePolygon;for(const e of h){const s=e;null!=s&&s.points.length&&"Intersection"===t(n,r,s.pointsObjs).status&&i(e)}}}}this.animate()}),H(e,"mouse:up",()=>{this.resetState(),r()}),t.on("tool:updated",()=>{n()||(this.resetState(),r())})),this.updateTrailPath=()=>{if(!this.trailPath||this.mouseMovePoints.length<=0||!e.viewportTransform)return;const t=this.mouseMovePoints.slice();this.trailPath.updatePoints(t,"simple"),r()}}resetState(){this.detecting=!1,this.mouseMovePoints=[],this.trailPath=null}animate(){this.cancelAnimate&&(this.cancelAnimate(),this.cancelAnimate=null),this.updateTrailPath&&this.mouseMovePoints.length&&(this.cancelAnimate=d.util.animate({startValue:Math.floor(this.mouseMovePoints.length/10),endValue:this.mouseMovePoints.length-1,duration:1500,easing:(t,e,n,i)=>e+(n-e)*V(t/i),onChange:t=>{var e;this.mouseMovePoints=this.mouseMovePoints.slice(Math.floor(t)),null==(e=this.updateTrailPath)||e.call(this)},onComplete:()=>{var t;null==(t=this.updateTrailPath)||t.call(this)}}))}unregister(){this.cleanups.forEach(t=>t()),this.cleanups.length=0,this.resetState()}}class K{constructor(){l(this,"tool",{type:"pen",props:{strokeWidth:void 0,stroke:void 0}}),l(this,"points",[]),l(this,"path",null),l(this,"cleanups",[]),l(this,"currentPointer",null)}register(t){const e=t.getCanvas(),n=()=>{const e=t.getTool();return(null==e?void 0:e.type)===this.tool.type},i=()=>{var e;return(null==(e=t.getTool())?void 0:e.props)||u({},this.tool.props)},r=()=>{e.requestRenderTop()};this.cleanups.push(H(e,"after:renderTop",()=>{if(this.path){const t=e.getSelectionContext();t.save();const n=e.viewportTransform;n&&t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),z({obj:this.path,ctx:t}),t.restore()}}),H(e,"mouse:down",t=>{const s=t.e;if(!n()||s.button===W.RIGHT||s.button===W.MIDDLE||this.currentPointer||this.path)return;this.currentPointer={pointerId:s.pointerId};const o=e.getPointer(s),a=i();this.points=[o],this.path=new q(this.points,{stroke:a.stroke,strokeWidth:a.strokeWidth}),r()}),H(e,"mouse:move",t=>{const n=t.e;if(!this.path||!this.currentPointer||this.currentPointer.pointerId!==n.pointerId)return;const i=e.getPointer(n);this.points.push(i),this.path.updatePoints(this.points,"simple"),r()}),H(e,"mouse:up",n=>{if(!this.path||!this.currentPointer)return;const i=n.e,s=e.getPointer(i);this.points.push(s);const o=E(this.points.map(t=>[t.x,t.y]),.75);this.path.updatePoints(o.map(([t,e])=>new d.Point(t,e))),e.add(this.path),t.emit("scribble:created",this.path),this.resetState(),r()}),t.on("tool:updated",()=>{n()||(this.resetState(),r())}))}resetState(){this.path=null,this.currentPointer=null,this.points=[]}unregister(){this.cleanups.forEach(t=>t()),this.cleanups.length=0,this.resetState()}}function J(t){const e=t.height,n=t.width,i=t.absHeight;return{vW:n,vH:e,scale:{x:n/t.absWidth,y:e/i}}}var Q=(t=>(t[t.ONACK=0]="ONACK",t[t.TOOL_SELECT=1]="TOOL_SELECT",t[t.ERASE_ALL=2]="ERASE_ALL",t[t.RESIZE=3]="RESIZE",t[t.REMOVE_OBJECTS=4]="REMOVE_OBJECTS",t[t.RESTORE_OBJECTS=5]="RESTORE_OBJECTS",t[t.TOOL_BAR_CLOSED=6]="TOOL_BAR_CLOSED",t[t.CHANGE_SESSION=7]="CHANGE_SESSION",t[t.UPDATE_CANVAS=8]="UPDATE_CANVAS",t[t.DESTROY_SESSION=9]="DESTROY_SESSION",t))(Q||{}),Z=(t=>(t[t.ANNO_TOOL_TYPE_NONE=0]="ANNO_TOOL_TYPE_NONE",t[t.ANNO_TOOL_TYPE_PEN=1]="ANNO_TOOL_TYPE_PEN",t[t.ANNO_TOOL_TYPE_ERASER=7]="ANNO_TOOL_TYPE_ERASER",t))(Z||{});class ${constructor(){l(this,"onAnnotationMsg",()=>{}),l(this,"editor"),l(this,"historicalObjs",new Map),l(this,"sessionId"),l(this,"sessionArchive",new Map),l(this,"hasInit",!1)}init(t){this.onAnnotationMsg=t.onAnnotationMsg,this.sessionId=t.sessionId,this.editor=this.createEditor(u({annoCanvas:t.annoCanvas},J(t))),this.hasInit=!0}createEditor(t){const{annoCanvas:e,vW:n,vH:i,scale:r}=t,s=new T(e);return s.register(new K),s.register(new G),s.resize(n,i,r),s.on("scribble:created",t=>{let e=255;e=function(t){if(!/^#[0-9A-Fa-f]{6}$/.test(t))throw new Error("Invalid hex color format. Use #RRGGBB.");const e=t.slice(1);return parseInt(e,16)}(t.stroke),this.onAnnotationMsg({type:"addObject",objectData:{points:t.points,type:"line",lineFormat:{type:"soild",lineData:{width:t.strokeWidth,color:e}}},objectId:t.id})}),s.on("eraser:removed",t=>{this.historicalObjs.set(t.id,t),this.onAnnotationMsg({type:"removeObject",objectId:t.id})}),s}reInit(t){const e=this.editor.getObjs().slice(),n=this.editor.getTool();this.editor.destroy(),this.editor=this.createEditor(u({annoCanvas:t.annoCanvas},J(t))),this.editor.add(...e),n&&this.editor.switchTool(n.type,n.props)}destroy(){this.hasInit&&(this.historicalObjs.clear(),this.sessionArchive.clear(),this.editor.destroy())}_mapToolType(t){return 7===t?"eraser":1===t?"pen":"none"}restoreObjs(t){for(const e of t){const t=this.historicalObjs.get(e);t&&this.editor.add(t),this.historicalObjs.delete(e)}this.editor.requestRenderAll()}snapshot(){return{historicalObjs:new Map(this.historicalObjs),onCanvasObjs:this.editor.getObjs().slice()}}saveSession(){const t=this.snapshot();(t.historicalObjs.size||t.onCanvasObjs.length)&&this.sessionArchive.set(this.sessionId,t)}switchSession(t){if(this.sessionId===t)return;const e=this.sessionArchive.get(t);this.saveSession(),this.editor.removeAll(),this.historicalObjs=new Map,this.sessionId=t,e&&(this.historicalObjs=e.historicalObjs,this.editor.add(...e.onCanvasObjs)),this.editor.requestRenderAll()}removeAll(){const t=this.editor.getObjs();for(const e of t)this.historicalObjs.set(e.id,e);this.editor.removeAll()}removeObjs(t){for(const e of t){const t=this.editor.getObjById(e);t&&(this.historicalObjs.set(e,t),this.editor.removeObjById(e))}this.editor.requestRenderAll()}switchTool(t,e=2,n=255){let i="#0000FF";try{i=function(t){if(t<0||t>16777215)throw new Error("Decimal value must be between 0 and 16777215.");const e=t>>8&255,n=255&t,i=t=>t.toString(16).padStart(2,"0").toUpperCase();return"#".concat(i(t>>16&255)).concat(i(e)).concat(i(n))}(n)}catch(t){}this.editor.switchTool(this._mapToolType(t),{strokeWidth:e,stroke:i})}onMessage(t){if(1===t.type)this.switchTool(t.toolType,t.width,t.color);else if(2===t.type)this.removeAll();else if(0===t.type)this.editor.hideObjById(t.objectId);else if(6===t.type)this.editor.clearTool();else if(3===t.type){const e=J(t);this.editor.resize(e.vW,e.vH,e.scale)}else 5===t.type?this.restoreObjs(t.objectIds):4===t.type?this.removeObjs(t.objectIds):7===t.type?this.switchSession(t.sessionId):8===t.type?this.reInit(t):9===t.type&&(this.sessionArchive.delete(t.sessionId),this.sessionId===t.sessionId&&this.historicalObjs.clear())}}}.call(this,n(116).Buffer)},116:function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=n(117),r=n(118),s=n(119);function o(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return h.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=h.prototype:(null===t&&(t=new h(e)),t.length=e),t}function h(t,e,n){if(!(h.TYPED_ARRAY_SUPPORT||this instanceof h))return new h(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return c(this,t,e,n)}function c(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i);h.TYPED_ARRAY_SUPPORT?(t=e).__proto__=h.prototype:t=d(t,e);return t}(t,e,n,i):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!h.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(e,n),r=(t=a(t,i)).write(e,n);r!==i&&(t=t.slice(0,r));return t}(t,e,n):function(t,e){if(h.isBuffer(e)){var n=0|f(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?a(t,0):d(t,e);if("Buffer"===e.type&&s(e.data))return d(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(u(e),t=a(t,e<0?0:0|f(e)),!h.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e){var n=e.length<0?0:0|f(e.length);t=a(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function f(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(h.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return B(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return X(t).length;default:if(i)return B(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,n){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return P(this,e,n);case"latin1":case"binary":return E(this,e,n);case"base64":return T(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function v(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function _(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=h.from(e,i)),h.isBuffer(e))return 0===e.length?-1:b(t,e,n,i,r);if("number"==typeof e)return e&=255,h.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,i,r){var s,o=1,a=t.length,h=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,h/=2,n/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var u=-1;for(s=n;s<a;s++)if(c(t,s)===c(e,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===h)return u*o}else-1!==u&&(s-=s-u),u=-1}else for(n+h>a&&(n=a-h),s=n;s>=0;s--){for(var l=!0,d=0;d<h;d++)if(c(t,s+d)!==c(e,d)){l=!1;break}if(l)return s}return-1}function m(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function y(t,e,n,i){return U(B(e,t.length-n),t,n,i)}function O(t,e,n,i){return U(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function A(t,e,n,i){return O(t,e,n,i)}function C(t,e,n,i){return U(X(e),t,n,i)}function w(t,e,n,i){return U(function(t,e){for(var n,i,r,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),i=n>>8,r=n%256,s.push(r),s.push(i);return s}(e,t.length-n),t,n,i)}function T(t,e,n){return 0===e&&n===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,n))}function S(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var s,o,a,h,c=t[r],u=null,l=c>239?4:c>223?3:c>191?2:1;if(r+l<=n)switch(l){case 1:c<128&&(u=c);break;case 2:128==(192&(s=t[r+1]))&&(h=(31&c)<<6|63&s)>127&&(u=h);break;case 3:s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&(h=(15&c)<<12|(63&s)<<6|63&o)>2047&&(h<55296||h>57343)&&(u=h);break;case 4:s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(h=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(u=h)}null===u?(u=65533,l=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),r+=l}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",i=0;for(;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=4096));return n}(i)}e.Buffer=h,e.SlowBuffer=function(t){+t!=t&&(t=0);return h.alloc(+t)},e.INSPECT_MAX_BYTES=50,h.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),h.poolSize=8192,h._augment=function(t){return t.__proto__=h.prototype,t},h.from=function(t,e,n){return c(null,t,e,n)},h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0})),h.alloc=function(t,e,n){return function(t,e,n,i){return u(e),e<=0?a(t,e):void 0!==n?"string"==typeof i?a(t,e).fill(n,i):a(t,e).fill(n):a(t,e)}(null,t,e,n)},h.allocUnsafe=function(t){return l(null,t)},h.allocUnsafeSlow=function(t){return l(null,t)},h.isBuffer=function(t){return!(null==t||!t._isBuffer)},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,s=Math.min(n,i);r<s;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=h.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var o=t[n];if(!h.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},h.byteLength=p,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},h.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?S(this,0,t):g.apply(this,arguments)},h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},h.prototype.compare=function(t,e,n,i,r){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),c=this.slice(i,r),u=t.slice(e,n),l=0;l<a;++l)if(c[l]!==u[l]){s=c[l],o=u[l];break}return s<o?-1:o<s?1:0},h.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},h.prototype.indexOf=function(t,e,n){return _(this,t,e,n,!0)},h.prototype.lastIndexOf=function(t,e,n){return _(this,t,e,n,!1)},h.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return m(this,t,e,n);case"utf8":case"utf-8":return y(this,t,e,n);case"ascii":return O(this,t,e,n);case"latin1":case"binary":return A(this,t,e,n);case"base64":return C(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}function E(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}function I(t,e,n){var i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var r="",s=e;s<n;++s)r+=Y(t[s]);return r}function j(t,e,n){for(var i=t.slice(e,n),r="",s=0;s<i.length;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function x(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function D(t,e,n,i,r,s){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<s)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function k(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,s=Math.min(t.length-n,2);r<s;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function R(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,s=Math.min(t.length-n,4);r<s;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function N(t,e,n,i,r,s){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(t,e,n,i,s){return s||N(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function L(t,e,n,i,s){return s||N(t,0,n,8),r.write(t,e,n,i,52,8),n+8}h.prototype.slice=function(t,e){var n,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),h.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=h.prototype;else{var r=e-t;n=new h(r,void 0);for(var s=0;s<r;++s)n[s]=this[s+t]}return n},h.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i},h.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},h.prototype.readUInt8=function(t,e){return e||x(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return e||x(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return e||x(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return e||x(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return e||x(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},h.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var i=e,r=1,s=this[t+--i];i>0&&(r*=256);)s+=this[t+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*e)),s},h.prototype.readInt8=function(t,e){return e||x(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){e||x(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},h.prototype.readInt16BE=function(t,e){e||x(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},h.prototype.readInt32LE=function(t,e){return e||x(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return e||x(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return e||x(t,4,this.length),r.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return e||x(t,4,this.length),r.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return e||x(t,8,this.length),r.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return e||x(t,8,this.length),r.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,n,i){(t=+t,e|=0,n|=0,i)||D(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,s=0;for(this[e]=255&t;++s<n&&(r*=256);)this[e+s]=t/r&255;return e+n},h.prototype.writeUIntBE=function(t,e,n,i){(t=+t,e|=0,n|=0,i)||D(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,s=1;for(this[e+r]=255&t;--r>=0&&(s*=256);)this[e+r]=t/s&255;return e+n},h.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,1,255,0),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):k(this,t,e,!0),e+2},h.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):k(this,t,e,!1),e+2},h.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):R(this,t,e,!0),e+4},h.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},h.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);D(this,t,e,n,r-1,-r)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},h.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);D(this,t,e,n,r-1,-r)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},h.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,1,127,-128),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):k(this,t,e,!0),e+2},h.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):k(this,t,e,!1),e+2},h.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):R(this,t,e,!0),e+4},h.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},h.prototype.writeFloatLE=function(t,e,n){return M(this,t,e,!0,n)},h.prototype.writeFloatBE=function(t,e,n){return M(this,t,e,!1,n)},h.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},h.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},h.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,s=i-n;if(this===t&&n<e&&e<i)for(r=s-1;r>=0;--r)t[r+e]=this[r+n];else if(s<1e3||!h.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},h.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!h.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=h.isBuffer(t)?t:B(new h(t,i).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function Y(t){return t<16?"0"+t.toString(16):t.toString(16)}function B(t,e){var n;e=e||1/0;for(var i=t.length,r=null,s=[],o=0;o<i;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function X(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function U(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}}).call(this,n(42))},117:function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],i=e[1];return 3*(n+i)/4-i},e.toByteArray=function(t){for(var e,n=c(t),i=n[0],o=n[1],a=new s(function(t,e,n){return 3*(e+n)/4-n}(0,i,o)),h=0,u=o>0?i-4:i,l=0;l<u;l+=4)e=r[t.charCodeAt(l)]<<18|r[t.charCodeAt(l+1)]<<12|r[t.charCodeAt(l+2)]<<6|r[t.charCodeAt(l+3)],a[h++]=e>>16&255,a[h++]=e>>8&255,a[h++]=255&e;2===o&&(e=r[t.charCodeAt(l)]<<2|r[t.charCodeAt(l+1)]>>4,a[h++]=255&e);1===o&&(e=r[t.charCodeAt(l)]<<10|r[t.charCodeAt(l+1)]<<4|r[t.charCodeAt(l+2)]>>2,a[h++]=e>>8&255,a[h++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,s=[],o=0,a=n-r;o<a;o+=16383)s.push(u(t,o,o+16383>a?a:o+16383));1===r?(e=t[n-1],s.push(i[e>>2]+i[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],s.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"="));return s.join("")};for(var i=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,h=o.length;a<h;++a)i[a]=o[a],r[o.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function u(t,e,n){for(var r,s,o=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(i[(s=r)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},118:function(t,e){e.read=function(t,e,n,i,r){var s,o,a=8*r-i-1,h=(1<<a)-1,c=h>>1,u=-7,l=n?r-1:0,d=n?-1:1,f=t[e+l];for(l+=d,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+t[e+l],l+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+t[e+l],l+=d,u-=8);if(0===s)s=1-c;else{if(s===h)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),s-=c}return(f?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,n,i,r,s){var o,a,h,c=8*s-r-1,u=(1<<c)-1,l=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:s-1,p=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+l>=1?d/h:d*Math.pow(2,1-l))*h>=2&&(o++,h/=2),o+l>=u?(a=0,o=u):o+l>=1?(a=(e*h-1)*Math.pow(2,r),o+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,r),o=0));r>=8;t[n+f]=255&a,f+=p,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;t[n+f]=255&o,f+=p,o/=256,c-=8);t[n+f-p]|=128*g}},119:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},120:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(110),h=n(106),c=n(103),u=n(107),l=n(111),d=s(n(2)),f=o(n(0));class p extends h.CAnnoId{constructor(t){super(t.appId),this.readyToAnnote=!1,this.currentTool=(0,c.getDefaultTool)(),this.executedActions=[],this.revokedActions=[],this.actionPduQueue=[],this.objectMapW2M=new Map,this.objectMapM2W=new Map,this.appId=t.appId,this.userName=t.userName,this.presenterId=(0,u.getShareSessionId)(t.presenterId),this.isPresenter=t.isPresenter,this.isBOSession=t.isBOSession,this.boardSDKIns=t.boardSDKIns,this.doc=this._createNewDoc(),this.sendRequestDrawPdu()}startAnnote(){f.default.Notify_APPUI(d.ANNO_UNDO_STATUS,{status:!!this.executedActions.length,presenterId:this.presenterId}),f.default.Notify_APPUI(d.ANNO_REDO_STATUS,{status:!!this.revokedActions.length,presenterId:this.presenterId})}destroy(){this.readyToAnnote=!1,this.doc=null,this.executedActions=[],this.revokedActions=[],this.actionPduQueue=[],this.objectMapW2M.clear(),this.objectMapM2W.clear(),this.boardSDKIns.onMessage({type:c.MSG_TO_WHITEBOARD_TYPE.DESTROY_SESSION,sessionId:this.presenterId})}sendRequestDrawPdu(){let t=(0,u.getDefaultAnnoData)(this.appId,this.userName,this.doc.getId());const e=new l.CAnnoPduDocRequestDraw(c.AnnoPduType.kDocRequestDraw,t);this.sendAnnoMessage(e.data)}sendAnnoMessage(t){const e=new u.CAnnoBuffer(null);e.writeInt8(37),e.writeInt8(this.isBOSession?1:0),e.writeInt16(0),e.writeInt32(this.presenterId);const n={command:c.ANNO_PDU_CMD,isPresenter:this.isPresenter,data:new Uint8Array(e.mData.concat(t.mData))};f.default.mediaSDKHandle.sendAnnotationPdu(n,this.isPresenter)}sendAnnoAction(t){this.readyToAnnote?this.sendAnnoMessage(t.data):this.actionPduQueue.push(t)}setTool(t){this.currentTool=t}onRequestDrawAck(){for(this.readyToAnnote=!0;this.actionPduQueue.length;){const t=this.actionPduQueue.shift();this.sendAnnoAction(t)}}handlePageSync(t){const{docId:e,pageId:n}=t.annoPduPage;this.doc.handlePageSync(e,n)}handleObjAddAck(t){const{annoObjIds:e}=t.annoPduObj;(null==e?void 0:e.length)&&e.forEach(t=>{const e=this.objectMapM2W.get(t);setTimeout(()=>{this.boardSDKIns.onMessage({type:c.MSG_TO_WHITEBOARD_TYPE.ONACK,objectId:e,sessionId:this.presenterId})},750)})}handleObjRemoveAllByHost(t){const{annoObjIds:e}=t.annoPduObj;if(null==e?void 0:e.length){const t=[];e.forEach(e=>{const n=this.objectMapM2W.get(e);n&&t.push(n)}),this.boardSDKIns.onMessage({type:c.MSG_TO_WHITEBOARD_TYPE.ERASE_ALL,objectIds:t,sessionId:this.presenterId})}}handleObjRestoreAllByHost(t){const{annoObjIds:e}=t.annoPduObj;if(null==e?void 0:e.length){const t=[];e.forEach(e=>{const n=this.objectMapM2W.get(e);n&&t.push(n)}),this.boardSDKIns.onMessage({type:c.MSG_TO_WHITEBOARD_TYPE.RESTORE_OBJECTS,objectIds:t,sessionId:this.presenterId})}}handleAddObject(t,e){let n;switch(this.currentTool.toolType){case c.AnnoToolType.ANNO_TOOL_TYPE_PEN:n=new a.CAnnoObjSmoothPen}const i=n.acquireObjId(this.appId);n.setObjHeader({objId:i});const{objectData:r,presenterId:s=this.presenterId}=t;if(!r)return;if(r.lineFormat&&n.setLineFormat(r.lineFormat),r.points){const t=(0,u.normalizePoints)(r.points,e);n.setData(t)}this.doc||(this.doc=this._createNewDoc(),this.readyToAnnote=!1,this.sendRequestDrawPdu());let o=(0,u.getDefaultAnnoData)(this.appId,this.userName,this.doc.getId(),this.doc.getPageId());o.annoObj=n;const h=new l.CAnnoPduAddObj(c.AnnoPduType.kAnnoObjAdd,o);o.annoObjIds=[i],o.whiteboardObjIds=[t.objectId];const d=(0,u.extractActionInfo)(o,c.AnnoPduType.kAnnoObjAdd);this._pushToExecutedAction(d),this.sendAnnoAction(h),this.objectMapW2M.set(t.objectId,i),this.objectMapM2W.set(i,t.objectId)}handleRemoveObject(t){const e=this.objectMapW2M.get(t.objectId);if(e)for(let n=0;n<this.executedActions.length;n++){const i=this.executedActions[n];if(i.pduType!==c.AnnoPduType.kAnnoObjAdd)continue;const r=i.annoObjIds;if(!r.includes(e))continue;let s=(0,u.getDefaultAnnoData)(this.appId,this.userName,i.docId,i.pageId);s.annoObjIds=r,s.whiteboardObjIds=[t.objectId];const o=new l.CAnnoPduRemoveObj(c.AnnoPduType.kAnnoObjRemove,s),a=(0,u.extractActionInfo)(s,c.AnnoPduType.kAnnoObjRemove);this._pushToExecutedAction(a),this.sendAnnoAction(o);break}}handleUndo(){const t=this._popExecutedAction();if(!t)return;const e=this._copyPduActionData(t);let n,i;switch(t.pduType){case c.AnnoPduType.kAnnoObjAdd:case c.AnnoPduType.kAnnoObjRestore:n=new l.CAnnoPduRemoveObj(c.AnnoPduType.kAnnoObjRemove,e),i=c.MSG_TO_WHITEBOARD_TYPE.REMOVE_OBJECTS;break;case c.AnnoPduType.kAnnoObjRemove:n=new l.CAnnoPduRestoreObj(c.AnnoPduType.kAnnoObjRestore,e),i=c.MSG_TO_WHITEBOARD_TYPE.RESTORE_OBJECTS;break;case c.AnnoPduType.kAnnoObjRemoveUser:n=new l.CAnnoPduRestoreUserObj(c.AnnoPduType.kAnnoObjRestoreUser,e),this._markRemoveStatus(e,!1),i=c.MSG_TO_WHITEBOARD_TYPE.RESTORE_OBJECTS;break;case c.AnnoPduType.kAnnoObjRemoveAllByHost:n=new l.CAnnoPduRestoreAllObjByHost(c.AnnoPduType.kAnnoObjRestoreAllByHost,e),this._markRemoveStatus(e,!1),i=c.MSG_TO_WHITEBOARD_TYPE.RESTORE_OBJECTS}this.boardSDKIns.onMessage({type:i,objectIds:e.whiteboardObjIds,sessionId:this.presenterId}),this._pushToRevokedAction(t),this.sendAnnoAction(n)}handleRedo(){const t=this._popRevokedAction();if(!t)return;const e=this._copyPduActionData(t);let n,i;switch(t.pduType){case c.AnnoPduType.kAnnoObjAdd:case c.AnnoPduType.kAnnoObjRestore:n=new l.CAnnoPduRestoreObj(c.AnnoPduType.kAnnoObjRestore,e),i=c.MSG_TO_WHITEBOARD_TYPE.RESTORE_OBJECTS;break;case c.AnnoPduType.kAnnoObjRemove:n=new l.CAnnoPduRemoveObj(t.pduType,e),i=c.MSG_TO_WHITEBOARD_TYPE.REMOVE_OBJECTS;break;case c.AnnoPduType.kAnnoObjRemoveUser:n=new l.CAnnoPduRemoveUserObj(t.pduType,e),i=c.MSG_TO_WHITEBOARD_TYPE.REMOVE_OBJECTS,this._markRemoveStatus(e,!0);break;case c.AnnoPduType.kAnnoObjRemoveAllByHost:n=new l.CAnnoPduRemoveAllObjByHost(t.pduType,e),i=c.MSG_TO_WHITEBOARD_TYPE.REMOVE_OBJECTS,this._markRemoveStatus(e,!0)}this.boardSDKIns.onMessage({type:i,objectIds:e.whiteboardObjIds,sessionId:this.presenterId}),this._pushToExecutedAction(t),this.sendAnnoAction(n)}handleClear(t){const{clearType:e}=t;switch(e){case c.ANNOTATION_CLEAR_TYPE.CLEAR_MINE:this.clearAllMine(!0);break;case c.ANNOTATION_CLEAR_TYPE.CLEAR_ALL:this.clearAll(t)}}clearAllMine(t){let e=(0,u.getDefaultAnnoData)(this.appId,void 0,this.doc.getId(),this.doc.getPageId());const n=[],i=[];for(let t=0;t<this.executedActions.length;t++){const e=this.executedActions[t];if(e.pduType===c.AnnoPduType.kAnnoObjAdd){if(e.isRemoved)continue;e.annoObjIds.forEach(t=>{n.push(t),i.push(this.objectMapM2W.get(t))}),e.isRemoved=!0}}if(!n.length)return e;if(e.annoObjIds=n,e.whiteboardObjIds=i,t){const t=new l.CAnnoPduRemoveUserObj(c.AnnoPduType.kAnnoObjRemoveUser,e),n=(0,u.extractActionInfo)(e,c.AnnoPduType.kAnnoObjRemoveUser);this._pushToExecutedAction(n),this.sendAnnoAction(t)}return this.boardSDKIns.onMessage({type:c.MSG_TO_WHITEBOARD_TYPE.ERASE_ALL,objectIds:i,sessionId:this.presenterId}),e}clearAll(t){const{isHost:e}=t;if(!e)return;let n,i,r=this.clearAllMine(!1);e&&!this.isPresenter&&(i=c.AnnoPduType.kAnnoObjRemoveAllByHost,n=new l.CAnnoPduRemoveAllObjByHost(i,r));const s=(0,u.extractActionInfo)(r,i);this._pushToExecutedAction(s),this.sendAnnoAction(n)}updateUserName(t){this.userName=t}_pushToExecutedAction(t){const e=this.executedActions.length;this.executedActions.push(t),0===e&&f.default.Notify_APPUI(d.ANNO_UNDO_STATUS,{status:!0,presenterId:this.presenterId})}_pushToRevokedAction(t){const e=this.revokedActions.length;this.revokedActions.push(t),0===e&&f.default.Notify_APPUI(d.ANNO_REDO_STATUS,{status:!0,presenterId:this.presenterId})}_popExecutedAction(){const t=this.executedActions.length,e=this.executedActions.pop();return t&&!this.executedActions.length&&f.default.Notify_APPUI(d.ANNO_UNDO_STATUS,{status:!1,presenterId:this.presenterId}),e}_popRevokedAction(){const t=this.revokedActions.length,e=this.revokedActions.pop();return t&&!this.revokedActions.length&&f.default.Notify_APPUI(d.ANNO_REDO_STATUS,{status:!1,presenterId:this.presenterId}),e}_copyPduActionData(t){let e=(0,u.getDefaultAnnoData)();return Object.assign(e,t),e}_markRemoveStatus(t,e){const{annoObjIds:n}=t;if(null==n?void 0:n.length)for(let t=0;t<this.executedActions.length;t++){const i=this.executedActions[t];if(i.pduType===c.AnnoPduType.kAnnoObjAdd){if(!!i.isRemoved===e)continue;i.annoObjIds.forEach(t=>{n.includes(t)&&(i.isRemoved=e)})}}}_createNewDoc(){return new a.CAnnoDoc({appId:this.appId,isPresenter:this.isPresenter,userName:this.userName,preseterId:this.presenterId})}}e.default=p},98:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationMgr=void 0;const r=i(n(115)),s=i(n(120)),o=n(103),a=n(107),h=n(106),c=n(111),u=new Map;class l extends h.CAnnoId{constructor(t){super(t.appId),this.currentTool=(0,o.getDefaultTool)(),this.objectMapW2M=new Map,this.objectMapM2W=new Map,this.appId=t.appId,this.userName=t.userName,this.presenterId=(0,a.getShareSessionId)(t.presenterId),this.sharingMainCanvas=t.sharingMainCanvas,this.annoCanvas=t.annoCanvas,this.remoteSizeInfo=t.remoteSizeInfo,this.shareCanvasOserver=new MutationObserver(this.updateAnnoCanvasSize.bind(this)),this.shareCanvasOserver.observe(this.sharingMainCanvas,{attributes:!0}),this.boardSDKIns=new r.default,this.boardSDKIns.init({mainCanvas:this.sharingMainCanvas,annoCanvas:this.annoCanvas,onAnnotationMsg:this.onAnnotationMsg.bind(this),sessionId:this.presenterId}),this.annoSession=this._createSession(this.presenterId,t.isBOSession)}destroy(){var t;null===(t=this.boardSDKIns)||void 0===t||t.destroy(),u.forEach(t=>{t.destroy()}),this.shareCanvasOserver.disconnect()}startAnnotation(t=this.presenterId,e=!1){const n=(0,a.getShareSessionId)(t);this.presenterId=n;let i=u.get(n);i||(i=this._createSession(n)),i.isBOSession=e,this.annoSession=i,i.startAnnote(),this.boardSDKIns.onMessage({type:o.MSG_TO_WHITEBOARD_TYPE.CHANGE_SESSION,sessionId:this.presenterId}),this.currentTool.toolType=o.AnnoToolType.ANNO_TOOL_TYPE_NONE,this.boardSDKIns.onMessage(Object.assign({type:o.MSG_TO_WHITEBOARD_TYPE.TOOL_SELECT,sessionId:this.presenterId},this.currentTool)),this.updateAnnoCanvasSize()}stopAnnotation(t){const{presenterId:e}=t;if(!e)return;const n=(0,a.getShareSessionId)(e),i=u.get(n);null==i||i.destroy(),u.delete(n)}updateCanvas(t){var e;this.sharingMainCanvas=t.sharingMainCanvas,this.annoCanvas=t.annoCanvas;const n=this._checkRemoteSizeInfo();null===(e=this.boardSDKIns)||void 0===e||e.onMessage(Object.assign({type:o.MSG_TO_WHITEBOARD_TYPE.UPDATE_CANVAS,mainCanvas:this.sharingMainCanvas,annoCanvas:this.annoCanvas},n))}updateAnnoCanvasSize(){var t;const e=this._checkRemoteSizeInfo();null===(t=this.boardSDKIns)||void 0===t||t.onMessage(Object.assign({type:o.MSG_TO_WHITEBOARD_TYPE.RESIZE},e))}updateRemoteSizeInfo(t){this.remoteSizeInfo.width=t.width||this.remoteSizeInfo.width,this.remoteSizeInfo.height=t.height||this.remoteSizeInfo.height}getAppId(){return this.appId}onRWGMessage(t){if(37!==t[0])return;const e=(0,c.parsePdu)(t);if(!e)return;switch(e.getPduType()){case o.AnnoPduType.kDocRequestDrawAck:this.handleRequestDrawAck(e);break;case o.AnnoPduType.kPageSync:this.handlePageSync(e);break;case o.AnnoPduType.kAnnoObjAddAck:this.handleObjAddAck(e);break;case o.AnnoPduType.kAnnoObjRemoveAllByHost:this.handleObjRemoveAllByHost(e);break;case o.AnnoPduType.kAnnoObjRestoreAllByHost:this.handleObjRestoreAllByHost(e)}}handleRequestDrawAck(t){var e,n;if((null===(e=t.annoPduDocRequestDrawAck)||void 0===e?void 0:e.requesterId)===this.appId){const e=t.annoPduHeader.appId;null===(n=u.get(e))||void 0===n||n.onRequestDrawAck()}}handlePageSync(t){var e;const n=t.annoPduHeader.appId;null===(e=u.get(n))||void 0===e||e.handlePageSync(t)}handleObjAddAck(t){var e;const n=t.annoPduHeader.appId;null===(e=u.get(n))||void 0===e||e.handleObjAddAck(t)}handleObjRemoveAllByHost(t){var e;const n=t.annoPduHeader.appId;null===(e=u.get(n))||void 0===e||e.handleObjRemoveAllByHost(t)}handleObjRestoreAllByHost(t){var e;const n=t.annoPduHeader.appId;null===(e=u.get(n))||void 0===e||e.handleObjRestoreAllByHost(t)}onAnnotationMsg(t){const{type:e}=t;switch(e){case o.ANNO_MSG_TYPE.ADD_OBJECT:this.handleAddObject(t);break;case o.ANNO_MSG_TYPE.REMOVE_OBJECT:this.handleRemoveObject(t)}}handleAddObject(t){this.annoSession.handleAddObject(t,this.sharingMainCanvas)}handleRemoveObject(t){this.annoSession.handleRemoveObject(t)}onAnnotationActions(t){switch(t.actionType){case o.ANNOTATION_ACTTION_TYPE.SELECT_MOUSE:t.toolType=o.AnnoToolType.ANNO_TOOL_TYPE_NONE,this.handleSelectTool(t);break;case o.ANNOTATION_ACTTION_TYPE.SELECT_ERASER:t.toolType=o.AnnoToolType.ANNO_TOOL_TYPE_ERASER,this.handleSelectTool(t);break;case o.ANNOTATION_ACTTION_TYPE.SELECT_TOOL:this.handleSelectTool(t);break;case o.ANNOTATION_ACTTION_TYPE.UNDO:this.handleUndo();break;case o.ANNOTATION_ACTTION_TYPE.REDO:this.handleRedo();break;case o.ANNOTATION_ACTTION_TYPE.CLEAR:this.handleClear(t);break;case o.ANNOTATION_ACTTION_TYPE.CLOSE_TOOL_BAR:this.boardSDKIns.onMessage({type:o.MSG_TO_WHITEBOARD_TYPE.TOOL_BAR_CLOSED});break;case o.ANNOTATION_ACTTION_TYPE.UPDATE_PARAMS:this.handleUpdateParams(t);break;case o.ANNOTATION_ACTTION_TYPE.PAUSE_ANNOTATION:this.handlePauseAnnotation(t)}}handleSelectTool(t){const{toolType:e,width:n,color:i}=t,r=parseInt(i),s=16777215&r,a=(r>>>24)/255;this.currentTool={toolType:e,width:n,color:s,alpha:a},this.annoSession.setTool(this.currentTool),this.boardSDKIns.onMessage(Object.assign({type:o.MSG_TO_WHITEBOARD_TYPE.TOOL_SELECT,sessionId:this.presenterId},this.currentTool))}handleUndo(){var t;null===(t=u.get(this.presenterId))||void 0===t||t.handleUndo()}handleRedo(){var t;null===(t=u.get(this.presenterId))||void 0===t||t.handleRedo()}handleClear(t){var e;null===(e=u.get(this.presenterId))||void 0===e||e.handleClear(t)}handleUpdateParams(t){const{userName:e}=t;"string"==typeof e&&u.forEach(t=>{t.updateUserName(e)})}handlePauseAnnotation(t){const{paused:e}=t;if("boolean"==typeof e){let t;t=e?{toolType:o.AnnoToolType.ANNO_TOOL_TYPE_NONE}:this.currentTool,this.boardSDKIns.onMessage(Object.assign({type:o.MSG_TO_WHITEBOARD_TYPE.TOOL_SELECT,sessionId:this.presenterId},t))}}_createSession(t,e=!1){const n=new s.default({appId:this.appId,userName:this.userName,presenterId:t,isPresenter:this.appId===t,isBOSession:e,boardSDKIns:this.boardSDKIns});return u.set(t,n),n}_checkRemoteSizeInfo(){var t,e;const n=null===(t=this.sharingMainCanvas)||void 0===t?void 0:t.offsetWidth,i=null===(e=this.sharingMainCanvas)||void 0===e?void 0:e.offsetHeight;return{width:n,height:i,absWidth:this.remoteSizeInfo.width||n,absHeight:this.remoteSizeInfo.height||i}}}e.AnnotationMgr=l}}]);
//# sourceMappingURL=https://d1cdksi819e9z7.cloudfront.net/sourcemap/annoter.min.js-71b1cf241b7d59ce116a.map